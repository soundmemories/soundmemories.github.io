<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Monda:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"soundmemories.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.17.1","exturl":true,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="类的生命 当程序主动使用某个类时，如果该类还未被加载到JVM内存中，系统会通过加载、连接、初始化三个步骤来对该类进行初始化，正常情况JVM将会连续完成这三个步骤，所以也把这三个步骤统称为类加载或类初始化。但有些时候这三个步骤也不是连续完成。  加载 加载可能出现在第一次使用某个类时加载该类、也可能采用预先加载机制来预加载某个类，不管怎样，类的加载必须由类加载器完成，类加载器通常由JVM提供">
<meta property="og:type" content="article">
<meta property="og:title" content="Java反射">
<meta property="og:url" content="https://soundmemories.github.io/2020/03/10/Java/22.Java%E5%8F%8D%E5%B0%84/index.html">
<meta property="og:site_name" content="SoundMemories">
<meta property="og:description" content="类的生命 当程序主动使用某个类时，如果该类还未被加载到JVM内存中，系统会通过加载、连接、初始化三个步骤来对该类进行初始化，正常情况JVM将会连续完成这三个步骤，所以也把这三个步骤统称为类加载或类初始化。但有些时候这三个步骤也不是连续完成。  加载 加载可能出现在第一次使用某个类时加载该类、也可能采用预先加载机制来预加载某个类，不管怎样，类的加载必须由类加载器完成，类加载器通常由JVM提供">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://soundmemories.github.io/images/Java/%E7%B1%BB%E7%9A%84%E7%94%9F%E5%91%BD.png">
<meta property="og:image" content="https://soundmemories.github.io/images/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A81.png">
<meta property="og:image" content="https://soundmemories.github.io/images/Java/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A82.png">
<meta property="article:published_time" content="2020-03-09T16:00:00.000Z">
<meta property="article:modified_time" content="2024-06-27T06:49:57.316Z">
<meta property="article:author" content="SoundMemories">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://soundmemories.github.io/images/Java/%E7%B1%BB%E7%9A%84%E7%94%9F%E5%91%BD.png">


<link rel="canonical" href="https://soundmemories.github.io/2020/03/10/Java/22.Java%E5%8F%8D%E5%B0%84/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":"","permalink":"https://soundmemories.github.io/2020/03/10/Java/22.Java%E5%8F%8D%E5%B0%84/","path":"2020/03/10/Java/22.Java反射/","title":"Java反射"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Java反射 | SoundMemories</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">SoundMemories</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">10</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">10</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">129</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B1%BB%E7%9A%84%E7%94%9F%E5%91%BD"><span class="nav-number">1.</span> <span class="nav-text">类的生命</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD"><span class="nav-number">1.1.</span> <span class="nav-text">加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.2.</span> <span class="nav-text">连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">1.3.</span> <span class="nav-text">初始化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8"><span class="nav-number">2.</span> <span class="nav-text">类加载器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8D%E5%B0%84"><span class="nav-number">3.</span> <span class="nav-text">反射</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E5%B0%84%E7%B1%BB%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.1.</span> <span class="nav-text">反射类对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%8F%8D%E5%B0%84%E7%B1%BB%E4%BF%A1%E6%81%AF"><span class="nav-number">3.2.</span> <span class="nav-text">获取反射类信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%8F%8D%E5%B0%84"><span class="nav-number">3.3.</span> <span class="nav-text">使用反射</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E7%BB%84"><span class="nav-number">3.4.</span> <span class="nav-text">操作数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="nav-number">3.5.</span> <span class="nav-text">动态代理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">4.</span> <span class="nav-text">小结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="SoundMemories"
      src="/images/avstar.png">
  <p class="site-author-name" itemprop="name">SoundMemories</p>
  <div class="site-description" itemprop="description">今日事，今日毕</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">129</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NvdW5kbWVtb3JpZXM=" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;soundmemories"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnNvdW5kbWVtb3JpZXNAMTYzLmNvbQ==" title="E-Mail → mailto:soundmemories@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
    </div>

    
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/03/10/Java/22.Java%E5%8F%8D%E5%B0%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avstar.png">
      <meta itemprop="name" content="SoundMemories">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Java反射 | SoundMemories">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Java反射
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-10 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-10T00:00:00+08:00">2020-03-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>33 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="类的生命">类的生命</h2>
<p>当程序主动使用某个类时，如果该类还未被加载到JVM内存中，系统会通过<strong>加载、连接、初始化</strong>三个步骤来对该类进行初始化，正常情况JVM将会连续完成这三个步骤，所以也把这三个步骤统称为类加载或类初始化。但有些时候这三个步骤也不是连续完成。<br />
<img src="/images/Java/类的生命.png" width="50%"></p>
<h3 id="加载">加载</h3>
<p>加载可能出现在第一次使用某个类时加载该类、也可能采用预先加载机制来预加载某个类，不管怎样，类的加载必须由<strong>类加载器</strong>完成，类加载器通常由JVM提供，由JVM提供的这些类加载器被称为系统类加载器。此外，开发者可以通过继承ClassLoader基类来创建自己的类加载器。通过使用不同的类加载器，可以从不同来源加载类的二进制数据，通常有如下几种来源：<br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">从本地系统直接读取.class文件，这是绝大部分类的加载方法。</span><br><span class="line">从zip、jar等文件中加载.class文件，这种方式也是很常见的。</span><br><span class="line">从网络下载.class文件或数据。</span><br><span class="line">从数据库提取.class数据。</span><br><span class="line">将.java上传到服务器中动态编译为.class数据，并执行加载。</span><br></pre></td></tr></table></figure></p>
<p>但是，不管类的字节码内容从哪里加载，加载的结果都一样，这些字节码内容加载到内存后，都会将这些静态数据转换成方法区的运行时数据结构，然后生成一个代表这个类的java.lang.Class对象，作为方法区中类数据的访问入口（即引用地址），所有需要访问和使用类数据只能通过这个Class对象。</p>
<h3 id="连接">连接</h3>
<p>当类被加载后，系统为其生成一个对应的Class对象，接着进入连接阶段，此阶段负责把类的二进制数据合并到JVM的运行状态之中。连接阶段有如下三个步骤：<br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">验证：确保加载的类信息符合JVM规范，例如：以cafe开头，没有安全方面的问题。</span><br><span class="line">准备：准备对应内存（方法区），创建Class对象，为类变量（<span class="keyword">static</span>）赋<span class="string">&quot;默认初始值&quot;</span>，为静态常量（<span class="keyword">static</span> <span class="keyword">final</span>）赋<span class="string">&quot;初始值&quot;</span>。</span><br><span class="line">解析：虚拟机常量池内的符号引用（常量名）替换为直接引用（地址）的过程。</span><br></pre></td></tr></table></figure></p>
<h3 id="初始化">初始化</h3>
<p>类的初始化，主要就是对<strong>静态变量</strong><br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>执行类构造器&lt;clinit&gt;()方法的过程。&lt;clinit&gt;()是由类变量的显式赋值动作和静态代码块中的语句合并产生。</span><br><span class="line"><span class="number">2.</span>当初始化一个类的时候，如果发现其父类还没有进行初始化，则需要先触发其父类的初始化。</span><br><span class="line"><span class="number">3.</span>虚拟机会保证一个类的&lt;clinit&gt;()方法在多线程环境中被正确加锁和同步，即每一个类在内存中都只有唯一的Class对象。</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> getNum();</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        ++a;</span><br><span class="line">        System.out.println(<span class="string">&quot;2.a = &quot;</span> + a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        ++a;</span><br><span class="line">        System.out.println(<span class="string">&quot;3.a = &quot;</span> + a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getNum</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;1.a = &quot;</span> + a);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestClinit</span> <span class="keyword">extends</span> <span class="title class_">Base</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> getNum();</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        ++b;</span><br><span class="line">        System.out.println(<span class="string">&quot;5.b = &quot;</span> + b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        ++b;</span><br><span class="line">        System.out.println(<span class="string">&quot;6.b = &quot;</span> + b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getNum</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;4.b = &quot;</span> + b);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;&#125;</span><br><span class="line">    <span class="comment">// 1.a = 0</span></span><br><span class="line">    <span class="comment">// 2.a = 2</span></span><br><span class="line">    <span class="comment">// 3.a = 3</span></span><br><span class="line">    <span class="comment">// 4.b = 0</span></span><br><span class="line">    <span class="comment">// 5.b = 2</span></span><br><span class="line">    <span class="comment">// 6.b = 3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>类的加载不一定就会触发类的初始化，当Java程序<strong>首次</strong>通过下面5种方式来使用某个类时，系统就会初始化该类：<br />
<div class="tabs" id="init1"><ul class="nav-tabs"><li class="tab active"><a href="#init1-1">1</a></li><li class="tab"><a href="#init1-2">2</a></li><li class="tab"><a href="#init1-3">3</a></li><li class="tab"><a href="#init1-4">4</a></li><li class="tab"><a href="#init1-5">5</a></li></ul><div class="tab-content"><div class="tab-pane active" id="init1-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.当虚拟机启动，先初始化main方法所在的类。</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init...A&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="init1-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.new一个类的对象。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init...B&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestB</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">B</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="init1-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.调用该类的静态成员（包含静态变量和静态方法），但final的常量除外。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestC</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(C.num);</span><br><span class="line">        C.test();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="init1-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//4.使用java.lang.reflect包的方法对类进行反射调用。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init...D&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestD</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">cl</span> <span class="operator">=</span> ClassLoader.getSystemClassLoader();</span><br><span class="line">        cl.loadClass(<span class="string">&quot;D&quot;</span>);<span class="comment">//该句不会造成类初始化，只是加载类</span></span><br><span class="line">        System.out.println(<span class="string">&quot;类加载已完成...&quot;</span>);</span><br><span class="line">        Class.forName(<span class="string">&quot;D&quot;</span>);<span class="comment">//会导致类初始化</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="init1-5"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//5.当初始化一个类，如果其父类没有被初始化，则先会初始化他的父类。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EBase</span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;父类初始化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestE</span> <span class="keyword">extends</span> <span class="title class_">EBase</span> &#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;子类初始化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div></p>
<p>类的加载过程中，不会发生类的初始化：<br />
<div class="tabs" id="init2"><ul class="nav-tabs"><li class="tab active"><a href="#init2-1">1</a></li><li class="tab"><a href="#init2-2">2</a></li><li class="tab"><a href="#init2-3">3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="init2-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.引用final静态常量不会触发此类的初始化，final常量在链接阶段的准备步骤中，就存入调用类的常量池中了。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NBase</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAX_VALUE</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;父类初始化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NSub</span> <span class="keyword">extends</span> <span class="title class_">NBase</span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;子类初始化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestNoInitialize</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(NSub.MAX_VALUE);<span class="comment">//100</span></span><br><span class="line">        System.out.println(NBase.MAX_VALUE);<span class="comment">//100</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="init2-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.当访问一个静态成员时，只有真正声明这个成员的类才会被初始化。</span></span><br><span class="line"><span class="comment">//即当通过子类引用父类的静态变量，不会导致子类初始化。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NBase</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;父类初始化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NSub</span> <span class="keyword">extends</span> <span class="title class_">NBase</span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;子类初始化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestNoInitialize</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(NSub.num);<span class="comment">//父类初始化</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="init2-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.通过数组定义类引用，不会触发此类的初始化。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NBase</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;父类初始化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NSub</span> <span class="keyword">extends</span> <span class="title class_">NBase</span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;子类初始化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestNoInitialize</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        NSub[] arr = <span class="keyword">new</span> <span class="title class_">NSub</span>[<span class="number">5</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div></p>
<h2 id="类加载器">类加载器</h2>
<p>类加载的过程由类加载器来完成。很多开发人员都遇到过java.lang.ClassNotFoundException或java.lang.NoClassDefError，想要更好的解决这类问题，或者在一些特殊的应用场景，比如需要支持类的动态加载、需要对编译后的字节码文件进行加密解密操作，那么需要你自定义类加载器，因此了解类加载器及其类加载机制也就成了每一个Java开发人员的必备技能之一。</p>
<p><strong>1.四种类加载器</strong>：<br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引导类-&gt;扩展类-&gt;应用程序类-&gt;自定义类</span></span><br><span class="line">|-引导类（Bootstrap Classloader）：又称为根类加载器。</span><br><span class="line">    |-负责加载Java的核心库，如JAVA_HOME/jre/lib/rt.jar、sun.boot.class.path下的内容）。</span><br><span class="line">    |-原生代码（C/C++）实现的，并不继承自java.lang.ClassLoder，所以通过Java代码获取引导类的加载器对象将会得到<span class="literal">null</span>。</span><br><span class="line">|-扩展类（Extension ClassLoader）：它由sun.misc.Launcher$ExtClassLoader实现，是java.lang.ClassLoader的子类。</span><br><span class="line">    |-负责加载Java的扩展库，如JAVA_HOME/jre/ext/x.jar、java.ext.dirs下的内容。</span><br><span class="line">|-应用程序类（Application Classloader）：它由sun.misc.Launcher$AppClassLoader实现，是java.lang.ClassLoader的子类。</span><br><span class="line">    |-负责加载Java应用程序classpath类路径、java.class.path下的内容。</span><br><span class="line">    |-即项目路径bin文件夹下的字节码，以及自己配置了的环境变量classpath。</span><br><span class="line">|-自定义类：通过继承java.lang.ClassLoader类的方式实现自己的类加载器。满足一些特殊的需求，例如：</span><br><span class="line">    |-对字节码进行加密来避免class文件被反编译。</span><br><span class="line">    |-加载特殊目录下的字节码数据（例如Tomcat的.class文件就不在bin目录下）。</span><br></pre></td></tr></table></figure></p>
<p><strong>2.Java的类加载过程是经典委托模式</strong>：<br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">|-类加载器负责加载所有的类，系统为所有被载入内存中的类生成一个java.lang.Class实例。</span><br><span class="line">    |-一个类被载入JVM中，同一个类就不会被再次载入了。</span><br><span class="line">    |-类用其<span class="string">&quot;全限定类名+类加载器&quot;</span>作为其唯一标识。类加载器不同，会被视为“不同的类”。</span><br><span class="line">|-类加载器在执行类加载任务的时候，确保一个类的全局唯一性：</span><br><span class="line">    |-双亲委派模型（Parent Delegation Model）的委派机制来约定类加载器的加载机制。</span><br><span class="line">        |-除了引导类加载器之外，程序中的每一个类加载器都应该拥有一个超类加载器，如下图所示。</span><br><span class="line">        |-类加载任务，先检测此类是否加载过，即在方法区寻找该类对应的Class对象是否存在：</span><br><span class="line">            |-存在，表示加载过，直接返回该Class对象。</span><br><span class="line">            |-不存在，将加载任务委派给它的超类加载器去执行，直到引导类加载器。</span><br><span class="line">                |-若超类加载器无法加载委派给它的类时，将加载任务退回低一级。</span><br><span class="line">                |-若所有加载器都失败，报ClassNotFoundException/NoClassDefFoundError。</span><br><span class="line"><span class="comment">//数组类型本身并不是由类加载器负责创建，而是由JVM在运行时根据需要而直接创建的，但数组的元素类型仍然需要依靠类加载器去创建。</span></span><br><span class="line"><span class="comment">//因此，JVM会把数组元素类型的类加载器记录为数组类型的类加载器。</span></span><br></pre></td></tr></table></figure></p>
<p><img src="/images/Java/类加载器1.png" width="50%"><br />
<img src="/images/Java/类加载器2.png" width="50%"></p>
<p><strong>3.自定义类加载器</strong>：<br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">|-java.lang.ClassLoader：抽象类。</span><br><span class="line">    |-ClassLoader <span class="title function_">getParent</span><span class="params">()</span>：返回委托的父类加载器。一些实现可能使用<span class="literal">null</span>来表示引导类加载器。 </span><br><span class="line">    |-ClassLoader <span class="title function_">getSystemClassLoader</span><span class="params">()</span>：返回委托的系统类加载器。</span><br><span class="line">    |-Class&lt;?&gt; loadClass(String name)：使用指定类的全限定名来加载类。例如：java.lang.String。注意内部类的名称：</span><br><span class="line">        |-匿名内部类（外部类的全限定名$编号）</span><br><span class="line">        |-局部内部类（外部类的全限定名$编号+类名）</span><br><span class="line">        |-成员/静态内部类（外部类的全限定名$+类名）</span><br><span class="line">    |-Class&lt;?&gt; findClass(String name)：使用指定类的全限定名来查找类。</span><br><span class="line">        |-此方法应该被重写，会按照委托模型来加载类。</span><br><span class="line">        |-在通过父类加载器检查所请求的类后，此方法将被loadClass方法调用。</span><br><span class="line">    |-Class&lt;?&gt; findLoadedClass(String name)：返回Class对象，如果类没有被加载，则返回<span class="literal">null</span>。</span><br><span class="line">    |-Class&lt;?&gt; defineClass(String name,<span class="type">byte</span>[] b,<span class="type">int</span> off,<span class="type">int</span> len)：将一个<span class="type">byte</span>数组转换为Class类的实例。</span><br></pre></td></tr></table></figure></p>
<div class="tabs" id="fileclassloader"><ul class="nav-tabs"><li class="tab active"><a href="#fileclassloader-1">自定义加载器</a></li><li class="tab"><a href="#fileclassloader-2">使用自定义加载器</a></li></ul><div class="tab-content"><div class="tab-pane active" id="fileclassloader-1"><figure class="highlight java"><figcaption><span>FileClassLoader.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.loader;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileClassLoader</span> <span class="keyword">extends</span> <span class="title class_">ClassLoader</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String rootDir;<span class="comment">//指定加载路径</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FileClassLoader</span><span class="params">(String rootDir)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.rootDir = rootDir;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//首先检查请求的类型，是否已经被这个类装载器装载到命名空间中了，如果已经被装载，直接返回</span></span><br><span class="line">        Class&lt;?&gt; c = findLoadedClass(name);</span><br><span class="line">        <span class="keyword">if</span>(c == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//委派类加载器请求给父类加载器，如果父类加载器能够完成，则返回父类加载器加载的Class实例</span></span><br><span class="line">            <span class="type">ClassLoader</span> <span class="variable">parent</span> <span class="operator">=</span> <span class="built_in">this</span>.getParent();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                c = parent.loadClass(name);<span class="comment">//加异常处理，父类加载不到，然后自己加载</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;&#125;</span><br><span class="line">            <span class="comment">//调用本类加载器的findClass()，试图获取对应的字节码，若获取的到则调用defineClass()导入类型到方法区</span></span><br><span class="line">            <span class="comment">//如果获取不到对应的字节码或其他原因失败，则异常，终止加载过程</span></span><br><span class="line">            <span class="keyword">if</span>(c == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="type">byte</span>[] classData = getClassData(name);</span><br><span class="line">                <span class="keyword">if</span>(classData == <span class="literal">null</span>)&#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ClassNotFoundException</span>();</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    c = defineClass(name, classData, <span class="number">0</span>, classData.length);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//把.class文件的内容读取到一个字节数组中</span></span><br><span class="line">    <span class="comment">//为什么要读取的字节数组中，因为protected final Class&lt;?&gt; defineClass(String name,byte[] b,int off,int len)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">byte</span>[] getClassData(String name) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> rootDir + File.separator + name.replace(<span class="string">&quot;.&quot;</span>, File.separator)+<span class="string">&quot;.class&quot;</span>;</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            is = <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(path);</span><br><span class="line">            baos =<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>(); </span><br><span class="line">            <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="type">int</span> len;</span><br><span class="line">            <span class="keyword">while</span>((len = is.read(buffer))!=-<span class="number">1</span>)&#123;</span><br><span class="line">                baos.write(buffer, <span class="number">0</span>, len);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> baos.toByteArray();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(is!=<span class="literal">null</span>)&#123;</span><br><span class="line">                    is.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="fileclassloader-2"><figure class="highlight java"><figcaption><span>TestFileClassLoader.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.loader;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestFileClassLoader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">FileClassLoader</span> <span class="variable">fsc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileClassLoader</span>(<span class="string">&quot;D:/memories/code&quot;</span>);</span><br><span class="line">        Class&lt;?&gt; uc = fsc.loadClass(<span class="string">&quot;com.memories.UserManager&quot;</span>);</span><br><span class="line">        System.out.println(uc);</span><br><span class="line">        Class&lt;?&gt; sc = fsc.loadClass(<span class="string">&quot;java.lang.String&quot;</span>);</span><br><span class="line">        System.out.println(sc);</span><br><span class="line">        System.out.println(sc.getClassLoader());<span class="comment">//null,因为委托给父类加载器...一直到引导类加载器</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>
<p><strong>4.类加载器加载资源文件</strong>：<br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|-类加载器的作用：</span><br><span class="line">    |-基本职责：根据一个指定的类的名称，找到/生成其对应的字节码，然后从这些字节码中定义出一个Java类，即java.lang.Class类的一个实例。</span><br><span class="line">    |-除此之外：还可以负责加载Java应用所需的资源，如图像文件、配置文件等。</span><br><span class="line">        |-这些资源和类，通过类加载器关联，避免在不同环境加载地址不一样而引起的错误。</span><br></pre></td></tr></table></figure></p>
<div class="tabs" id="加载"><ul class="nav-tabs"><li class="tab active"><a href="#加载-1">资源文件</a></li><li class="tab"><a href="#加载-2">加载器</a></li><li class="tab"><a href="#加载-3">tomcat加载器</a></li></ul><div class="tab-content"><div class="tab-pane active" id="加载-1"><figure class="highlight java"><figcaption><span>jdbc.properties</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载类路径下jdbc.properties资源文件，例如类路径是src，其编译后对应bin：</span></span><br><span class="line">username=root</span><br><span class="line">password=<span class="number">123456</span></span><br><span class="line">url=jdbc:mysql:<span class="comment">//localhost:3306/test</span></span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="加载-2"><figure class="highlight java"><figcaption><span>TestLoaderProperties.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestLoaderProperties</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">pro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//如果地址是包：&quot;com/memories/test/jdbc.properties&quot;</span></span><br><span class="line">            <span class="comment">//如果地址是项目的根路径下，不在src里面：pro.load(new FileInputStream(&quot;out.properties&quot;));</span></span><br><span class="line">            pro.load(ClassLoader.getSystemResourceAsStream(<span class="string">&quot;jdbc.properties&quot;</span>));</span><br><span class="line">            System.out.println(pro);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="加载-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如果发布在tomcat中web应用，使用前面代码是无法加载src类路径下的资源文件的：</span></span><br><span class="line"><span class="comment">//src下的资源文件会随着类被发布到web应用的WEB-INF\classes目录下，而tomcat使用自定义类加载器加载该路径下的内容。</span></span><br><span class="line"><span class="comment">//那么就需要通过该路径下的类先获取到该自定义加载器对象，然后再调用getSystemResourceAsStream(String name)去加载。</span></span><br><span class="line"><span class="type">Properties</span> <span class="variable">pro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="type">ClassLoader</span> <span class="variable">loader</span> <span class="operator">=</span> DBUtils.class.getClassLoader();</span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> loader.getResourceAsStream(<span class="string">&quot;druid.properties&quot;</span>);</span><br><span class="line">    pro.load(is);</span><br><span class="line">    System.out.println(pro);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>
<h2 id="反射">反射</h2>
<p>Java中所有的对象都有两种类型：<strong>编译时类型、运行时类型</strong>，而很多时候对象的编译时类型和运行时类型不一致。<br />
为了Java也<strong>支持动态型</strong>，需<strong>在运行期间，确定某个类型的功能</strong>，才引入了反射机制，Java是准动态语言，只是延迟了确定对象的类型。</p>
<p>某些变量的编译类型是Object类型，但是程序却需要调用该变量存储的对象运行时类型的方法，该方法不是Object中方法，如何解决呢？<br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|-在编译和运行时都完全知道类型的具体信息：</span><br><span class="line">    |-先使用<span class="keyword">instanceof</span>运算符进行判断，再利用强制类型转换符将其转换成运行时类型的变量。</span><br><span class="line">|-在编译时根本无法预知该对象和类的真实信息：</span><br><span class="line">    |-依靠运行时信息来发现该对象和类的真实信息，这就必须使用反射。</span><br></pre></td></tr></table></figure></p>
<p>因为加载完类之后，在堆内存的方法区中就产生了一个Class类型的对象（一个类只有一个Class对象），这个对象就包含了完整的类的结构信息。我们可以通过这个对象看到类的结构。这个对象就像一面镜子，透过这个镜子看到类的结构，所以，我们形象的称之为“反射”。</p>
<h3 id="反射类对象">反射类对象</h3>
<p><strong>1.哪些类型有Class对象</strong><br />
java.lang.Class类的实例表示正在运行的Java应用程序中的类和接口。事实上，所有类型都可以表示为Class的实例对象：<br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class：外部类，内部类</span><br><span class="line">interface：接口</span><br><span class="line">[]：数组，所有具有相同元素类型和维数的数组共享同一个Class 对象</span><br><span class="line"><span class="keyword">enum</span>：枚举</span><br><span class="line">annotation：注解<span class="meta">@interface</span></span><br><span class="line">primitive type：<span class="number">8</span>种基本数据类型</span><br><span class="line"><span class="keyword">void</span></span><br></pre></td></tr></table></figure></p>
<p><strong>2.Java程序中可以通过以下4种方式获得Class对象</strong>：<br />
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>编译期间已知任意类型：<span class="string">&quot;类型名.class&quot;</span>。</span><br><span class="line"><span class="number">2.</span>获取该对象的运行时类型的Class对象：<span class="string">&quot;对象.getClass()&quot;</span>。</span><br><span class="line"><span class="number">3.</span>Class类的静态方法：<span class="string">&quot;forName(String name)&quot;</span>。</span><br><span class="line"><span class="number">4.</span>类加载对象的<span class="string">&quot;loadClass(String name)&quot;</span>。</span><br><span class="line"><span class="comment">//String name是某个类的全限定名（完整的包.类型名）</span></span><br><span class="line"><span class="comment">//方式1，基本数据类型只能通过该方式获得Class对象。</span></span><br><span class="line"><span class="comment">//方式3，适用于除了数组以外的任意引用数据类型。</span></span><br><span class="line"><span class="comment">//方式3、4运行期间仍然无法加载该类的话，会报ClassNotFoundException。</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//1.类型名.class</span></span><br><span class="line">        Class&lt;?&gt; c1 = String.class;</span><br><span class="line">        <span class="comment">//2.getClass()</span></span><br><span class="line">        Class&lt;?&gt; c2 = <span class="string">&quot;hello&quot;</span>.getClass();</span><br><span class="line">        <span class="comment">//3.Class.forName(String name)</span></span><br><span class="line">        Class&lt;?&gt; c3 = Class.forName(<span class="string">&quot;java.lang.String&quot;</span>);</span><br><span class="line">        <span class="comment">//4.ClassLoader.loadClass(String name)</span></span><br><span class="line">        Class&lt;?&gt; c4 = ClassLoader.getSystemClassLoader().loadClass(<span class="string">&quot;java.lang.String&quot;</span>);</span><br><span class="line">        System.out.println(c1 == c2);<span class="comment">//true</span></span><br><span class="line">        System.out.println(c1 == c3);<span class="comment">//true</span></span><br><span class="line">        System.out.println(c1 == c4);<span class="comment">//true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">        Class&lt;?&gt; c1 = <span class="type">int</span>.class;<span class="comment">//基本数据类型</span></span><br><span class="line">        Class&lt;?&gt; c2 = <span class="keyword">void</span>.class;<span class="comment">//void类型</span></span><br><span class="line">        Class&lt;?&gt; c3 = String.class;<span class="comment">//String类</span></span><br><span class="line">        Class&lt;?&gt; c4 = Object.class;<span class="comment">//Object类</span></span><br><span class="line">        Class&lt;?&gt; c5 = Class.class;<span class="comment">//Class类</span></span><br><span class="line">        Class&lt;?&gt; c6 = Comparable.class;<span class="comment">//接口</span></span><br><span class="line">        Class&lt;?&gt; c7 = <span class="type">int</span>[].class;<span class="comment">//int数组，只要元素类型与维度一样，就是同一个Class</span></span><br><span class="line">        Class&lt;?&gt; c8 = <span class="type">int</span>[][].class;<span class="comment">//int二维数组</span></span><br><span class="line">        Class&lt;?&gt; c9 = String[].class;<span class="comment">//String数组</span></span><br><span class="line">        Class&lt;?&gt; c10 = Override.class;<span class="comment">//注解</span></span><br><span class="line">        Class&lt;?&gt; c11 = ElementType.class;<span class="comment">//枚举</span></span><br><span class="line">        <span class="type">int</span>[] arr1 = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">        System.out.println(arr1.getClass() == c7);<span class="comment">//true</span></span><br><span class="line">        System.out.println(c7 == c8);<span class="comment">//false</span></span><br><span class="line">        System.out.println(c7 == c9);<span class="comment">//false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="获取反射类信息">获取反射类信息</h3>
<p>Class类提供了大量实例方法来获取该Class对象所对应类的详细信息。每种方法都可能包含多个重载的版本：包、修饰符、类名、父类、父接口、注解，及成员（属性、构造器、方法）等。反射相关的API主要是java.lang.Class和java.lang.reflect包的内容。</p>
<div class="tabs" id="class类"><ul class="nav-tabs"><li class="tab active"><a href="#class类-1">类加载器</a></li><li class="tab"><a href="#class类-2">包名、类型名</a></li><li class="tab"><a href="#class类-3">类型修饰符</a></li><li class="tab"><a href="#class类-4">父类/父接口</a></li><li class="tab"><a href="#class类-5">内/外部类信息</a></li><li class="tab"><a href="#class类-6">属性</a></li><li class="tab"><a href="#class类-7">构造器</a></li><li class="tab"><a href="#class类-8">方法</a></li><li class="tab"><a href="#class类-9">泛型</a></li><li class="tab"><a href="#class类-10">注解</a></li></ul><div class="tab-content"><div class="tab-pane active" id="class类-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>获取类加载器：</span><br><span class="line">|-ClassLoader <span class="title function_">getClassLoader</span><span class="params">()</span>：返回该类的类加载器。</span><br><span class="line">    |-有些实现可能使用<span class="literal">null</span>来表示引导类加载器。如果此对象表示一个基本类型/<span class="keyword">void</span>，则返回<span class="literal">null</span>。</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class类-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.</span>获取包名、类型名：</span><br><span class="line">|-Package <span class="title function_">getPackage</span><span class="params">()</span>：获取此类的包。然后可以通过Package实例对象的getName()获取包名。</span><br><span class="line">|-String <span class="title function_">getName</span><span class="params">()</span>：以String的形式返回此Class对象所表示的实体（类、接口、数组类、基本类型、<span class="keyword">void</span>）名称。 </span><br><span class="line">    |-如果此类对象表示的是<span class="string">&quot;非数组类型的引用类型&quot;</span>，则返回该类的二进制名称，即<span class="string">&quot;包.类名&quot;</span>。</span><br><span class="line">    |-如果此类对象表示一个<span class="string">&quot;基本类型/void&quot;</span>，则返回其所对应的Java语言关键字相同的字符串名称。 </span><br><span class="line">    |-如果此类对象表示一个<span class="string">&quot;数组类&quot;</span>，则返回该数组嵌套深度的<span class="string">&quot;[字符+元素类型名&quot;</span>。</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class类-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3.</span>获取类型修饰符：</span><br><span class="line">|-<span class="type">int</span> <span class="title function_">getModifiers</span><span class="params">()</span>：返回此类或接口<span class="string">&quot;整数编码&quot;</span>的修饰符。得到的整数编码应当使用Modifier类的toString()方法来解码。</span><br><span class="line">    |-如果底层类是数组类，则其<span class="keyword">public</span>、<span class="keyword">private</span>和<span class="keyword">protected</span>修饰符与其组件类型的修饰符相同。</span><br><span class="line">    |-如果此Class表示一个基本类型/<span class="keyword">void</span>，则其<span class="keyword">public</span>修饰符始终为<span class="literal">true</span>，<span class="keyword">protected</span>和<span class="keyword">private</span>修饰符始终为<span class="literal">false</span>。</span><br><span class="line">    |-如果此对象表示一个数组类、一个基本类型/<span class="keyword">void</span>，则其<span class="keyword">final</span>修饰符始终为<span class="literal">true</span>，其接口修饰符始终为<span class="literal">false</span>。</span><br><span class="line">        |-该规范没有给定其他修饰符的值。</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class类-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4.</span>获取父类/父接口：</span><br><span class="line">|-Class&lt;? <span class="built_in">super</span> T&gt; getSuperclass()：返回表示此Class所表示的实体（类、接口、基本类型或 <span class="keyword">void</span>）的超类Class。</span><br><span class="line">    |-如果此Class表示Object 类、一个接口、一个基本类型/<span class="keyword">void</span>，则返回<span class="literal">null</span>。</span><br><span class="line">    |-如果此对象表示一个数组类，则返回表示该Object类的Class对象。</span><br><span class="line">|-Class&lt;?&gt;[] getInterfaces()：确定此对象所表示的类或接口实现的接口。</span><br><span class="line">    |-如果此对象表示一个类，则返回值是一个数组，它包含了表示该类所实现的所有接口的对象。</span><br><span class="line">        |-数组中接口对象顺序与此对象所表示的类的声明的implements子句中接口名顺序一致。</span><br><span class="line">    |-如果此对象表示一个接口，则该数组包含表示该接口扩展的所有接口的对象。</span><br><span class="line">        |-数组中接口对象顺序与此对象所表示的接口的声明的extends子句中接口名顺序一致。 </span><br><span class="line">    |-如果此对象表示一个不实现任何接口的类或接口，则此方法返回一个长度为<span class="number">0</span>的数组。</span><br><span class="line">    |-如果此对象表示一个基本类型/<span class="keyword">void</span>，则此方法返回一个长度为<span class="number">0</span>的数组。</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class类-5"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5.</span>获取内部类/外部类信息：</span><br><span class="line">|-Class&lt;?&gt;[] getClasses()：返回所有公共内部类和内部接口。包括从超类继承的。</span><br><span class="line">|-Class&lt;?&gt;[] getDeclaredClasses()：返回Class对象的一个数组，所有声明的内部类和内部接口。</span><br><span class="line">    |-包括该类所声明的公共、保护、默认（包）访问及私有类和接口，但不包括继承的类和接口。</span><br><span class="line">|-Class&lt;?&gt; getDeclaringClass()：如果此Class对象所表示的类/接口是内部类/内部接口，则返回它的外部类/外部接口，否则返回<span class="literal">null</span>。</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class类-6"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6.</span>获取属性：所有的属性都被抽象为Field类，那么一个属性被加载到内存后，是用一个Field对象表示的。</span><br><span class="line">|-Field[] getFields()：返回一个包含某些Field对象的无序数组。</span><br><span class="line">    |-这些对象反映此Class对象所表示的类或接口的所有可访问公共字段。</span><br><span class="line">        |-包括继承的公共字段，即得到所有公共的属性。</span><br><span class="line">|-Field <span class="title function_">getField</span><span class="params">(String name)</span>：同上，name指定所需公共成员字段。</span><br><span class="line">|-Field[] getDeclaredFields()：返回Field对象的一个无序数组。</span><br><span class="line">    |-这些对象反映此Class对象所表示的类或接口所声明的所有字段。</span><br><span class="line">        |-包括公共、保护、默认（包）访问和私有字段，但不包括继承的字段，即得到所有声明的属性。</span><br><span class="line">|-Field <span class="title function_">getDeclaredField</span><span class="params">(String name)</span>：同上，name指定所需已声明成员字段。</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class类-7"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7.</span>获取构造器：所有的构造器都被抽象为Constructor类，那么一个构造器被加载到内存后，是用一个Constructor对象表示的。</span><br><span class="line">|-Constructor&lt;T&gt; <span class="title function_">getDeclaredConstructor</span><span class="params">(Class&lt;?&gt;... parameterTypes)</span>：得到指定声明构造器。</span><br><span class="line">    |-构造器名称无需指定，因为它和类名一致。</span><br><span class="line">    |-parameterTypes参数是Class对象的一个数组，它按顺序匹配构造方法的形参类型。</span><br><span class="line">        |-如果此Class对象表示声明的非静态内部类，则默认第一个形参是外部类的实例对象。</span><br><span class="line">|-Constructor&lt;?&gt;[] getDeclaredConstructors()：得到所有声明的构造器。</span><br><span class="line">|-Constructor&lt;T&gt; <span class="title function_">getConstructor</span><span class="params">(Class&lt;?&gt;... parameterTypes)</span>：得到指定公共构造器。</span><br><span class="line">|-Constructor&lt;?&gt;[] getConstructors()：得到所有公共构造器。</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class类-8"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">8.</span>获取方法：所有的方法都被抽象为Method类，那么一个构造器被加载到内存后，是用一个Method对象表示的。</span><br><span class="line">|-Method <span class="title function_">getDeclaredMethod</span><span class="params">(String name,Class&lt;?&gt;... parameterTypes)</span>：指定声明的成员方法，但不包括继承的方法。</span><br><span class="line">    |-name指定所需声明方法。</span><br><span class="line">    |-parameterTypes参数是Class对象的一个数组或<span class="number">0</span>~n个Class对象，它按声明顺序标识该方法的形参类型。</span><br><span class="line">        |-如果是无参方法，那么parameterTypes可以不传或者传<span class="literal">null</span>。</span><br><span class="line">            |-因为可能存在重载的方法，所以在一个类中唯一确定一个方法，需要方法名和形参类型列表。</span><br><span class="line">|-Method[] getDeclaredMethods()：所有声明的成员方法，但不包括继承的方法。</span><br><span class="line">|-Method <span class="title function_">getMethod</span><span class="params">(String name,Class&lt;?&gt;... parameterTypes)</span>：指定的公共成员方法。包括继承的公共方法。</span><br><span class="line">|-Method[] getMethods()：所有公共成员方法。包括继承的公共方法。</span><br><span class="line"><span class="comment">//CompareTo可能会出现2个方法，Object是旧版本遗留下来的，编译器实际使用的还是自己写的CompareTo。</span></span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class类-9"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">9.</span>获取泛型父类：</span><br><span class="line">|-Type <span class="title function_">getGenericSuperclass</span><span class="params">()</span>：返回表示此Class所表示的实体（类、接口、基本类型/<span class="keyword">void</span>）的直接超类的Type。</span><br><span class="line">    |-Type：代表Java的所有类型。</span><br><span class="line">        |-Class：代表是普通的类型，没有泛型信息。</span><br><span class="line">        |-ParameterizedType：带参数化泛型，例如：Base&lt;T, U&gt;</span><br><span class="line">        |-GenericArrayType：带数组类型泛型，例如：T[]</span><br><span class="line">        |-TypeVariable：带类型变量泛型，例如：T</span><br><span class="line">        |-WildcardType：带 ? 通配符的泛型，例如：Base&lt;?&gt;、Base&lt;? <span class="built_in">super</span> 下限&gt;、Base&lt;? extends 上限&gt;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class类-10"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10.</span>获取注解信息：</span><br><span class="line">|-Annotation[] getAnnotations()：返回此元素上存在的所有注释，包括继承的注解。</span><br><span class="line">|-Annotation[] getDeclaredAnnotations()：获取某元素上存在的所有注释。该方法将忽略继承的注释。</span><br><span class="line">|-&lt;T <span class="keyword">extends</span> <span class="title class_">Annotation</span>&gt; T <span class="title function_">getAnnotation</span><span class="params">(Class&lt;T&gt; annotationClass)</span>：</span><br><span class="line">    |-如果存在该元素的指定类型的注释，则返回这些注释，否则返回<span class="literal">null</span>。</span><br><span class="line"><span class="comment">//若用反射获取到某个注解的信息，该注解声明时必加@Retention(RetentionPolicy.RUNTIME)元注解，表明滞留注解信息到运行时。</span></span><br></pre></td></tr></table></figure></div></div></div>
<div class="tabs" id="class信息"><ul class="nav-tabs"><li class="tab active"><a href="#class信息-1">类加载器</a></li><li class="tab"><a href="#class信息-2">包名、类型名</a></li><li class="tab"><a href="#class信息-3">类型修饰符</a></li><li class="tab"><a href="#class信息-4">父类/父接口</a></li><li class="tab"><a href="#class信息-5">内/外部类信息</a></li><li class="tab"><a href="#class信息-6">属性</a></li><li class="tab"><a href="#class信息-7">构造器</a></li><li class="tab"><a href="#class信息-8">方法</a></li><li class="tab"><a href="#class信息-9">泛型1</a></li><li class="tab"><a href="#class信息-10">泛型2</a></li><li class="tab"><a href="#class信息-11">注解</a></li></ul><div class="tab-content"><div class="tab-pane active" id="class信息-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = String.class;</span><br><span class="line">        <span class="comment">//获取它的类加载器对象</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">loader</span> <span class="operator">=</span> clazz.getClassLoader();</span><br><span class="line">        System.out.println(<span class="string">&quot;当前类的加载器：&quot;</span> + loader);<span class="comment">//当前类的加载器：null</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">parent</span> <span class="operator">=</span> loader.getParent();</span><br><span class="line">        System.out.println(<span class="string">&quot;父加载器：&quot;</span> + parent);</span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">grand</span> <span class="operator">=</span> parent.getParent();</span><br><span class="line">        System.out.println(<span class="string">&quot;爷爷加载器：&quot;</span> + grand);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//获取类型名</span></span><br><span class="line">        System.out.println(String.class.getName());<span class="comment">//java.lang.String</span></span><br><span class="line">        System.out.println(<span class="type">int</span>.class.getName());<span class="comment">//int</span></span><br><span class="line">        System.out.println(<span class="type">int</span>[].class.getName()); <span class="comment">//[I</span></span><br><span class="line">        System.out.println(<span class="type">int</span>[][][].class.getName());<span class="comment">//[[[I</span></span><br><span class="line">        System.out.println(Object[].class.getName());<span class="comment">//[Ljava.lang.Object;</span></span><br><span class="line">        <span class="comment">//获取包名</span></span><br><span class="line">        System.out.println(String.class.getPackage().getName());<span class="comment">//java.lang</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//[I中字符I表示元素类型是int，常见编码如下：</span></span><br><span class="line"><span class="comment">// Element              Type Encoding</span></span><br><span class="line"><span class="comment">// byte                     B</span></span><br><span class="line"><span class="comment">// short                    S</span></span><br><span class="line"><span class="comment">// int                      I</span></span><br><span class="line"><span class="comment">// long                     L</span></span><br><span class="line"><span class="comment">// float                    F</span></span><br><span class="line"><span class="comment">// double                   D</span></span><br><span class="line"><span class="comment">// boolean                  Z</span></span><br><span class="line"><span class="comment">// char                     C</span></span><br><span class="line"><span class="comment">// class or interface   Lclassname;</span></span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Modifier;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = String.class;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mod</span> <span class="operator">=</span> clazz.getModifiers();</span><br><span class="line">        System.out.println(<span class="string">&quot;修饰符的值：&quot;</span> + mod);<span class="comment">//修饰符的值：17</span></span><br><span class="line">        System.out.println(<span class="string">&quot;修饰符：&quot;</span> + Modifier.toString(mod));<span class="comment">//修饰符：public final</span></span><br><span class="line">        System.out.println(Modifier.isPublic(mod));<span class="comment">//true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        System.out.println(Integer.class.getSuperclass());<span class="comment">//java.lang.Number</span></span><br><span class="line">        System.out.println(<span class="type">int</span>.class.getSuperclass());<span class="comment">//null</span></span><br><span class="line">        System.out.println(Runnable.class.getSuperclass());<span class="comment">//null</span></span><br><span class="line">        System.out.println(<span class="type">int</span>[].class.getSuperclass());<span class="comment">//java.lang.Object</span></span><br><span class="line">        System.out.println(String[].class.getSuperclass());<span class="comment">//java.lang.Object</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">        Class&lt;?&gt; clazz = String.class;</span><br><span class="line">        Class&lt;?&gt;[] interfaces = clazz.getInterfaces();</span><br><span class="line">        <span class="comment">//打印clzz所有实现的接口</span></span><br><span class="line">        <span class="keyword">for</span> (Class&lt;?&gt; inter : interfaces) &#123;</span><br><span class="line">            System.out.println(inter);</span><br><span class="line">            <span class="comment">//java.io.Serializable</span></span><br><span class="line">            <span class="comment">//java.lang.Comparable</span></span><br><span class="line">            <span class="comment">//java.lang.CharSequence</span></span><br><span class="line">            <span class="comment">//java.lang.constant.Constable</span></span><br><span class="line">            <span class="comment">//java.lang.constant.ConstantDes</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-5"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = Map.class;</span><br><span class="line">        Class&lt;?&gt;[] inners = clazz.getDeclaredClasses();<span class="comment">//返回所有内部类、接口数组</span></span><br><span class="line">        <span class="keyword">for</span> (Class&lt;?&gt; inner : inners) &#123;</span><br><span class="line">            System.out.println(inner);<span class="comment">//java.util.Map$Entry</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        Class&lt;?&gt; ec = Map.Entry.class;<span class="comment">//内部类</span></span><br><span class="line">        Class&lt;?&gt; outer = ec.getDeclaringClass();<span class="comment">//返回外部类/接口</span></span><br><span class="line">        System.out.println(outer);<span class="comment">//java.util.Map</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-6"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Modifier;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = String.class;</span><br><span class="line">        Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">        <span class="comment">//clzz所有属性信息</span></span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mod</span> <span class="operator">=</span> field.getModifiers();<span class="comment">//属性的修饰符</span></span><br><span class="line">            Class&lt;?&gt; type = field.getType();<span class="comment">//属性的数据类型</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> field.getName();<span class="comment">//属性的名称</span></span><br><span class="line">            System.out.print(Modifier.toString(mod) + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            System.out.println(type.getName()+ <span class="string">&quot;\t&quot;</span> + name);</span><br><span class="line">            <span class="comment">// private final   [B      value</span></span><br><span class="line">            <span class="comment">// private final   byte    coder</span></span><br><span class="line">            <span class="comment">// private int     hash</span></span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-7"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Modifier;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Outer</span>&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Inner</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, SecurityException &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = Outer.class;</span><br><span class="line">        Constructor&lt;?&gt; constructor = clazz.getDeclaredConstructor();</span><br><span class="line">        System.out.println(constructor);<span class="comment">//Outer()</span></span><br><span class="line">        </span><br><span class="line">        Class&lt;?&gt; c = Outer.Inner.class;</span><br><span class="line">        <span class="comment">//因为Inner是非静态的内部类，所以它的构造器，默认第一个形参是外部类的实例对象</span></span><br><span class="line">        Constructor&lt;?&gt; cs = c.getDeclaredConstructor(Outer.class);</span><br><span class="line">        System.out.println(cs);<span class="comment">//Outer$Inner(Outer)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        Class&lt;?&gt; clazz = String.class;</span><br><span class="line">        Constructor&lt;?&gt;[] constructors = clazz.getConstructors();</span><br><span class="line">        <span class="comment">//clzz所有构造器信息</span></span><br><span class="line">        <span class="keyword">for</span> (Constructor&lt;?&gt; constructor : constructors) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mod</span> <span class="operator">=</span> constructor.getModifiers();<span class="comment">//构造器的修饰符</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> constructor.getName();<span class="comment">//构造器的名称</span></span><br><span class="line">            Class&lt;?&gt;[] parameterTypes = constructor.getParameterTypes();<span class="comment">//构造器的形参列表</span></span><br><span class="line"></span><br><span class="line">            System.out.print(Modifier.toString(mod)+<span class="string">&quot;\t&quot;</span> + name + <span class="string">&quot;(&quot;</span>);</span><br><span class="line">            System.out.println(Arrays.toString(parameterTypes)+<span class="string">&quot;)&quot;</span>);</span><br><span class="line">            <span class="comment">// public  java.lang.String([class java.lang.StringBuilder])</span></span><br><span class="line">            <span class="comment">// public  java.lang.String([class [B, int, int, class java.nio.charset.Charset])</span></span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-8"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Modifier;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        Class&lt;?&gt; clazz = String.class;</span><br><span class="line">        Method[] methods = clazz.getMethods();</span><br><span class="line">        <span class="comment">//clzz所有方法信息</span></span><br><span class="line">        <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mod</span> <span class="operator">=</span> method.getModifiers();<span class="comment">//方法的修饰符</span></span><br><span class="line">            Class&lt;?&gt; returnType = method.getReturnType();<span class="comment">//方法的返回值类型</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> method.getName();<span class="comment">//方法的名称</span></span><br><span class="line">            Class&lt;?&gt;[] parameterTypes = method.getParameterTypes();<span class="comment">//方法的形参列表</span></span><br><span class="line">            Class&lt;?&gt;[] exceptionTypes = method.getExceptionTypes();<span class="comment">//抛出的异常类型们</span></span><br><span class="line"></span><br><span class="line">            System.out.print(Modifier.toString(mod)+ <span class="string">&quot;\t&quot;</span> + returnType + <span class="string">&quot;\t&quot;</span> + name + <span class="string">&quot;(&quot;</span>);</span><br><span class="line">            System.out.print(Arrays.toString(parameterTypes)+ <span class="string">&quot;)&quot;</span> + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            System.out.println(Arrays.toString(exceptionTypes));</span><br><span class="line">            <span class="comment">// public  boolean equals([class java.lang.Object])        []</span></span><br><span class="line">            <span class="comment">// public  int     length([])      []</span></span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-9"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.ParameterizedType;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Type;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.TypeVariable;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span>&lt;T <span class="keyword">extends</span> <span class="title class_">Number</span>, U&gt;&#123;&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sub</span> <span class="keyword">extends</span> <span class="title class_">Base</span>&lt;Integer, String&gt;&#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestGenericSuperClass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Class&lt;?&gt; c = Base.class;</span><br><span class="line">        <span class="comment">//获取类型泛型形参</span></span><br><span class="line">        TypeVariable&lt;?&gt;[] typeParameters = c.getTypeParameters();</span><br><span class="line">        <span class="keyword">for</span> (TypeVariable&lt;?&gt; typeVariable : typeParameters) &#123;</span><br><span class="line">            System.out.println(typeVariable + <span class="string">&quot;，上限：&quot;</span> + typeVariable.getBounds()[<span class="number">0</span>]);</span><br><span class="line">            <span class="comment">//T，上限：class java.lang.Number</span></span><br><span class="line">            <span class="comment">//U，上限：class java.lang.Object</span></span><br><span class="line">        &#125;</span><br><span class="line">        Class&lt;Sub&gt; clazz = Sub.class;</span><br><span class="line">        <span class="type">Type</span> <span class="variable">gs</span> <span class="operator">=</span> clazz.getGenericSuperclass();</span><br><span class="line">        <span class="type">ParameterizedType</span> <span class="variable">gt</span> <span class="operator">=</span> (ParameterizedType)gs;</span><br><span class="line">        <span class="comment">//获取类型泛型实参</span></span><br><span class="line">        Type[] types = gt.getActualTypeArguments();</span><br><span class="line">        <span class="keyword">for</span> (Type type : types) &#123;</span><br><span class="line">            System.out.println(type);</span><br><span class="line">            <span class="comment">//class java.lang.Integer</span></span><br><span class="line">            <span class="comment">//class java.lang.String</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-10"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Tools</span>&lt;T&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> Class type;</span><br><span class="line">    <span class="comment">//构造器中获取子类泛型</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Tools</span><span class="params">()</span> &#123;<span class="comment">//在创建子类对象时，来确定type的代表类型</span></span><br><span class="line">        <span class="comment">//(1)获取正在new的对象的类型Class对象</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass();</span><br><span class="line">        <span class="comment">//(2)获取泛型父类的信息</span></span><br><span class="line">        <span class="type">ParameterizedType</span> <span class="variable">t</span> <span class="operator">=</span> (ParameterizedType) clazz.getGenericSuperclass();</span><br><span class="line">        <span class="comment">//(3)获取类型实参</span></span><br><span class="line">        type = (Class) t.getActualTypeArguments()[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//这个方法中需要用到T的类型对象，即T的Class对象</span></span><br><span class="line">        <span class="comment">//Class c = T.class;//此时无法确定T的类型</span></span><br><span class="line">        System.out.println(type);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyTools</span> <span class="keyword">extends</span> <span class="title class_">Tools</span>&lt;String&gt;&#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestGenericSuperClass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MyTools</span> <span class="variable">my</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyTools</span>();</span><br><span class="line">        my.test();<span class="comment">//class java.lang.String</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="class信息-11"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="comment">//声明注解</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span><span class="comment">//只有生命周期为“运行时”才能被反射回去，不然运行时报错</span></span><br><span class="line"><span class="meta">@interface</span> MyAnnotation&#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//使用注解</span></span><br><span class="line"><span class="meta">@MyAnnotation</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>&#123;</span><br><span class="line">    <span class="meta">@MyAnnotation</span></span><br><span class="line">    <span class="keyword">private</span> String info;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAnnotation</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = MyClass.class;</span><br><span class="line">        <span class="comment">//获取clazz类的所有注解</span></span><br><span class="line">        <span class="type">MyAnnotation</span> <span class="variable">my</span> <span class="operator">=</span> clazz.getAnnotation(MyAnnotation.class);</span><br><span class="line">        <span class="comment">//获取注解配置参数的值</span></span><br><span class="line">        System.out.println(my.value());<span class="comment">//hello</span></span><br><span class="line">        <span class="comment">//获取clazz类的info属性</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">infoField</span> <span class="operator">=</span> clazz.getDeclaredField(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">        <span class="comment">//获取info属性的所有注解</span></span><br><span class="line">        <span class="type">MyAnnotation</span> <span class="variable">infomy</span> <span class="operator">=</span> infoField.getAnnotation(MyAnnotation.class);</span><br><span class="line">        <span class="comment">//获取注解配置参数的值</span></span><br><span class="line">        System.out.println(infomy.value());<span class="comment">//hello</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>
<h3 id="使用反射">使用反射</h3>
<div class="tabs" id="使用反射1"><ul class="nav-tabs"><li class="tab active"><a href="#使用反射1-1">创建对象</a></li><li class="tab"><a href="#使用反射1-2">获取/设置对象的属性值</a></li><li class="tab"><a href="#使用反射1-3">使用方法</a></li></ul><div class="tab-content"><div class="tab-pane active" id="使用反射1-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>创建对象：</span><br><span class="line">|-使用Class对象的<span class="string">&quot;newInstance()&quot;</span>方法来创建该Class对象对应类的实例。</span><br><span class="line">    |-这种方式要求该Class对象的对应类<span class="string">&quot;必须有默认构造器&quot;</span>，而执行该方法时实际上是利用默认构造器来创建该类的实例。</span><br><span class="line">|-先使用Class对象获取指定的Constructor对象，再调用该对象的<span class="string">&quot;newInstance(Object... args)&quot;</span>方法来创建该Class对象对应类的实例。</span><br><span class="line">    |-通过这种方式可以选择使用某个类的<span class="string">&quot;指定构造器&quot;</span>来创建实例。</span><br><span class="line"><span class="comment">//方式1，常用于根据配置文件记录类名的字符串来创建实例对象，这种情况必须使用反射。</span></span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="使用反射1-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.</span>获取/设置对象的属性值：</span><br><span class="line">|-先通过Class对象的getFields()等方法可以获取该类所包括的全部Field/指定Field。</span><br><span class="line">    |-xxx <span class="title function_">getXxx</span><span class="params">(Object obj)</span>：获取obj对象该Field的属性值。</span><br><span class="line">        |-此处的Xxx对应<span class="number">8</span>种基本数据类型，如果该属性的类型是引用数据类型，则直接使用get(Object obj)方法。</span><br><span class="line">    |-<span class="keyword">void</span> <span class="title function_">setXxx</span><span class="params">(Object obj,Xxx value)</span>：设置obj对象该Field的属性值为value。</span><br><span class="line">        |-此处的Xxx对应<span class="number">8</span>种基本数据类型，如果该属性的类型是引用数据类型，则直接使用set(Object obj, Object value)方法。</span><br><span class="line">    |-<span class="keyword">void</span> <span class="title function_">setAccessible</span><span class="params">(<span class="type">boolean</span> flag)</span>：启动和禁用访问安全检查的开关。</span><br><span class="line">        |-值为<span class="literal">true</span>，则指示反射的对象在使用时取消Java语言访问检查，比如外部可以访问<span class="keyword">private</span>属性。</span><br><span class="line">            |-如果代码中必须用反射，且该句代码需要频繁的被调用，那么请设置为<span class="literal">true</span>；</span><br><span class="line">            |-使得原本无法访问的<span class="keyword">private</span>成员也可以访问；</span><br><span class="line">        |-值为<span class="literal">false</span>，则指示反射的对象实施Java语言访问检查。</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="使用反射1-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3.</span>使用方法：</span><br><span class="line">|-通过该Class对象的<span class="string">&quot;getMethods()&quot;</span>等方法获取全部方法/指定方法。</span><br><span class="line">|-每个Method对象对应一个方法，获得Method对象后，程序就可以通过该Method对象的<span class="string">&quot;invoke()&quot;</span>方法来调用对应方法。</span><br></pre></td></tr></table></figure></div></div></div>
<div class="tabs" id="使用反射2"><ul class="nav-tabs"><li class="tab active"><a href="#使用反射2-1">创建对象</a></li><li class="tab"><a href="#使用反射2-2">获取/设置对象的属性值</a></li><li class="tab"><a href="#使用反射2-3">使用方法</a></li></ul><div class="tab-content"><div class="tab-pane active" id="使用反射2-1"><figure class="highlight java"><figcaption><span>TestNewInstance.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student [name=&quot;</span> + name + <span class="string">&quot; age=&quot;</span> + age +<span class="string">&quot;]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestNewInstance</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;Student&quot;</span>);<span class="comment">//根据字符串反射得到类</span></span><br><span class="line">        <span class="comment">//根据反射得到的类，获取无参构造器，创建对象（使用默认构造器）</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.getDeclaredConstructor().newInstance();</span><br><span class="line">        System.out.println(obj);<span class="comment">//Student [name=null age=0]</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;Student&quot;</span>);</span><br><span class="line">        <span class="comment">//反射创建对象，按顺序指定形参类型，来匹配指定构造器</span></span><br><span class="line">        Constructor&lt;?&gt; constructor = clazz.getDeclaredConstructor(String.class, <span class="type">int</span>.class);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> constructor.newInstance(<span class="string">&quot;张三&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        System.out.println(obj);<span class="comment">//Student [name=张三 age=18]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="使用反射2-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Circle</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> radius;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestField</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;Circle&quot;</span>);<span class="comment">//获取反射类型</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.newInstance();<span class="comment">//反射创建对象</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(<span class="string">&quot;radius&quot;</span>);<span class="comment">//反射获取属性</span></span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);<span class="comment">//取消权限检查</span></span><br><span class="line">        field.set(obj, <span class="number">1.2</span>);<span class="comment">//为obj对象的Field对象表示的属性，赋值</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> field.get(obj);<span class="comment">//获取obj对象的Field对象表示的属性的值</span></span><br><span class="line">        System.out.println(value);<span class="comment">//1.2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="使用反射2-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Utils</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String user,String password)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;admin&quot;</span>.equals(user) &amp;&amp; <span class="string">&quot;123&quot;</span>.equals(password))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">check2</span><span class="params">(String user,String password)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;admin&quot;</span>.equals(user) &amp;&amp; <span class="string">&quot;666&quot;</span>.equals(password))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, InstantiationException, </span><br><span class="line">    IllegalAccessException, NoSuchFieldException, SecurityException, IllegalArgumentException,</span><br><span class="line">    InvocationTargetException, NoSuchMethodException&#123;</span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(<span class="string">&quot;Utils&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.getDeclaredConstructor().newInstance();</span><br><span class="line">        <span class="comment">//获取clazz对象check方法</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(<span class="string">&quot;check&quot;</span>,String.class,String.class);</span><br><span class="line">        <span class="comment">//调用clazz对象check方法</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> method.invoke(obj,<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;666&quot;</span>);</span><br><span class="line">        System.out.println(value);<span class="comment">//false</span></span><br><span class="line">        <span class="comment">//获取clazz对象check2方法</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method2</span> <span class="operator">=</span> clazz.getMethod(<span class="string">&quot;check2&quot;</span>, String.class,String.class);</span><br><span class="line">        <span class="comment">//调用clazz对象check2方法，obj位置传入null，表示调用静态方法</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">value2</span> <span class="operator">=</span> method2.invoke(<span class="literal">null</span>,<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;666&quot;</span>);</span><br><span class="line">        System.out.println(value2);<span class="comment">//true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>
<h3 id="操作数组">操作数组</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java.lang.reflect包下提供了一个Array类，Array实例可代表所有类型数组，可用于动态创建数组、操作数组元素。</span><br><span class="line">|-Object <span class="title function_">newInstance</span><span class="params">(Class&lt;?&gt; componentType, <span class="type">int</span>... dimensions)</span>：创建一个具有指定的组件类型和维度的新数组。</span><br><span class="line">|-<span class="keyword">void</span> <span class="title function_">setXxx</span><span class="params">(Object array,<span class="type">int</span> index,xxx value)</span>：将array数组中[index]元素的值修改为value。</span><br><span class="line">    |-此处的Xxx对应<span class="number">8</span>种基本数据类型，如果该属性的类型是引用数据类型，则直接使用set(Object array,<span class="type">int</span> index, Object value)方法。</span><br><span class="line">|-xxx <span class="title function_">getXxx</span><span class="params">(Object array,<span class="type">int</span> index,xxx value)</span>：将array数组中[index]元素的值返回。</span><br><span class="line">    |-此处的Xxx对应<span class="number">8</span>种基本数据类型，如果该属性的类型是引用数据类型，则直接使用get(Object array,<span class="type">int</span> index)方法。</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestArray</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">arr</span> <span class="operator">=</span> Array.newInstance(String.class, <span class="number">5</span>);</span><br><span class="line">        Array.set(arr, <span class="number">0</span>, <span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        Array.set(arr, <span class="number">1</span>, <span class="string">&quot;world&quot;</span>);</span><br><span class="line">        System.out.println(Array.get(arr, <span class="number">0</span>));</span><br><span class="line">        System.out.println(Array.get(arr, <span class="number">1</span>));</span><br><span class="line">        System.out.println(Array.get(arr, <span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="动态代理">动态代理</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java.lang.reflect包下提供了Proxy类、InvocationHandler接口，通过它们以生成JDK动态代理类、动态代理对象。</span><br><span class="line">|-InvocationHandler接口：代理类需继承该接口。</span><br><span class="line">|-Proxy类：提供创建动态代理类、代理对象的静态方法，它也是所有动态代理类的父类。</span><br><span class="line">    |-如果为一个或多个接口动态地生成实现类，就可以使用Proxy来创建动态代理类或它们的实例。</span><br><span class="line">    |-Class&lt;?&gt; getProxyClass(ClassLoader loader, Class&lt;?&gt;... interfaces)：创建一个动态代理类所对应的Class对象。</span><br><span class="line">    |-Object <span class="title function_">newProxyInstance</span><span class="params">(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</span>：直接创建一个动态代理对象。</span><br><span class="line">        |-loader为被代理类的类加载器对象。</span><br><span class="line">        |-interfaces为被代理类实现的接口们。</span><br><span class="line">        |-h为代理类代理工作处理器对象。h接口的invoke方法需要实现：</span><br><span class="line">            |-invoke方法的三个参数分别是proxy代表动态代理对象，method代表正在执行的方法，args代表执行代理对象的方法时传入的实参。</span><br></pre></td></tr></table></figure>
<p>案例需求：我需要在所有的Dog，Bird等接口的实现类所有实现方法加上统计方法的执行时间，并要求不修改这些实现类的代码。<br />
<div class="tabs" id="dog"><ul class="nav-tabs"><li class="tab active"><a href="#dog-1">定义接口</a></li><li class="tab"><a href="#dog-2">实现接口</a></li><li class="tab"><a href="#dog-3">代理类处理器</a></li><li class="tab"><a href="#dog-4">动态创建代理对象</a></li></ul><div class="tab-content"><div class="tab-pane active" id="dog-1"><figure class="highlight java"><figcaption><span>Dog.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.proxy;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">bark</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">jump</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">fly</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="dog-2"><figure class="highlight java"><figcaption><span>Person.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.proxy;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TibetanMastiff</span> <span class="keyword">implements</span> <span class="title class_">Dog</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">bark</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;藏獒在叫&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;藏獒在跑&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Magpie</span> <span class="keyword">implements</span> <span class="title class_">Bird</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">jump</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;喜鹊在跳来跳去&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fly</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;喜鹊飞来了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="dog-3"><figure class="highlight java"><figcaption><span>TimeInvocationHandler.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.proxy;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="comment">//必须实现InvocationHandler接口的invoke方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimeInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Object target;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TimeInvocationHandler</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="built_in">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span><span class="comment">//为每个方法增加时间统计</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;开始计时...&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">returnValue</span> <span class="operator">=</span> method.invoke(target, args);</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;方法执行时间：&quot;</span> + (end-start));</span><br><span class="line">        <span class="keyword">return</span> returnValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="dog-4"><figure class="highlight java"><figcaption><span>TestProxy.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.proxy;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestProxy</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">        Class&lt;?&gt; clazz = TibetanMastiff.class;</span><br><span class="line">        <span class="type">TibetanMastiff</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TibetanMastiff</span>();</span><br><span class="line">        <span class="type">TimeInvocationHandler</span> <span class="variable">handler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TimeInvocationHandler</span>(target);</span><br><span class="line">        <span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> (Dog) Proxy.newProxyInstance(clazz.getClassLoader(), clazz.getInterfaces(), handler);</span><br><span class="line">        dog.bark();</span><br><span class="line">        dog.run();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">        Class&lt;?&gt; clazz = Magpie.class;</span><br><span class="line">        <span class="type">Magpie</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Magpie</span>();</span><br><span class="line">        <span class="type">TimeInvocationHandler</span> <span class="variable">handler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TimeInvocationHandler</span>(target);</span><br><span class="line">        <span class="type">Bird</span> <span class="variable">bird</span> <span class="operator">=</span> (Bird) Proxy.newProxyInstance(clazz.getClassLoader(), clazz.getInterfaces(), handler);</span><br><span class="line">        bird.jump();</span><br><span class="line">        bird.fly();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div></p>
<p>动态代理对象需要实现一个或多个接口的方法时，它是如何知道怎么实现这些方法的呢？实际上它实现的方法体，其实就是执行InvocationHandler对象的invoke()方法。<br />
不难发现，使用动态代理可以非常灵活的实现解耦合，这种动态代理在Spring框架体系的AOP（Aspect
Orient
Program，即面向切面编程）里被称为AOP代理，AOP代理可替代目标对象，AOP代理包含了目标对象的全部方法。但AOP代理中的方法与目标对象的方法存在差异：AOP代理里的方法可以在执行目标方法之前、后插入一下通用处理。</p>
<h2 id="小结">小结</h2>
<p>本文详细介绍了Java反射的相关知识，本文对于普通Java学习者来说，确实显得有点深入，并且会感觉不太实用。但随着学习的深入，知识的积累，当读者需要开发出更多基础的、适应性更广的的、灵活性更强的代码时，就会想到使用反射知识了。本文从类的加载、初始化开始介绍，深入介绍了Java类加载器的原理和机制。本文重点介绍了Class、Field、Constructor、Method等，包括动态创建Java实例和动态操作对象的属性和方法。本文还介绍了在Spring框架中核心使用的动态代理原理。</p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>SoundMemories
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://soundmemories.github.io/2020/03/10/Java/22.Java%E5%8F%8D%E5%B0%84/" title="Java反射">https://soundmemories.github.io/2020/03/10/Java/22.Java反射/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/03/07/Java/21.Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" rel="prev" title="Java网络编程">
                  <i class="fa fa-chevron-left"></i> Java网络编程
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/03/14/Java/23.Java%20Lambda%E4%B8%8E%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/" rel="next" title="Java Lambda与函数式接口">
                  Java Lambda与函数式接口 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">SoundMemories</span>
  </div>
  <div class="powered-by">由 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9tdXNlLw==">NexT.Muse</span> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.12/pdfobject.min.js","integrity":"sha256-g2xji1rlE3KsGVClvuxTbcR0Kn2+wtQADSff2Tbb4zA="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"neutral","dark":"neutral"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.2.3/mermaid.min.js","integrity":"sha256-JFptYy4KzJ5OQP+Q9fubNf3cxpPPmZKqUOovyEONKrQ="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>


  <script src="/js/third-party/fancybox.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://soundmemories.github.io/2020/03/10/Java/22.Java%E5%8F%8D%E5%B0%84/"}</script>
  <script src="/js/third-party/quicklink.js"></script>

</body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Monda:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"soundmemories.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.0.2","exturl":true,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>

  <meta name="description" content="数据库目的（1）持久化(persistence)：把数据保存到可掉电式存储设备中以供之后使用。持久化的大多数时候是将内存中的数据存储在数据库中，当然也可以存储在磁盘文件、XML数据文件中。（2）方便管理数据（例如：快速的检索等）。">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL数据库">
<meta property="og:url" content="https://soundmemories.github.io/2019/03/23/MySQL/01.MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="SoundMemories">
<meta property="og:description" content="数据库目的（1）持久化(persistence)：把数据保存到可掉电式存储设备中以供之后使用。持久化的大多数时候是将内存中的数据存储在数据库中，当然也可以存储在磁盘文件、XML数据文件中。（2）方便管理数据（例如：快速的检索等）。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/04/13/UF9gI3iL7qdwESQ.png">
<meta property="og:image" content="https://i.loli.net/2021/04/22/dR1fBYT2cHZqpXM.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/13/4lCJTVD2HZYLdip.png">
<meta property="og:image" content="https://i.loli.net/2021/04/20/Q3d6qtcS91ICXYm.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/21/d78Iuzc1KqVT6N2.png">
<meta property="og:image" content="https://i.loli.net/2021/04/21/MjUZOeWVkliRHzc.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/u9QnvFIEhlaC4mc.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/21/5M62PmzS7gZpwt1.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/ZLT2hpACxuiIOjQ.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/DfvU4juRO32Tc7e.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/21/2mvCVwKXgGFnWSj.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/n6YvjUo4i1x9put.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/xg1izFBADYvoJVW.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/5Z96Wxy2ztXlGUH.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/CQu2bayw6g7ONjo.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/ytK3Z2j6zCRwWoM.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/uIRvT6KcBpF3gYq.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/MWaVLFZSh1N9Gbs.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/EFL8bzD7wBPC5mg.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/3eJMziZfgroSbqh.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/hfNxSI9gCpdTjRW.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/71shqV4xR3rdBXv.jpg">
<meta property="og:image" content="https://i.loli.net/2021/04/22/bJhClzFfZiyKPnr.jpg">
<meta property="article:published_time" content="2019-03-22T16:00:00.000Z">
<meta property="article:modified_time" content="2021-05-04T15:23:27.902Z">
<meta property="article:author" content="SoundMemories">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/04/13/UF9gI3iL7qdwESQ.png">


<link rel="canonical" href="https://soundmemories.github.io/2019/03/23/MySQL/01.MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MySQL数据库 | SoundMemories</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">SoundMemories</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-主页">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>主页</a>

  </li>
        <li class="menu-item menu-item-分类">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-标签">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-归档">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>
	   
		  
      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%AE%E7%9A%84"><span class="nav-number">1.</span> <span class="nav-text">数据库目的</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%91%E5%B1%95"><span class="nav-number">2.</span> <span class="nav-text">数据库发展</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%92%E8%A1%8C"><span class="nav-number">3.</span> <span class="nav-text">数据库排行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E7%9A%84%E9%80%BB%E8%BE%91%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="nav-number">4.</span> <span class="nav-text">MySQL的逻辑架构与存储引擎</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL%E7%9A%84%E9%80%BB%E8%BE%91%E6%9E%B6%E6%9E%84"><span class="nav-number">4.1.</span> <span class="nav-text">MySQL的逻辑架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="nav-number">4.2.</span> <span class="nav-text">存储引擎</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.3.</span> <span class="nav-text">安装关系型数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL%E5%B0%8F%E7%A4%BA%E4%BE%8B"><span class="nav-number">4.4.</span> <span class="nav-text">SQL小示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7"><span class="nav-number">4.5.</span> <span class="nav-text">可视化工具</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">5.</span> <span class="nav-text">MySQL的数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL%E8%A7%84%E8%8C%83%E5%92%8C%E5%88%86%E7%B1%BB"><span class="nav-number">6.</span> <span class="nav-text">SQL规范和分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL%E7%9A%84DDL"><span class="nav-number">7.</span> <span class="nav-text">SQL的DDL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA"><span class="nav-number">7.1.</span> <span class="nav-text">导入和导出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E4%BD%9CDatabase"><span class="nav-number">7.2.</span> <span class="nav-text">操作Database</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E6%93%8D%E4%BD%9CTABLE"><span class="nav-number">7.3.</span> <span class="nav-text">表操作TABLE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%A6%E6%9D%9FCONSTRAINTS"><span class="nav-number">7.4.</span> <span class="nav-text">约束CONSTRAINTS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL%E7%9A%84DML"><span class="nav-number">8.</span> <span class="nav-text">SQL的DML</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="nav-number">8.1.</span> <span class="nav-text">插入数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE"><span class="nav-number">8.2.</span> <span class="nav-text">修改数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-number">8.3.</span> <span class="nav-text">删除数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2"><span class="nav-number">8.4.</span> <span class="nav-text">查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E7%9A%84%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">9.</span> <span class="nav-text">MySQL的运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%EF%BC%8C%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="nav-number">10.</span> <span class="nav-text">关联查询，联合查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF"><span class="nav-number">10.1.</span> <span class="nav-text">笛卡尔积</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E8%81%94%E6%9D%A1%E4%BB%B6"><span class="nav-number">10.2.</span> <span class="nav-text">关联条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%88INNER-JOIN%EF%BC%89"><span class="nav-number">10.3.</span> <span class="nav-text">内连接（INNER JOIN）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5%EF%BC%88OUTER-JOIN%EF%BC%89"><span class="nav-number">10.4.</span> <span class="nav-text">外连接（OUTER  JOIN）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="nav-number">10.5.</span> <span class="nav-text">自连接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#select%E7%9A%845%E4%B8%AA%E5%AD%90%E5%8F%A5"><span class="nav-number">11.</span> <span class="nav-text">select的5个子句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#where%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="nav-number">11.1.</span> <span class="nav-text">where条件查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#group-by-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="nav-number">11.2.</span> <span class="nav-text">group by 分组查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#having-%E7%AD%9B%E9%80%89"><span class="nav-number">11.3.</span> <span class="nav-text">having 筛选</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#order-by-%E6%8E%92%E5%BA%8F"><span class="nav-number">11.4.</span> <span class="nav-text">order by 排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#limit-%E5%88%86%E9%A1%B5"><span class="nav-number">11.5.</span> <span class="nav-text">limit 分页</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">12.</span> <span class="nav-text">子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#where%E5%9E%8B%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">12.1.</span> <span class="nav-text">where型子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#from%E5%9E%8B%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">12.2.</span> <span class="nav-text">from型子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#exists%E5%9E%8B%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">12.3.</span> <span class="nav-text">exists型子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E5%88%B6%E8%A1%A8%E5%AD%90%E6%9F%A5%E8%AF%A2%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="nav-number">12.4.</span> <span class="nav-text">复制表子查询（了解）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="nav-number">13.</span> <span class="nav-text">单行函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="nav-number">13.1.</span> <span class="nav-text">数学函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="nav-number">13.2.</span> <span class="nav-text">字符串函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="nav-number">13.3.</span> <span class="nav-text">日期时间函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%81%E7%A8%8B%E5%87%BD%E6%95%B0"><span class="nav-number">13.4.</span> <span class="nav-text">流程函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0"><span class="nav-number">13.5.</span> <span class="nav-text">其他函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1"><span class="nav-number">14.</span> <span class="nav-text">事务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84ACID%E7%89%B9%E6%80%A7"><span class="nav-number">14.1.</span> <span class="nav-text">事务的ACID特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E7%94%A8%E6%B3%95"><span class="nav-number">14.2.</span> <span class="nav-text">事务的用法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">14.3.</span> <span class="nav-text">数据库的隔离级别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E4%B8%8E%E5%AE%89%E5%85%A8"><span class="nav-number">15.</span> <span class="nav-text">权限与安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-number">15.1.</span> <span class="nav-text">权限系统的工作原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86"><span class="nav-number">15.2.</span> <span class="nav-text">账号管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="nav-number">15.3.</span> <span class="nav-text">常见问题</span></a></li></ol></li></ol></div>
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="SoundMemories"
      src="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
  <p class="site-author-name" itemprop="name">SoundMemories</p>
  <div class="site-description" itemprop="description">今日事，今日毕</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">119</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NvdW5kbWVtb3JpZXM=" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;soundmemories"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnNvdW5kbWVtb3JpZXNAMTYzLmNvbQ==" title="E-Mail → mailto:soundmemories@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">
      

      

  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2019/03/23/MySQL/01.MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL数据库
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-03-23 00:00:00" itemprop="dateCreated datePublished" datetime="2019-03-23T00:00:00+08:00">2019-03-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>52k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>48 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="数据库目的"><a href="#数据库目的" class="headerlink" title="数据库目的"></a>数据库目的</h2><p>（1）持久化(persistence)：把数据保存到可掉电式存储设备中以供之后使用。持久化的大多数时候是将内存中的数据存储在数据库中，当然也可以存储在磁盘文件、XML数据文件中。<br>（2）方便管理数据（例如：快速的检索等）。<br><a id="more"></a></p>
<h2 id="数据库发展"><a href="#数据库发展" class="headerlink" title="数据库发展"></a>数据库发展</h2><p>DB：数据库（Database）即存储数据的“仓库”。它保存了一系列有组织的数据。<br>DBMS：数据库管理系统（Database Management System）：是一种操纵和管理数据库的大型软件，例如建立、使用和维护数据库。<br>目前互联网上常见的数据库管理软件有Sybase、DB2、Oracle、MySQL、Access、Visual Foxpro（面向对象型）、MS SQL Server、Informix、PostgreSQL（最符合SQL标准，但是性能差）这几种。</p>
<p><strong>数据库发展：</strong><br>萌芽期：文件管理。<br>第一代：层次数据库、网状数据库。<br>第二代：SQL、关系型数据库。<br>第三代：面向对象的DBMS（OODBMS）、对象关系的DBMS（ORDBMS）。</p>
<p><strong>文件系统管理</strong><br>磁盘上一个个文件，数据孤立，数据冗余。<br>格式不统一，很难统一管理。<br>无法高效查询，无法灵活查询。</p>
<p><strong>层次数据库</strong><br>以树型结构表示实体及其之间的联系。关系只支持一对多。<br>代表数据库IBM IMS。</p>
<p><strong>网状数据库</strong><br>通用电气最早在1964年开发出网状数据库IDS，只能运行在GE自家的主机上。</p>
<p>结点描述数据，结点的联系就是数据的关系。<br>能够直接描述客观世界，可以表示实体间多种复杂关系，而这是层次数据模型无法做到的。比如，一个结点可以有多个父结点，结点之间支持可以多对多关联。</p>
<p><strong>关系型数据库</strong><br>关系数据库的表采用二维表格来存储数据，是一种按行与列排列的具有相关信息的逻辑组，它类似于Excle工作表。一个数据库可以包含任意多个数据表。表中的一行即为一条记录。数据表中的每一列称为一个字段，表是由其包含的各种字段定义的，每个字段描述了它所含有的数据的意义，数据表的设计实际上就是对字段的设计。创建数据表时，为每个字段分配一个数据类型，定义它们的数据长度和其他属性。行和列的交叉位置表示某个属性值，如“数据库原理”就是课程名称的属性值。<br><img src="https://i.loli.net/2021/04/13/UF9gI3iL7qdwESQ.png" alt=""><br>使用行、列组成的二维表来组织数据和关系，表中行（记录）即可以描述数据实体，也可以描述实体间关系。关系模型比网状模型、层次模型更简单，不需要关系数存储的物理细节，专心于数据的逻辑构建，而且关系模型有论文的严格的数学理论基础支撑。</p>
<p>1970年6月，IBM的研究员E.F.Codd发表了名为“A Relational Model of Data for Large Shared Data Banks”的论文，提出了关系模型的概念，奠定了关系模型的理论基础。<br>1976年，IBM实验室System R项目，通过实现数据结构和操作来证明关系模型实用性，并直接产生了<strong>结构化查询语言SQL</strong>。1987年，SQL被ISO组织标准化。</p>
<p>关系模型，有严格的数学基础，抽象级别较高，简单清晰，便于理解和使用。经过几十年的发展，关系数据库百花齐放，技术日臻成熟和完善。基于关系模型构建的数据库系统称为RDBMS(Relational DataBase System)。IBM DB2、Oracle的Oracle和Mysql、微软的MS SQL。以前的Infomix、Sybase等。</p>
<p><strong>Oracle的发展：</strong><br>拉里·埃里森(Larry Ellison)仔细阅读了IBM的关系数据库的论文，敏锐意识到在这个研究基础上可以开发商用软件系统。他们几个创始人决定开发通用商用数据库系统Oracle，这个名字来源于他们曾给中央情报局做过的项目名。</p>
<p>1979年发布了ORACLE 2.0版本（实际上是1.0）。1983年，Oracle v3。1984年，Oracle v4。1985年，Oraclev5。1988年，Oracle v6引入了行级锁等新技术，然而这是个不稳定的版本。直到1992年的时候，Oracle7才逐渐稳定下来，并取得巨大成功。2001年的9i版本被广泛应用。<br>2009年4月20日，甲骨文公司宣布将以每股9.50美元，总计74亿美金收购SUN（计算机系统）公司。2010年1月成功收购。<br>2013年，甲骨文超过IBM，成为继微软之后的全球第二大软件公司。</p>
<p><strong>Mysql发展：</strong><br>1985年几个瑞典人为大型零售商的项目设计了一种利用索引顺序存取数据的软件，这就是MyISAM的前身。1996年，MySQL 1.0发布，随后发布了3.11.1版本，并开始往其它平台移植。2000年MySQL采用GPL协议开源。MySQL 4.0开始支持MyISAM、InnoDB引擎。2005年10月，MySQL 5.0成为里程碑版本。<br>2008年1月被Sun公司收购。<br>2009年1月，在Oracle收购MySQL之前，Monty Widenius担心收购，就从MySQL Server 5.5开始一条新的GPL分支，起名MariaDB。</p>
<p>MySQL的引擎是插件化的，可以支持很多种引擎：MyISASM，不支持事务，插入、查询速度快。InnoDB，支持事务，行级锁，MySQL 5.5起的默认引擎。</p>
<p><strong>去IOE：</strong><br>它是阿里巴巴造出的概念。其本意是，在阿里巴巴的IT架构中，去掉IBM的小型机、Oracle数据库、EMC存储设备，取而代之使用自己在开源软件基础上开发的系统。传统上，一个高端大气的数据中心，IBM小型机、Oracle数据库、EMC存储设备，可以说缺一不可。而使用这些架构的企业，不但采购、维护成本极高，核心架构还掌握在他人手中。</p>
<p>对于阿里巴巴这样大规模的互联网应用，应该采用开源、开放的系统架构。这种思路并不是阿里巴巴的新发明，国外的谷歌、Facebook、亚马逊等早已为之。只不过它们几乎一开始就有没有采用IT商业公司的架构，所以他们也不用“去IOE”。</p>
<p>去IOE，转而使用廉价的架构，稳定性一定下降，需要较高的运维水平解决。</p>
<p><strong>NoSQL：</strong><br>NoSQL是对非SQL、非传统关系型数据库的统称。<br>NoSQL一词诞生于1998年，2009年这个词汇被再次提出指非关系型、分布式、不提供ACID的数据库设计模式。</p>
<p>随着互联网时代的到来，数据爆发式增长，数据库技术发展日新月异，要适应新的业务需求。<br>随着移动互联网、物联网的到来，大数据的技术中NoSQL也同样重要。</p>
<h2 id="数据库排行"><a href="#数据库排行" class="headerlink" title="数据库排行"></a>数据库排行</h2><p><img src="https://i.loli.net/2021/04/22/dR1fBYT2cHZqpXM.jpg" alt="2021数据库排行"></p>
<p>Oracle：关系型数据库。甲骨文公司产品，非开源，价格昂贵，但能提供专业服务和支持。<br>MySQL：关系型数据库。开源产品，可根据自己需求进行改进。但被甲骨文公司收购，担心开源问题的，可以使用MariaDB。<br>Microsoft SQL Server：关系型数据库。依靠微软Windows操作系统，所以用的也比较多。<br>PostgreSQL：关系型数据库。性能差，但是最符合SQL标准，算是SQL教科书级别的数据库。<br>IBM Db2：关系型数据库。依靠IBM体系支持，和IBM虚拟机等一整套产品一起的，所以用的也多。<br>MongoDB：文档数据库。内存数据库的一种。<br>Redis：key-value数据库。内存数据库的一种。<br>Microsoft Access：关系型数据库。依靠Microsoft office产品，是办公型数据库，小型数据库。<br>SQLite：关系型数据库。Android系统自带数据库，小型数据库。<br>Elsaticsearch：快速查询数据库。支持快速查询。</p>
<p>当面对大型数据量时，要灵活选择数据库，比如面对上亿数据量，要求能快速查询，怎么选择数据库呢？<br>对于大数据量并且还需要快速查询，一个数据库就不行了，需要多个数据库进行配合：<br>考虑稳定性、存储大量数据，可选择MySQL数据库。但面对大量数据，其查询效率低。<br>考虑快速查询，可选择Redis和Elasticsearch配合，把常查询的数据放在这两种数据库种，但这两个是小型数据库，稳定性差，所以配合MySQL使用。</p>
<h2 id="MySQL的逻辑架构与存储引擎"><a href="#MySQL的逻辑架构与存储引擎" class="headerlink" title="MySQL的逻辑架构与存储引擎"></a>MySQL的逻辑架构与存储引擎</h2><h3 id="MySQL的逻辑架构"><a href="#MySQL的逻辑架构" class="headerlink" title="MySQL的逻辑架构"></a>MySQL的逻辑架构</h3><p><strong>1、连接层</strong><br>最上层是一些客户端和连接服务，包含本地sock通信和大多数基于客户端/服务端工具实现的类似tcp/ip的通信。主要完成一些类似连接处理、授权认证、及相关的安全方案。在该层上引入了线程池的概念，为通过认证安全接入的客户端提供线程，同样在该层上可以实现基于SSL的安全链接，服务器也会为安全接入的每个客户端验证它所具有的操作权限。<br><strong>2、服务层</strong><br>第二层架构主要完成核心服务功能，如SQL接口，并完成缓存的查询，SQL的分析和优化及部分内置函数的执行。所有跨存储引擎的功能也在这一层实现，如过程、函数等。在该层，服务器会解析查询并车床件相应的内部解析数，并对其完成相应的优化，如确定查询表的顺序，是否利用索引等。最后生成相应的执行操作。如果是select语句，服务器还是会查询内部的缓存。如果缓存空间足够大，这样在解决大量读操作的环境中能够很好的提升系统的性能。<br><strong>3、引擎层</strong><br>存储引擎层，真正的负责了MySQL中数据的存储和提取，服务器通过API与存储引擎具有的功能不同，这样我们可以根据自己的实际需要进行选取。后面介绍MyISAM和InnoDB。<br><strong>4、存储层</strong><br>数据存储层，主要负责将数据存储在运行于棵设备的文件系统上，并完成与存储引擎的交互。<br><img src="https://i.loli.net/2021/04/13/4lCJTVD2HZYLdip.png" width="80%" height="80%"></p>
<h3 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h3><p>MySQL最重要、最与众不同的特性是它的存储引擎架构，这种架构的设计将查询处理（Query Processing）及其他系统任务（Server Task）和数据的存储/提取相分离。这种处理和存储分离的设计可以在使用时根据性能、特性，以及其他需求来选择数据存储的方式。</p>
<p>MySQL中同一个数据库，不同的表格可以选择不同的存储引擎。常用存储引擎对比：<br>|特点 | MyISAM | InnoDB | MEMORY |MERGE | NDB|<br>| :——-| :—— | :—— |:—— |:—— |:—— |<br>| 存储限制 | 有 | 64TB | 有 | 没有 | 有 |<br>| 事务安全 | | 支持 |  |  |  |<br>| 锁机制 | 表锁 | 行锁 | 表锁 | 表锁 | 行锁 |<br>| B数索引 | 支持 | 支持 | 支持 | 支持 | 支持 |<br>| 哈希索引 |  |  | 支持 |  | 支持 |<br>| 全文索引 | 支持 |  |  |  |  |<br>| 集群索引 |  | 支持 |  |  |  |<br>| 数据缓存 |  | 支持 | 支持 |  | 支持 |<br>| 索引缓存 | 支持 | 支持 | 支持 | 支持 | 支持 |<br>| 数据可压缩 | 支持 |  |  |  |  |<br>| 空间使用 | 低 | 高 | N/A | 低 | 低 |<br>| 内存使用 | 低 | 高 | 中等 | 低 | 高 |<br>| 批量插入的速度 | 高 | 低 | 高 | 高 | 高 |<br>| 支持外键 |  | 支持 |  |  |  |</p>
<p>MyISAM不支持事务、也不支持外键，其优势是访问的速度快，对事务完整性没有要求或者以SELECT、INSERT为主的应用。每个MyISAM在磁盘上存储成三个文件。第一个文件的名字以表的名字开始，扩展名指出文件类型。.frm文件存储表定义。数据文件的扩展名为.MYD (MYData)。索引文件的扩展名是.MYI (MYIndex)。</p>
<p>InnoDB存储引擎提供了具有提交、回滚和崩溃恢复能力的事务安全。但是对比MyISAM的存储引擎，InnoDB写的处理效率差一些，并且会占用更多的磁盘空间以保存数据和索引。<br>InnoDB：所有的表都保存在同一个数据文件中，InnoDB表的大小只受限于操作系统文件的大小限制。<br>Myisam只缓存索引，不缓存真实数据。InnoDB不仅缓存索引还要缓存真实数据，对内存要求较高，而且内存大小对性能有决定性的影响。</p>
<p>MEMORY存储引擎使用存在于内存中的内容来创建表。MEMORY类型的表访问非常的快，因为它的数据是放在内存中的，并且默认使用HASH索引，但是一旦服务关闭，表中的数据就会丢失。主要用于那些内容变化不频繁的代码表或者作为统计操作的中间结果表。</p>
<p>查看当前mysql数据库管理软件支持的存储引擎：<code>SHOW ENGINES;</code><br>查看默认存储引擎和当前选择的存储引擎：<code>SHOW VARIABLES LIKE &#39;%storage_engine%&#39;;</code><br>创建新表时如果不指定存储引擎，那么系统就会使用默认存储引擎，MySQL5.5之前的默认存储引擎是MyISAM，5.5之后改为了InnoDB。<br>查看已经创建的表格的存储引擎：<code>SHOW CREATE TABLE 表名称;</code><br>查看当前的MySQL服务器中有哪些数据库：<code>SHOW DATABASES;</code></p>
<h3 id="安装关系型数据库"><a href="#安装关系型数据库" class="headerlink" title="安装关系型数据库"></a>安装关系型数据库</h3><p>Linux环境下，MariaDB 安装。MariaDB是MySQL创始人但心被收购后不能开源而单独引出的分支，功能和MySQL一样。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum list | grep mariadb</span></span><br><span class="line">mariadb-libs.x86_64 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 @anaconda</span><br><span class="line">mariadb.x86_64 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-bench.x86_64 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-devel.i686 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-devel.x86_64 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-embedded.i686 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-embedded.x86_64 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-embedded-devel.i686 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-embedded-devel.x86_64 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-libs.i686 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-server.x86_64 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line">mariadb-test.x86_64 <span class="number">1</span>:<span class="number">5.5</span><span class="number">.60</span><span class="number">-1.</span>el7_5 base</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装mariadb 服务，会自动安装mairadb</span></span><br><span class="line"><span class="comment"># yum install mariadb-server</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl start mariadb.service</span></span><br><span class="line"><span class="comment"># ss -tanl</span></span><br><span class="line">State Recv-Q Send-Q Local Address:Port Peer Address:Port</span><br><span class="line">LISTEN <span class="number">0</span> <span class="number">50</span> *:<span class="number">3306</span> *:*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开机启动：systemctl enable mariadb.service</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为了安全设置Mysql服务：mysql_secure_installation</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库密码登录：mysql -h 主机名 -P 端口号 -u 用户名 -p密码。</span></span><br><span class="line"><span class="comment"># 比如：mysql -u root -p</span></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql |</span><br><span class="line">| performance_schema |</span><br><span class="line">+--------------------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> <span class="built_in">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并授权用户，只授权这一次即可，再授权会给前面冲掉</span></span><br><span class="line">mysql&gt; grant <span class="built_in">all</span> on *.* to <span class="string">&#x27;memories&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified by <span class="string">&#x27;memories&#x27;</span>;</span><br><span class="line">mysql&gt; flush privileges;</span><br></pre></td></tr></table></figure></p>
<h3 id="SQL小示例"><a href="#SQL小示例" class="headerlink" title="SQL小示例"></a>SQL小示例</h3><p>查看当前的MySQL服务器中有哪些数据库：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW DATABASES;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| test               |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.05</span> sec)</span><br></pre></td></tr></table></figure><br>使用test数据库：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; USE test;</span><br><span class="line">Database changed</span><br></pre></td></tr></table></figure><br>创建表格：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE t_stu(</span><br><span class="line">    -&gt;  sid INT,</span><br><span class="line">    -&gt;  sname VARCHAR(100),</span><br><span class="line">    -&gt;  gender CHAR</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.14 sec)</span><br></pre></td></tr></table></figure><br>查看表结构：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DESC t_stu;</span><br><span class="line">+<span class="comment">--------+--------------+------+-----+---------+-------+</span></span><br><span class="line">| Field  | Type         | Null | Key | Default | Extra |</span><br><span class="line">+<span class="comment">--------+--------------+------+-----+---------+-------+</span></span><br><span class="line">| sid    | int(11)      | YES  |     | NULL    |       |</span><br><span class="line">| sname  | varchar(100) | YES  |     | NULL    |       |</span><br><span class="line">| gender | char(1)      | YES  |     | NULL    |       |</span><br><span class="line">+<span class="comment">--------+--------------+------+-----+---------+-------+</span></span><br><span class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.03</span> sec)</span><br></pre></td></tr></table></figure><br>插入记录：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; INSERT INTO t_stu VALUES(1,&#x27;张三&#x27;,&#x27;男&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.06 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; INSERT INTO t_stu VALUES(2,&#x27;李四&#x27;,&#x27;男&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.09 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; INSERT INTO t_stu VALUES(3,&#x27;王五&#x27;,&#x27;男&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.06 sec)</span><br></pre></td></tr></table></figure><br>查看记录：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM t_stu;</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| sid  | sname | gender |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">|    1 | 张三      | 男       |</span><br><span class="line">|    2 | 李四      | 男       |</span><br><span class="line">|    3 | 王五      | 男       |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><br>修改记录：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; UPDATE t_stu SET sname = &#x27;张三丰&#x27; WHERE sid = 1;</span><br><span class="line">Query OK, 1 row affected (0.08 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM t_stu;</span><br><span class="line">+<span class="comment">------+--------+--------+</span></span><br><span class="line">| sid  | sname  | gender |</span><br><span class="line">+<span class="comment">------+--------+--------+</span></span><br><span class="line">|    1 | 张三丰       | 男       |</span><br><span class="line">|    2 | 李四       | 男       |</span><br><span class="line">|    3 | 王五       | 男       |</span><br><span class="line">+<span class="comment">------+--------+--------+</span></span><br><span class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><br>删除记录：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DELETE FROM t_stu WHERE sid = 1;</span><br><span class="line">Query OK, 1 row affected (0.08 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM t_stu;</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| sid  | sname | gender |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">|    2 | 李四      | 男       |</span><br><span class="line">|    3 | 王五      | 男       |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><br>以上操作可能发生的问题：<br>（1）“ERROR 1046 (3D000): No database selected”：没有选择数据库就操作表格和数据。<br>解决方案一：使用“USE 数据库名;”语句，这样接下来的语句就默认针对这个数据库进行操作。<br>解决方案二：所有的表对象前面都加上“数据库.”。<br>（2）命令行客户端的字符集问题<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; INSERT INTO t_stu VALUES(1,&#x27;张三&#x27;,&#x27;男&#x27;);</span><br><span class="line">ERROR 1366 (HY000): Incorrect string value: &#x27;\xD5\xC5\xC8\xFD&#x27; for column &#x27;sname&#x27; at row 1</span><br></pre></td></tr></table></figure><br>原因：服务器端认为你的客户端的字符集是utf-8，而实际上你的客户端的字符集是GBK<br>查看所有字符集：<code>SHOW VARIABLES LIKE &#39;character_set_%&#39;;</code><br>解决方案：设置当前连接的客户端字符集<code>SET NAMES GBK;</code></p>
<h3 id="可视化工具"><a href="#可视化工具" class="headerlink" title="可视化工具"></a>可视化工具</h3><p>Navicat Preminum、MySQL Workbench、SQLyog等等，推荐Navicat Preminum使用最舒服。<br><img src="https://i.loli.net/2021/04/20/Q3d6qtcS91ICXYm.jpg" alt=""></p>
<h2 id="MySQL的数据类型"><a href="#MySQL的数据类型" class="headerlink" title="MySQL的数据类型"></a>MySQL的数据类型</h2><p>常用的数据类型有：<br>（1）整型（xxxint）<br>（2）位类型(bit)<br>（3）浮点型（float和double、real）<br>（4）定点数（decimal,numeric）<br>（5）日期时间类型（date,time,datetime,year）<br>（6）字符串（char,varchar,xxxtext）<br>（7）二进制数据（xxxBlob、xxbinary）<br>（8）枚举（enum）<br>（9）集合（set）</p>
<p><strong>1、整数</strong><br>注意：整数从1开始，不能是0。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">整数类型      字节   最小值（有符号&#x2F;无符号）    最大值（有符号&#x2F;无符号）</span><br><span class="line">TINYINT       1     -128&#x2F;0                    127&#x2F;255</span><br><span class="line">SMALLINT      2     -32768&#x2F;0                  32767&#x2F;65535</span><br><span class="line">MEDIUMINT     3     -8388608&#x2F;0                8388607&#x2F;1677215</span><br><span class="line">INT、INTEGER  4     -2147483648&#x2F;0             2147483647&#x2F;4294967295</span><br><span class="line">BIGINT        8     -9223372036854775808&#x2F;0    9223372036854775807&#x2F;18446744073709551615</span><br></pre></td></tr></table></figure><br>整数列的可选属性有三个：<br>（1）M: 宽度（在0填充的时候才有意义，否则不需要指定）。<br>（2）unsigned: 无符号类型(非负)。<br>（3）zerofill: 0填充,（如果某列是zerofill，那么默认就是无符号），如果指定了zerofill只是表示不够M位时，用0在左边填充，如果超过M位，只要不超过数据存储范围即可。<br>在 int(M) 中，M 的值跟 int(M) 所占多少存储空间并无任何关系。 int(3)、int(4)、int(8) 在磁盘上都是占用 4 bytes 的存储空间。如果存储值超过M位，也可以存储，不会报错，但数据会被截取失去意义，所以自己要确定没有超过设定的位数。</p>
<p><strong>2、浮点型</strong><br>对于浮点列类型，在MySQL中单精度值使用4个字节，双精度值使用8个字节：<br>（1）MySQL允许使用非标准语法（其他数据库未必支持，因此如果设计到数据迁移，则最好不要这么用）：FLOAT(M,D)或DOUBLE(M,D)。这里，(M,D)表示该值一共显示M位，其中D表示小数点后几位，M和D又称为精度和标度。例如，定义为FLOAT(5,2)的一个列可以显示为[-999.99,999.99]。M取值范围为0~255。D取值范围为0~30，同时必须&lt;=M。<br>（2）如果存储时，整数部分超出了范围（如上面的例子中，添加数值为1000.01），MySql就会报错，不允许存这样的值。如果存储时，小数点部分若超出范围，就分以下情况：若四舍五入后，整数部分没有超出范围，则只警告，但能成功操作并四舍五入删除多余的小数位后保存，例如在FLOAT(5,2)列内插入999.009，近似结果是999.01。若四舍五入后，整数部分超出范围，则MySql报错，并拒绝处理。如999.995和-999.995都会报错。<br>（3）说明：小数类型，也可以加unsigned，但是不会改变数据范围，例如：float(3,2) unsigned仍然只能表示0-9.99的范围。<br>（4）float和double在不指定精度时，默认会按照实际的精度（由实际的硬件和操作系统决定）来显示。<br>（5）REAL就是DOUBLE ，如果SQL服务器模式包括REAL_AS_FLOAT选项，REAL是FLOAT的同义词而不是DOUBLE的同义词。</p>
<p>注意：在编程中，如果用到浮点数，要特别注意误差问题，因为浮点数是不准确的，所以我们要避免使用“=”来判断两个数是否相等。如果希望保证值比较准确，推荐使用定点数数据类型。</p>
<p><strong>3、定点型</strong><br>（1）DECIMAL在MySQL内部以字符串形式存放，比浮点数更精确。定点类型占M+2个字节。<br>（2）DECIMAL(M,D)与浮点型一样处理规则。M的取值范围为0~65，D的取值范围为0~30，而且必须&lt;=M，超出范围会报错。<br>（3）DECIMAL如果指定精度时，默认的整数位是10，默认的小数位为0。<br>（4）NUMERIC等价于DECIMAL。</p>
<p><strong>4、日期时间类型</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">类型        说明         标准格式                      范围</span><br><span class="line">date       日期         YYYY-MM-DD             1000-01-01到9999-12-31</span><br><span class="line">time       时间          HH:MM:SS               -838:59:59和838:59:59</span><br><span class="line">datetime   日期时间   YYYY-MM-DD HH:MM:SS   1000-01-01 00:00:00到9999-12-31 23:59:59</span><br><span class="line">year       年份类型   YYYY 和 YY（不推荐）         1901到2155</span><br><span class="line">timestamp  时间戳     YYYY-MM-DD HH:MM:SS   1970-01-01 00:00:01到2038-01-19 03:14:07</span><br></pre></td></tr></table></figure><br>（1）对于year类型，可以输入4位数，例如2018，也可以输入两位数，例如18，如果输入的是两位，“00-68”表示2000-2069年，“70-99”表示1970-1999年。<br>（2）’YYYY-MM-DD HH:MM:SS’或’YY-MM-DD HH:MM:SS’，’YYYY-MM-DD’或’YY-MM-DD’格式的字符串。允许“不严格”语法：任何标点符都可以用做日期部分或时间部分之间的间割符。例如，’98-12-31 11:30:45’、’98.12.31 11+30+45’、’98/12/31 11*30*45’和’98\@12\@31 11\^30\^45’是等价的。<br>（3）’YYYYMMDD’或’YYMMDD’格式的没有间割符的字符串，假定字符串对于日期类型是有意义的。例如，’19970523’和’970523’被解释为 ‘1997-05-23’，但’971332’是不合法的(它有一个没有意义的月和日部分)，将变为’0000-00-00’。<br>（4）包括日期部分间割符的字符串值，如果日和月的值小于10，不需要指定两位数。’1979-6-9’与’1979-06-09’是相同的。同样，对于包括时间部分间割符的字符串值，如果时、分和秒的值小于10，不需要指定两位数。’1979-10-30 1:2:3’与’1979-10-30 01:02:03’相同。<br>（5）数字值应为6、8、12或14位长。如果一个数值是8或14位长，则假定为YYYYMMDD或YYYYMMDDHHMMSS格式，前4位数表示年。如果数字 是6或12位长，则假定为YYMMDD或YYMMDDHHMMSS格式，前2位数表示年。其它数字被解释为仿佛用零填充到了最近的长度。<br>（6）一般存注册时间、商品发布时间等，不建议使用datetime存储，而是使用时间戳，因为datetime虽然直观，但不便于计算。而且timestamp还有一个重要特点，就是和时区有关。还有如果插入NULL，会自动设置为当前系统时间。</p>
<p><strong>5、字符串型</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">类型     说明        典型说明方式              范围</span><br><span class="line">char    定长字符串   gender Char(1)         Char(M),0&lt;&#x3D;M&lt;&#x3D;255</span><br><span class="line">Varchar 变长字符串   email varchar(20)      Varchar(M),0&lt;&#x3D;M&lt;&#x3D;65535（约2万-6万个字符，受字符集影响）</span><br><span class="line">text    文本串       content text           约2万-6万个字符，受字符集影响</span><br></pre></td></tr></table></figure><br><strong>char,varchar,text区别：</strong><br>（1）char是一种固定长度的类型，varchar则是一种可变长度的类型。<br>（2）char如果不指定(M)则表示长度默认是1个字符。varchar必须指定(M)。<br>（3）char(M)类型的数据列里，每个值都占用M个字符，如果某个长度小于M，MySQL就会在它的右边用空格字符补（在检索操足作中那些填补出来的空格字符将被去掉；如果存入时右边本身就带空格，检索时也会被去掉）。在varchar(M)类型的数据列里，每个值只占用刚好够用的字符，再加上一个到两个用来记录其长度的字节（即总长度为L字符+1或2个字节）。<br>（4）char 固定长度，所以在处理速度上要比varchar快速很多，但相对费存储空间，所以对存储不大，但在速度上有要求的可以使用char类型。反之可以用varchar类型，每次存和取，都要数字符个数，所以速度慢。<br>（5）text文本类型，可以存比较大的文本段，搜索速度稍慢，因此如果不是特别大的内容，建议使用char，varchar来代替。还有text类型不用加默认值，加了也没用。而且text和blob类型的数据删除后容易导致“空洞”，使得文件碎片比较多，所以频繁使用的表不建议包含text类型字段，建议单独分出去，单独用一个表。<br><strong>哪些情况使用char或varchar更好：</strong><br>（1）存储很短的信息，比如门牌号码101，201这样很短的信息应该用char，因为varchar还要占个byte用于存储信息长度，本来打算节约存储的现在得不偿失。<br>（2）固定长度的。比如使用uuid作为主键，那用char应该更合适。因为他固定长度，varchar动态根据长度的特性就消失了，而且还要占个长度信息。<br>（3）十分频繁改变的column。因为varchar每次存储都要有额外的计算，得到长度等工作，如果一个非常频繁改变的，那就要有很多的精力用于计算，而这些对于char来说是不需要的。<br>（4）MyISAM和MEMORY存储引擎中无论使用char还是varchar其实都是作为char类型处理的。<br>（5）其他像InnoDB存储引擎，建议使用varchar类型，因为对于InnoDB数据表，内部的行存储格式并没有区分固定长度和可变长度列（所有数据行都使用指向数据列值的头指针），而且主要影响性能的因素是数据行使用的存储总量，由于char平均占用的空间多于varchar，所以除了简短并且固定长度的，其他考虑varchar。</p>
<p><strong>6、位类型（了解）</strong><br>BIT数据类型可用来保存位字段值。BIT(M)类型允许存储M位值。M范围为1~64，默认为1。</p>
<p>BIT其实就是存入二进制的值，类似010110。如果存入一个BIT类型的值，位数少于M值，则左补0。如果存入一个BIT类型的值，位数多于M值，MySQL的操作取决于此时有效的SQL模式：如果模式未设置，MySQL将值裁剪到范围的相应端点，并保存裁减好的值。如果模式设置为traditional(“严格模式”)，超出范围的值将被拒绝并提示错误，并且根据SQL标准插入会失败。</p>
<p>对于位字段，直接使用SELECT命令将不会看到结果，可以用bin()或hex()函数进行读取。</p>
<p><strong>7、二进制值类型（了解）</strong><br>包括：xxxBLOB和xxxBINARY。</p>
<p>BINARY和VARBINARY类型类似于CHAR和VARCHAR类型，但是不同的是，它们存储的不是字符字符串，而是二进制串。所以它们没有字符集，并且排序和比较基于列值字节的数值值。当保存BINARY(M)值时，在它们右边填充0x00(零字节)值以达到指定长度。取值时不删除尾部的字节。比较时所有字节很重要（因为空格和0x00是不同的，0x00&lt;空格），包括ORDER BY和DISTINCT操作。比如插入’a ‘会变成’a \0’。</p>
<p>BLOB是一个二进制大对象，可以容纳可变数量的数据。有4种BLOB类型：TINYBLOB、BLOB、MEDIUMBLOB和LONGBLOB。它们只是可容纳值的最大长度不同。分别与四种TEXT类型：TINYTEXT、TEXT、MEDIUMTEXT和LONGTEXT对应有相同的最大长度和存储需求。在TEXT或BLOB列的存储或检索过程中，不存在大小写转换。BLOB和TEXT列不能有默认值。BLOB或TEXT对象的最大大小由其类型确定，但在客户端和服务器之间实际可以传递的最大值由可用内存数量和通信缓存区大小确定。你可以通过更改max_allowed_packet变量的值更改消息缓存区的大小，但必须同时修改服务器和客户端程序。</p>
<p><strong>8、枚举（ENUM）（了解）</strong><br>MySql中的ENUM是一个字符串对象，其值来自表创建时在列规定中显式枚举的一列值：<br>（1）可以插入空字符串””和NULL（如果运行NULL的话）。<br>（2）如果你将一个非法值插入ENUM(也就是说，允许的值列之外的字符串)，如果是严格模式，将不能插入，如果是非严格模式，将选用第一个元素代替，并警告。<br>（3）ENUM最多可以有65,535个成员，需要2个字节存储。<br>（4）当创建表时，ENUM成员值的尾部空格将自动被删除。<br>例如：enum(‘M’,’F’)</p>
<p>值的索引规则如下：<br>（1）来自列规定的允许的值列中的值从1开始编号。<br>（1）空字符串错误值的索引值是0。<br>（1）NULL值的索引是NULL。</p>
<p><strong>9、集合（SET）（了解）</strong><br>（1）SET和ENUM类型非常类似，也是一个字符串对象，里面包含0~64个成员。<br>（2）SET和ENUM存储上有所不同，SET是根据成员的个数决定存储的字节数。<br>（3）SET和ENUM最主要的区别在于SET类型一次可以选择多个成员，而ENUM则只能选择一个。<br>例如：set(‘a’,’b’,’c’,’d’)</p>
<p><strong>10、特殊的NULL值</strong><br>Null特征：<br>（1）所有的类型的值都可以是null，包括int、float等数据类型。<br>（2）空字符串””，不等于null，0也不等于null，false也不等于null。<br>（3）任何运算符,判断符碰到NULL,都得NULL。<br>（4）NULL的判断只能用is null,is not null。<br>（5）NULL 影响查询速度,一般避免使值为NULL。</p>
<p>面试：为什么建表时，加not null default ‘’ 或 default 0 ？<br>答：不想让表中出现null值。</p>
<p>面试：为什么不想要的null的值？<br>答:（1）不好比较，null是一种特殊值，比较时，只能用专门的is null 和 is not null来比较。碰到运算符，一律返回null。<br>（2）效率不高，影响提高索引效果。因此，在建表时 not null default ‘’ 或 default 0 。</p>
<h2 id="SQL规范和分类"><a href="#SQL规范和分类" class="headerlink" title="SQL规范和分类"></a>SQL规范和分类</h2><p>SQL：Structure Query Language结构化查询语言，它是使用关系模型的数据库应用语言，由IBM上世纪70年代开发出来。后由美国国家标准局（ANSI）开始着手制定SQL标准，先后有SQL-86，SQL-89，SQL-92，SQL-99等标准。</p>
<p><strong>1、SQL的语言规范</strong><br>（1）mysql对于SQL语句不区分大小写，但是对于数据值是否区分大小写，和字符集与校对规则有关，SQL语句关键字尽量大写。<br>查看所有字符集和校对规则：<code>show character set;</code>，规则结尾是：_ci（大小写不敏感），_cs（大小写敏感），_bin（大小写敏感。二进制，以二进制值存储为基础，最严格）<br>（1）值，除了数值型，字符串型和日期时间类型使用单引号。<br>（1）别名，字段可以加双引号，表不能加双引号，而且不建议省略as。<br>（1）所有标点符号使用英文状态下的半角输入方式。<br>（1）必须保证所有括号、单引号、双引号是成对结束的。<br>（1）可以使用（1）# 单行注释 （2）-- 单行注释 （3）/<em>  多行注释  </em>/ 。</p>
<p>命名规则：<br>（1）数据库、表名不得超过30个字符，变量名限制为29个。<br>（2）必须只能包含 A–Z, a–z, 0–9, _ 共63个字符。<br>（3）不能在对象名的字符间留空格。<br>（4）必须不能和用户定义的其他对象重名。<br>（5）必须保证你的字段没有和保留字、数据库系统或常用方法冲突。<br>（6）保持字段名和类型的一致性,在命名字段并为其指定数据类型的时候一定要保证一致性。假如数据类型在一个表里是整数,那在另一个表里可就别变成字符型了。</p>
<p><strong>2、SQL分类</strong><br>（1）DDL（Data Definition Languages)：数据定义语言，这些语句定义了不同的数据段、数据库、表、列、索引等数据库对象。主要的语句关键字包括create、drop、alter等。<br>（2）DML（Data Manipulation Language）：数据操作语句，用于添加、删除、更新和查询数据库记录，并检查数据完整性。主要的语句关键字包括insert、delete、update、select等。<br>（3）DCL（Data Control Language）：数据控制语句，用于控制不同数据段直接的许可和访问级别的语句。这些语句定义了数据库、表、字段、用户的访问权限和安全级别。主要的语句关键字包括grant、revoke等。</p>
<h2 id="SQL的DDL"><a href="#SQL的DDL" class="headerlink" title="SQL的DDL"></a>SQL的DDL</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 启动</span></span><br><span class="line">net <span class="keyword">start</span> MySQL服务名</span><br><span class="line"><span class="comment">-- 停止</span></span><br><span class="line">net <span class="keyword">stop</span> MySQL服务名</span><br><span class="line"><span class="comment">-- 客户端连接服务</span></span><br><span class="line">mysql -h主机地址 -P端口号 -u用户名 -p</span><br></pre></td></tr></table></figure>
<h3 id="导入和导出"><a href="#导入和导出" class="headerlink" title="导入和导出"></a>导入和导出</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 导入</span></span><br><span class="line">source &gt; sql脚本路径名.sql</span><br><span class="line"><span class="comment">-- 数据库 导出/备份（下面的--是命令，不是注释）</span></span><br><span class="line">mysqldump -h主机地址 -P端口号 -u用户名 -p密码 <span class="comment">--database 数据库名 &gt; 文件路径/文件名.sql</span></span><br></pre></td></tr></table></figure>
<h3 id="操作Database"><a href="#操作Database" class="headerlink" title="操作Database"></a>操作Database</h3><p>（1）创建数据库：<code>create database 数据库名 [charset 字符集];</code> ，如果不指定字符集，则按照安装mysql服务时选择的默认字符集。<br>（2）查看数据库：<code>show databases;</code>，需当前用户有权限查看的。<br>（3）删除数据库：<code>drop database 数据库名;</code><br>（4）选择数据库：<code>use 数据库名;</code><br>（5）查看当前正在使用哪个数据库：<code>select database();</code>，要操作表格和数据之前必须先说明是对哪个数据库进行操作，否则就要对所有对象加上“数据库名.”。<br>注意：database不能改名。一些可视化工具可以改名，它是建新库，把所有表复制到新库，再删旧库完成的。</p>
<h3 id="表操作TABLE"><a href="#表操作TABLE" class="headerlink" title="表操作TABLE"></a>表操作TABLE</h3><p>（1）查看当前数据库的所有表格：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 前面必须有use 数据库名语句，否则报错ERROR 1046 (3D000): No database selected</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;   </span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span> <span class="keyword">from</span> 数据库名;</span><br></pre></td></tr></table></figure><br>（2）创建表结构：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 基础版</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名称(</span><br><span class="line">    字段名<span class="number">1</span> 数据类型<span class="number">1</span>,</span><br><span class="line">    字段名<span class="number">2</span> 数据类型<span class="number">2</span>,</span><br><span class="line">    字段名<span class="number">3</span> 数据类型<span class="number">3</span></span><br><span class="line">);    </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu(</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span>,</span><br><span class="line">    sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    gender <span class="built_in">CHAR</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 详细版</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名称(</span><br><span class="line">    字段名<span class="number">1</span> 数据类型<span class="number">1</span> 主键 自增长,</span><br><span class="line">    字段名<span class="number">2</span> 数据类型<span class="number">2</span> 非空 默认值,</span><br><span class="line">    字段名<span class="number">3</span> 数据类型<span class="number">3</span></span><br><span class="line">)<span class="keyword">ENGINE</span>=当前表格的引擎 AUTO_INCREMENT=自增长的起始值 <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=表数据的默认字符集;    </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu(</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">    sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    gender <span class="built_in">CHAR</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure><br>（3）查看表结构：<code>desc 表名称;</code><br>（4）查看表的定义：<code>show create table 表名;</code><br>（5）删除表结构：<code>drop table 表名称;</code>，数据和结构都被删除，所有正在运行的相关事务被提交，所有相关索引被删除，drop table 语句不能回滚。<br>（6）修改表结构：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 重命名表</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">rename</span> 新表名;</span><br><span class="line"><span class="keyword">rename</span> <span class="keyword">table</span> 表名 <span class="keyword">to</span> 新表名; </span><br><span class="line"><span class="comment">-- 增加一列</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 【<span class="keyword">column</span>】 列名 数据类型 【<span class="keyword">default</span> 默认值】【<span class="keyword">not</span> <span class="literal">null</span>】;  <span class="comment">#默认在最后</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 【<span class="keyword">column</span>】 列名 数据类型 【<span class="keyword">default</span> 默认值】【<span class="keyword">not</span> <span class="literal">null</span>】 <span class="keyword">after</span> 某一列;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 【<span class="keyword">column</span>】 列名 数据类型 【<span class="keyword">default</span> 默认值】【<span class="keyword">not</span> <span class="literal">null</span>】 <span class="keyword">first</span>;</span><br><span class="line"><span class="comment">-- 删除列</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">drop</span> 【<span class="keyword">column</span>】 列名;</span><br><span class="line"><span class="comment">-- 修改列类型</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">modify</span> 【<span class="keyword">column</span>】 列名 数据类型【<span class="keyword">default</span> 默认值】【<span class="keyword">not</span> <span class="literal">null</span>】;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">modify</span> 【<span class="keyword">column</span>】 列名 数据类型【<span class="keyword">default</span> 默认值】【<span class="keyword">not</span> <span class="literal">null</span>】 <span class="keyword">after</span> 某一列;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">modify</span> 【<span class="keyword">column</span>】 列名 数据类型【<span class="keyword">default</span> 默认值】【<span class="keyword">not</span> <span class="literal">null</span>】 <span class="keyword">first</span>;</span><br><span class="line"><span class="comment">-- 修改列名等</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">change</span> 【<span class="keyword">column</span>】 列名 新列名 数据类型【<span class="keyword">default</span> 默认值】【<span class="keyword">not</span> <span class="literal">null</span>】;</span><br></pre></td></tr></table></figure></p>
<h3 id="约束CONSTRAINTS"><a href="#约束CONSTRAINTS" class="headerlink" title="约束CONSTRAINTS"></a>约束CONSTRAINTS</h3><p>数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是应防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。数据的完整性要从以下四个方面考虑：<br>（1）实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录。<br>（2）域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女”。<br>（3）引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门。<br>（4）用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。</p>
<p>根据约束的特点，可将约束分为：<br>（1）键约束：主键约束、外键约束、唯一键约束。<br>（2）Not NULL约束：非空约束。<br>（3）Check约束：检查约束。<br>（4）Default约束：缺省约束。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看某个表的约束</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> information_schema.table_constraints <span class="keyword">WHERE</span> table_name = <span class="string">&#x27;表名称&#x27;</span>;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名;</span><br><span class="line"><span class="comment">-- 查看某个表的索引</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">INDEX</span> <span class="keyword">FROM</span> 表名称;</span><br></pre></td></tr></table></figure>
<p><strong>1、主键约束PRIMARY KEY</strong><br>主键：Primary key，简称PK，数据库主键作用保证实体的完整性，可以是一个列或多列的组合。<br>（1）主键约束相当于<strong>唯一约束+非空约束</strong>的组合，主键约束列不允许重复，也不允许出现空值，如果是多列组合的主键约束，那么这些列都不允许为空值，并且组合的值不允许重复。<br>（2）<strong>每个表有且最多只允许一个主键约束。</strong><br>（3）MySQL的主键名总是PRIMARY，就算自己命名了主键约束名也没用。<br>（4）当创建主键约束时，MySQL默认在对应的列上建立<strong>主键索引</strong>。删除主键时，也会直接删除主键索引。</p>
<p>如何建立主键？<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在主键列后面直接加主键约束，复合主键不能使用这种方式</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu(</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    gender <span class="built_in">CHAR</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 单独声明主键约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_course(</span><br><span class="line">    cid <span class="built_in">INT</span> ,</span><br><span class="line">    cname <span class="built_in">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    decription <span class="built_in">VARCHAR</span>(<span class="number">200</span>),</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span>(cid)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 声明复合主键，复合主键只能使用这种方式</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu_course(</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span>,</span><br><span class="line">    cid <span class="built_in">INT</span>,</span><br><span class="line">    score <span class="keyword">DOUBLE</span>(<span class="number">4</span>,<span class="number">1</span>),</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span>(<span class="keyword">sid</span>,cid)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 建表后添加主键约束</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名称 <span class="keyword">add</span> 【<span class="keyword">constraint</span> 约束名】 primary <span class="keyword">key</span> (字段名<span class="number">1</span>，字段名<span class="number">2</span>);</span><br></pre></td></tr></table></figure><br>如何删除主键和对应的索引？<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除主键约束，不需要指定主键名，因为一个表只有一个主键，删除主键约束后，非空还存在</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名称 <span class="keyword">drop</span> primary <span class="keyword">key</span>;</span><br></pre></td></tr></table></figure></p>
<p><strong>2、唯一键Unique key，简称UK</strong><br>（1）同一个表可以有多个唯一约束。<br>（2）唯一约束可以是某一个列的值唯一，也可以多个列组合值的唯一。<br>（3）MySQL会给唯一约束的列上默认创建一个<strong>唯一索引</strong>。<br>（4）删除唯一键，只能通过删除唯一索引的方式删除，删除时需要指定唯一索引名，唯一索引名和唯一约束名一样。如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同，如果是组合列，那么默认和()中排在第一个的列名相同。也可以自定义唯一性约束名。</p>
<p>主键和唯一键的区别：<br>（1）主键非空，唯一键允许空。<br>（2）主键一个表只能一个，唯一键可以有多个。</p>
<p>如何建立唯一性约束？<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在某个列后面直接加唯一性约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_course(</span><br><span class="line">    cid <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    cname <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span>,</span><br><span class="line">    description <span class="built_in">VARCHAR</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 单独指定表的唯一性约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu(</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    card_id <span class="built_in">CHAR</span>(<span class="number">18</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> uk_card_id <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span>(card_id)</span><br><span class="line">);<span class="comment">-- 其中 CONSTRAINT、uk_card_id、KEY可以省略</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 组合列唯一性约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu_course(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span>,</span><br><span class="line">    cid <span class="built_in">INT</span>,</span><br><span class="line">    score <span class="keyword">DOUBLE</span>(<span class="number">4</span>,<span class="number">1</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> uk_sid_cid <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span>(<span class="keyword">sid</span>,cid)</span><br><span class="line">);<span class="comment">-- 其中CONSTRAINT、uk_sid_cid、KEY可以省略</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 建表后增加唯一性约束</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span>表名称 <span class="keyword">add</span> 【<span class="keyword">constraint</span> 约束名】 <span class="keyword">unique</span> 【<span class="keyword">key</span>】 (字段名<span class="number">1</span>，字段名<span class="number">2</span>);</span><br></pre></td></tr></table></figure><br>如何删除唯一性约束和索引？<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 注意：如果忘记名称，可以通过“show index from 表名称;”查看</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名称 <span class="keyword">DROP</span> <span class="keyword">INDEX</span> 唯一性约束名;</span><br></pre></td></tr></table></figure><br><strong>3、外键Foreign key，简称FK</strong><br>（1）外键约束是保证一个或两个表之间的参照完整性，外键是构建于一个表的两个字段或是两个表的两个字段之间的参照关系。<br>（2）在创建外键约束时，如果不给外键约束名称，默认名不是列名，而是自动产生一个外键名，也可以自己指定外键约束名。<br>（3）当创建外键约束时，系统默认会在所在的列上建立对应的<strong>普通索引</strong>。但是索引名是列名，不是外键的约束名。<br>（4）删除外键时，关于外键列上的普通<strong>索引需要单独删除</strong>。<br>要求：<br>（1）一个表可以建立多个外键约束。一个表的两个字段或是两个表的两个字段之间的外键约束。<br>（2）在从表上建立外键，而且主表要先存在。如果要删除表，需要先删除从表，才能删除主表。<br>（3）从表的外键列，在主表中引用的只能是键列（主键，唯一键，外键）。<br>（4）从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样。<br>外键是双向约束：<br>（1）约束从表：从表的外键值必须“在主表中能找到”或者为NULL，从而约束了从表的外键列的值的“添加和修改”。<br>（6）主表约束：当主表的记录被从表参照时，主表中被参考记录的“删除和更新”也会受到限制。<br>　　（1）默认情况下，主表和从表是严格依赖关系RESTRICT。当主表的记录被从表参照时，主表的记录将不允许删除，如果要删除数据，需要先删除从表中依赖该记录的数据，然后才可以删除主表的数据。对于外键约束，最好是采用“更新级联，删除严格”的方式，即ON UPDATE CASCADE ON DELETE RESTRICT。<br>　　（2）ON DELETE SET NULL(级联置空)：当外键设置了SET NULL，当主表的相关记录删除时，从表对应的字段改为NULL。注意从表外键字段得允许为空才行。<br>　　（3）ON DELETE CASCADE(级联删除)：当外键设置了CASCADE（级联），当主表的相关记录删除时，从表对应的行都删除了。</p>
<p>5个约束方式：<br>（1）CASCADE：主动权在主表。在主表上update/delete记录时，同步update/delete掉从表的匹配记录。<br>（2）SET NULL：主动权在主表。在主表上update/delete记录时，将从表上匹配记录的列设为NULL，但是要注意从表的外键列不能为NOT NULL。<br>（3）NO ACTION、RESTRICT：主动权在从表。立即检查外键约束，如果从表中有匹配的记录，则不允许对主表对应候选键进行update/delete操作。<br>（4）Set DEFAULT：MySQL的Innodb引擎不支持。主表有变更时，从表将外键列设置成一个默认的值。在可视化工具SQLyog中可能显示空白。<br>如果没有指定等级，就相当于RESTRICT方式。</p>
<p>如何建立外键约束？<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">【constraint 外键约束名】 foreign key (从表字段) references 主表名(主表字段) 【on update 外键约束等级】【on delete 外键约束等级】</span></span><br><span class="line"><span class="comment">-- 外键只能在所有字段列表后面单独指定</span></span><br><span class="line"><span class="comment">-- 如果要自己命名外键约束名，建议“主表名_从表名_关联字段名_fk”</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建外键</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_department(</span><br><span class="line">    did <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    dname <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    description <span class="built_in">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_employee(</span><br><span class="line">    eid <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    ename <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    dept_id <span class="built_in">INT</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_emp_dept_did <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(dept_id) <span class="keyword">REFERENCES</span> t_department(did) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span> <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT</span><br><span class="line">    </span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 其中CONSTRAINT fk_emp_dept_did可以省略</span></span><br><span class="line"><span class="comment">-- ON UPDATE CASCADE ON DELETE RESTRICT如果省略表示都是RESTRICT</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 一个表可以有多个外键，而且主表和从表可以是一张表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_emp(</span><br><span class="line">    eid <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    ename <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    manager_id <span class="built_in">INT</span>,</span><br><span class="line">    dept_id <span class="built_in">INT</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_emp_dept_did <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(dept_id) <span class="keyword">REFERENCES</span> t_department(did)  <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span> <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_emp_mid_eid <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(manager_id) <span class="keyword">REFERENCES</span> t_emp(eid)  <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span> <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 建表后创建外键</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span>表名称 <span class="keyword">add</span> 【<span class="keyword">constraint</span> 约束名】 <span class="keyword">foreign</span> <span class="keyword">key</span> (从表字段名) <span class="keyword">references</span> 主表名(主表被参照字段名) 【<span class="keyword">on</span> <span class="keyword">update</span> 外键约束等级】【<span class="keyword">on</span> <span class="keyword">delete</span> 外键约束等级】;</span><br><span class="line"><span class="comment">-- 举例：</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_emp <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_emp_dept_did <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(dept_id) <span class="keyword">REFERENCES</span> t_department(did)  <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span> <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT;</span><br></pre></td></tr></table></figure><br>如何删除外键约束？<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 外键约束名记得查看下</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名称 <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> 外键约束名;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_emp <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> fk_emp_dept_did;</span><br><span class="line"><span class="comment">-- 查看约束名</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> information_schema.table_constraints <span class="keyword">WHERE</span> table_name = <span class="string">&#x27;表名称&#x27;</span>;</span><br></pre></td></tr></table></figure><br>如何删除外键列上的索引？需要单独删除。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名称 <span class="keyword">DROP</span> <span class="keyword">INDEX</span> 外键列索引名; </span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_emp <span class="keyword">DROP</span> <span class="keyword">INDEX</span> dept_id;</span><br><span class="line"><span class="comment">-- 查看索引名</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> 表名称;</span><br></pre></td></tr></table></figure></p>
<p><strong>4、检查约束</strong><br>注意： MySQL不支持check约束，MySQL可以使用check约束但没有任何效果。Oracle和SQL Server支持check约束。<br>例如：age tinyint check(age &gt;20)  或 sex char(2) check(sex in(‘男’,’女’))<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu(</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    gender <span class="built_in">CHAR</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">CHECK</span>(gender <span class="keyword">IN</span>(<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;女&#x27;</span>))</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p><strong>5、非空约束</strong><br>NOT NULL 非空约束，规定某个字段不能为空。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建时约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu(</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    cid <span class="built_in">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">    sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;无&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 创建后，对某列修改：原来非空，修改为允许空</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_stu <span class="keyword">MODIFY</span> sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;无&#x27;</span>;</span><br><span class="line"><span class="comment">-- 创建后，对某列修改：原来允许空，修改为非空</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_stu <span class="keyword">MODIFY</span> cid <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure></p>
<p><strong>6、缺省约束Default</strong><br>default：默认值，在插入数据时某列如果没指定其他的值，那么会将默认值添加到新记录。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建时约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu(</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    cid <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;无&#x27;</span>,</span><br><span class="line">    gender <span class="built_in">CHAR</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">CHECK</span>(gender <span class="keyword">IN</span>(<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;女&#x27;</span>))</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建后，对某列修改：原来有默认值，去除默认值</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_stu <span class="keyword">MODIFY</span> sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="comment">-- 创建后，对某列修改：原来没有默认值，增加默认值</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_stu <span class="keyword">MODIFY</span> cid <span class="built_in">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure><br><strong>7、自增约束AUTO_INCREMENT</strong><br>（1）一个表只能有一个自增长列，因为一个表只有一个维护自增值的变量。<br>（2）整数类型的列才可以设置自增长。<br>（3）自增长列必须是主键列或唯一键列。<br>（4）自增长列必须非空。<br>（5）当需要产生唯一标识符或顺序值时，可设置自增长。<br>（6）InnoDB表的自增长列可以手动插入，但插入的值若是 null 或 0 ，则实际插入的将是自动增长后的值。不建议对自增长列插入操作。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建时约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_stu(</span><br><span class="line">    <span class="keyword">sid</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">    sname <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    gender <span class="built_in">CHAR</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">    birthday <span class="built_in">DATE</span>,</span><br><span class="line">    address <span class="built_in">VARCHAR</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 创建后操作，同非空约束、缺省约束。注意MODIFY时不写的约束会去除掉，想留下的约束一定要写。</span></span><br></pre></td></tr></table></figure></p>
<p><strong>索引INDEX</strong><br>索引是对数据库表中一列或多列的值进行排序的一种结构。<br>索引是一个单独的、物理的数据库结构，它是某个表中一列或若干列值的集合和相应的指向表中物理标识这些值的数据页的逻辑指针清单。由此可知，索引是要消耗数据库空间的。而约束是一种逻辑概念。</p>
<p>例如，一本字典，如何快速找到某个字，可以给字典加目录，对数据库来说，索引的作用即是给“数据”加目录。</p>
<p>设有N条随机记录，不用索引，平均查找是N/2次，那么用了索引之后呢？如果是btree(二叉树)索引，时间复杂度是$\log_2N$，如果是hash(哈希)索引，时间复杂度是1。</p>
<p>索引好处：加快了查询速度(select)。<br>索引坏处：降低了增、删、改的速度(update/delete/insert)，增大了表的文件大小(索引文件甚至可能比数据文件还大)。</p>
<p>MySQL提供多种索引类型供选择：<br>（1）普通索引。<br>（2）唯一性索引。<br>（3）主键索引：只有一个主键索引。<br>（4）全文索引：MySQL5.X版本只有MyISAM存储引擎支持FULLTEXT，并且只限于CHAR、VARCHAR和TEXT类型的列上创建。</p>
<p>MySQL的索引方法：<br>（1）HASH<br>（2）BTREE<br>MySQL中多数索引都以BTREE的形式保存。</p>
<p>索引的使用原则：<br>（1）不过度索引。<br>（2）索引条件列(where后面最频繁的条件比较适宜索引)。<br>（3）索引散列值，过于集中的值不要索引，例如，给性别”男”,”女”加索引，意义不大。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> 索引名 <span class="keyword">ON</span> 表名称 (column_name,[column_name...]); <span class="comment">-- 最左边的列最关键</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名称 <span class="keyword">drop</span> <span class="keyword">index</span> 索引名;</span><br></pre></td></tr></table></figure></p>
<h2 id="SQL的DML"><a href="#SQL的DML" class="headerlink" title="SQL的DML"></a>SQL的DML</h2><p>数据操纵语言（DML）DML用于插入、修改、删除数据记录，包括如下SQL语句：<br>（1）INSERT：添加数据到数据库中。<br>（2）UPDATE：修改数据库中的数据。<br>（3）DELETE：删除数据库中的数据。</p>
<h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名称  <span class="keyword">VALUES</span>(值<span class="number">1</span>，值<span class="number">2</span>，...);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名称  <span class="keyword">VALUES</span>(值<span class="number">1</span>，值<span class="number">2</span>，...),(值<span class="number">1</span>，值<span class="number">2</span>，...),...;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名称 (字段<span class="number">1</span>，字段<span class="number">2</span>，...) <span class="keyword">VALUES</span>(值<span class="number">1</span>，值<span class="number">2</span>，...);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名称 (字段<span class="number">1</span>，字段<span class="number">2</span>，...) <span class="keyword">VALUES</span>(值<span class="number">1</span>，值<span class="number">2</span>，...),(值<span class="number">1</span>，值<span class="number">2</span>，...),...;</span><br></pre></td></tr></table></figure>
<p>1、值列表(值1，值2，…)的顺序、个数 与 字段列表(字段1，字段2，…) 中字段的顺序、个数一致：<br>　　如果个数少了就报Column count doesn’t match value count。<br>　　如果VALUES前面的()中没有列出字段，那么默认就是为表中的所有字段赋值，那么个数与顺序与表结构中字段定义的一致。<br>2、关于自增长列、默认值列、允许为NULL列的赋值：<br>　　（1）如果字段列表列出了字段名，那么值列表中就要为其赋值，哪怕它是自增长列，有默认值列，可以为NULL值的列。<br>　　　　　　InnoDB表的自动增长列可以手动插入合适的值，但是插入的值如果是NULL或者0，则实际插入的将是自动增长后的值；<br>　　　　　　如果列声明了“默认约束”那么对应的位置可以赋值具体的值，也可以使用“DEFAULT”，表示使用默认值；<br>　　　　　　如果列允许了NULL值，那么可以为对应的字段可以赋值为具体值也可以赋值为NULL；<br>　　（2）对于没有列出的字段，像自增列就自动赋值，像默认值列就自动赋默认值，像允许NULL的列就自动赋NULL值，但是非空列又没有提供默认值会自动赋值为对应数据类型的默认值，例如字符串赋值为空字符串，int赋值为0；<br>3、VALUES也可以写成VALUE，但是VALUES是标准写法。<br>4、可以同时插入多行。<br>5、如果插入从表的数据，要注意查看主表参照字段的值是否存在。<br>6、值的位置可以是常量值、表达式、函数。</p>
<h3 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> 表名称 <span class="keyword">SET</span> 字段名<span class="number">1</span> = 值<span class="number">1</span>, 字段名<span class="number">2</span>=值<span class="number">2</span>,... 【<span class="keyword">WHERE</span>  条件】; </span><br><span class="line"><span class="keyword">UPDATE</span> 表<span class="number">1</span>，表<span class="number">2</span>,...  <span class="keyword">SET</span>  表<span class="number">1.</span>字段名<span class="number">1</span>=值<span class="number">1</span>, 表<span class="number">1.</span>字段名<span class="number">2</span>=值<span class="number">2</span>, 表<span class="number">2.</span>字段<span class="number">1</span>=值<span class="number">1</span>, 表<span class="number">2.</span>字段<span class="number">2</span>=值<span class="number">2.</span>.. 【<span class="keyword">WHERE</span>  条件】; </span><br></pre></td></tr></table></figure>
<p>1、如果不写where条件，会修改该字段的所有行。<br>2、值可以是常量值、表达式、函数。<br>3、可以同时更新多张表：如果两个表没有建立外键，但逻辑上有外键关系。<br>4、如果修改从表外键字段的数据，要注意查看主表参照字段的值是否存在。<br>5、如果修改主表的被参考的字段的值，要注意查看从表的外键是否有依赖该值，如果有：<br>（1）如果外键是on update RESTRICT或on update NO ACTION，那么要先处理从表的数据，才能修改。<br>（2）如果外键是on update SET NULL 或 on update CASCADE，那么直接修改，从表的外键字段会自动处理。</p>
<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> 表名 【<span class="keyword">where</span> 条件】;</span><br><span class="line"><span class="keyword">delete</span> 表<span class="number">1</span>，表<span class="number">2</span>,... <span class="keyword">from</span> 表<span class="number">1</span>，表<span class="number">2</span>，... 【<span class="keyword">where</span> 条件】;</span><br></pre></td></tr></table></figure>
<p>1、如果不加where条件，表示删除整张表的数据，表结构保留。<br>2、删除整张表的数据还可以使用<code>truncate 表名;</code>。和delete区别：truncate相当于删除表再重建一张同名结构的表，操作后得到一张全新表，而delete是在原有表中删除数据。如果决定清空一张表的数据，truncate速度更快一些。truncate语句不能回滚。<br>3、如果删除主表的记录，要注意查看从表的外键是否有依赖该行的值，如果有：<br>（1）如果外键是on delete RESTRICT或on delete NO ACTION，那么要先处理从表的数据，才能删除。<br>（2）如果外键是on delete SET NULL 或 on delete CASCADE，那么删除时从表的对应记录也会被置空或跟着删除。<br>4、可以一次删除多个表的数据：两个表没有建立外键，但逻辑上有外键关系，也可以通过删除多个表的数据来实现级联删除。</p>
<h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 基础版</span></span><br><span class="line"><span class="keyword">SELECT</span> 查询列表</span><br><span class="line">  <span class="keyword">FROM</span> 表名或视图列表</span><br><span class="line">  【<span class="keyword">WHERE</span> 条件表达式】</span><br><span class="line">  【<span class="keyword">GROUP</span> <span class="keyword">BY</span> 字段名 【<span class="keyword">HAVING</span> 条件表达式】】</span><br><span class="line">  【<span class="keyword">ORDER</span> <span class="keyword">BY</span> 字段 【<span class="keyword">ASC</span>|<span class="keyword">DESC</span>】】</span><br><span class="line">  【<span class="keyword">LIMIT</span> m,n】;</span><br><span class="line"><span class="comment">-- 强化版</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    【<span class="keyword">DISTINCT</span>]</span><br><span class="line">    <span class="keyword">select</span> 查询列表, ...</span><br><span class="line">    <span class="keyword">FROM</span> 表名或视图列表</span><br><span class="line">    【<span class="keyword">WHERE</span> 条件表达式】</span><br><span class="line">    【<span class="keyword">GROUP</span> <span class="keyword">BY</span> &#123;col_name | expr | <span class="keyword">position</span>&#125;</span><br><span class="line">        【<span class="keyword">ASC</span> | <span class="keyword">DESC</span>】, ... 【<span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>】】</span><br><span class="line">    【<span class="keyword">HAVING</span> 条件表达式】</span><br><span class="line">    【<span class="keyword">ORDER</span> <span class="keyword">BY</span> &#123;col_name | expr | <span class="keyword">position</span>&#125;</span><br><span class="line">        【<span class="keyword">ASC</span> | <span class="keyword">DESC</span>】 , ...】</span><br><span class="line">    【<span class="keyword">LIMIT</span> &#123;【<span class="keyword">offset</span>,】 <span class="keyword">row_count</span> | <span class="keyword">row_count</span> <span class="keyword">OFFSET</span> <span class="keyword">offset</span>&#125;】</span><br><span class="line">    【<span class="keyword">FOR</span> <span class="keyword">UPDATE</span> | <span class="keyword">LOCK</span> <span class="keyword">IN</span> <span class="keyword">SHARE</span> <span class="keyword">MODE</span>】】</span><br></pre></td></tr></table></figure>
<p>（1）如果SELECT后面是*，那么表示查询所有字段。<br>（2）SELECT后面的查询列表，可以是表中的字段，常量值，表达式，函数。<br>（3）查询的结果是一个虚拟的表。<br>（4）select可以包含5种子句：依次是where、 group by、having、 order by、limit必须照这个顺序。</p>
<p><strong>1、别名AS</strong><br>用法：<code>AS 别名</code><br>可以给字段取别名、可以给表名取别名：<br>（2）AS 可以省略。<br>（3）如果给字段取别名，如果别名中包含特殊符号，例如“空格”等，建议给别名加上双引号或单引号。<br>（4）如果是给表名取别名，那么不能加双引号或单引号，也不能有特殊符号，例如“空格”等。<br>（5）建议别名简短，见名知意。</p>
<p><strong>2、去重DISTINCT</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工表的部门编号</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> dept_id <span class="keyword">FROM</span> t_employee;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 统计员工表中员工有几个部门</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> dept_id) <span class="keyword">FROM</span> t_employee;  </span><br></pre></td></tr></table></figure><br><strong>3、`着重号`</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">`name`</span> <span class="keyword">from</span> t_stu;</span><br></pre></td></tr></table></figure><br>可以给字段或表名加着重号。<br>如果字段名或表名与关键字一样更要加着重号了。</p>
<h2 id="MySQL的运算符"><a href="#MySQL的运算符" class="headerlink" title="MySQL的运算符"></a>MySQL的运算符</h2><p>（1）算术运算符：+、-、*、/（同div，但只保留整数部分)、%（同mod）。<br>（2）比较运算符：=、&gt;、&gt;=、&lt;、&lt;=、!=（同&lt;&gt;）、&lt;=&gt;（安全等于，用于判断null值）。<br>（3）逻辑运算符：&amp;&amp;（同and）、||（同or）、!（同not）、xor（逻辑异或）。<br>（4）范围：表达式 between … and … （表达式&gt;=… and 表达式 &lt;=…）、表达式 not between … and …（表达式&lt;…  || 表达式 &gt;…）。<br>（5）集合：in (a,b,c…)、not in(a,b,c…) 。<br>（6）模糊查询：like  、not like。配合通配符（%代表0-n个字符，_代表一个字符）使用。<br>（7）位运算符：&amp;（按位与）、|（按位或）、^（按位异或）、~（按位取反）、&gt;&gt;（右移）、&lt;&lt;（左移）。<br>（8）null值判断：is null 或 is not null。如果使用null=null、null&lt;&gt;null、null=0、null&lt;&gt;0、null=false等都不对。不过xxx is null 可以使用xxx &lt;=&gt; null ，xxx  is not null 可以写成 not xxx &lt;=&gt; null。<br>结论：所有的运算符遇到null结果都是null，除了&lt;=&gt;。</p>
<p>注意事项：<br>（1）关于+，在Java中，+的左右两边如果有字符串，那么表示字符串的拼接。但是在MySQL中+只表示数值相加，如果遇到非数值类型，先尝试转成数值，如果转失败，就按0计算。MySQL中字符串拼接要使用字符串函数concat实现。<br>（2）null判断最好用is null（&lt;=&gt;null）、is not null（not xxx &lt;=&gt; null）。<br><div class="tabs" id="sqlnull"><ul class="nav-tabs"><li class="tab active"><a href="#sqlnull-1">算术运算符</a></li><li class="tab"><a href="#sqlnull-2">比较运算符</a></li><li class="tab"><a href="#sqlnull-3">逻辑运算符</a></li><li class="tab"><a href="#sqlnull-4">范围和集合</a></li><li class="tab"><a href="#sqlnull-5">模糊查询</a></li><li class="tab"><a href="#sqlnull-6">位运算符</a></li><li class="tab"><a href="#sqlnull-7">NULL值判断与处理</a></li></ul><div class="tab-content"><div class="tab-pane active" id="sqlnull-1"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- +,-,*,/(div),%(mod)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 筛选出eid是偶数的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> eid % <span class="number">2</span> = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> eid <span class="keyword">MOD</span> <span class="number">2</span> = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看每天的基本工资值，每个月按22天算</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary/<span class="number">12</span> <span class="keyword">AS</span> <span class="string">&quot;日薪&quot;</span></span><br><span class="line"><span class="keyword">FROM</span> t_salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- div也表示除，但是只保留整数部分</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">DIV</span> <span class="number">12</span> <span class="keyword">AS</span> <span class="string">&quot;日薪&quot;</span></span><br><span class="line"><span class="keyword">FROM</span> t_salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关于+，在Java中，+的左右两边如果有字符串，那么表示字符串的拼接,但是在MySQL中+只表示数值相加，</span></span><br><span class="line"><span class="comment">-- 如果遇到非数值类型，先尝试转成数值，如果转失败，就按0计算</span></span><br><span class="line"><span class="keyword">SELECT</span> eid+ename <span class="keyword">FROM</span> t_employee;</span><br><span class="line"><span class="keyword">SELECT</span> eid+birthday <span class="keyword">FROM</span> t_employee;</span><br><span class="line"></span><br><span class="line"><span class="comment">#MySQL中字符串拼接要使用字符串函数实现</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(eid,<span class="string">&quot;:&quot;</span>,ename) <span class="keyword">AS</span> <span class="keyword">result</span> <span class="keyword">FROM</span> t_employee;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="sqlnull-2"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- =，&gt;, &lt;，&gt;=, &lt;=， !=(不等于&lt;&gt;)，&lt;=&gt;（安全等于）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询basic_salary!=10000</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> basic_salary != <span class="number">10000</span>;</span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> basic_salary &lt;&gt; <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询basic_salary=10000，注意在Java中比较是==</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> basic_salary = <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询commission_pct等于0.40</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,commission_pct <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> commission_pct = <span class="number">0.40</span>;</span><br><span class="line"><span class="keyword">SELECT</span> eid,commission_pct <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> commission_pct &lt;=&gt; <span class="number">0.40</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询commission_pct等于NULL</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,commission_pct <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">SELECT</span> eid,commission_pct <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> commission_pct &lt;=&gt; <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询commission_pct不等于NULL</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,commission_pct <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">SELECT</span> eid,commission_pct <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> <span class="keyword">NOT</span> commission_pct &lt;=&gt; <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="sqlnull-3"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 与&amp;&amp;，或||，非!</span></span><br><span class="line"><span class="comment">-- 与AND，或OR ，非NOT，异或XOR</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询性别男，并且在90以前出生的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> gender=<span class="string">&#x27;男&#x27;</span> <span class="keyword">AND</span> birthday&lt;<span class="string">&#x27;1990-01-01&#x27;</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询职位编号job_id是1或2的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> job_id =<span class="number">1</span> <span class="keyword">OR</span> job_id = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询基本薪资是在9000-12000之间的员工编号和基本薪资</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> basic_salary &gt;=<span class="number">9000</span> <span class="keyword">AND</span> basic_salary&lt;=<span class="number">12000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询基本薪资不在9000-12000之间的员工编号和基本薪资</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> <span class="keyword">NOT</span> (basic_salary &gt;=<span class="number">9000</span> <span class="keyword">AND</span> basic_salary&lt;=<span class="number">12000</span>);</span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> basic_salary &lt;<span class="number">9000</span> <span class="keyword">OR</span> basic_salary&gt;<span class="number">12000</span>;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="sqlnull-4"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- between ... and ... 和 not between ... and ... </span></span><br><span class="line"><span class="comment">-- in(集合)  和 not in(...)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询基本薪资是在9000-12000之间的员工编号和基本薪资</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> basic_salary <span class="keyword">BETWEEN</span> <span class="number">9000</span> <span class="keyword">AND</span> <span class="number">12000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询eid是1,3,5的基本工资</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> eid <span class="keyword">IN</span> (<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>);</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="sqlnull-5"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- like 和 通配符 一起使用</span></span><br><span class="line"><span class="comment">-- like _ 匹配单个字符</span></span><br><span class="line"><span class="comment">-- like % 匹配任意个字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询名字中有&#x27;冰&#x27;字的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> ename <span class="keyword">LIKE</span> <span class="string">&#x27;%冰%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询姓李的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> ename <span class="keyword">LIKE</span> <span class="string">&#x27;李%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询姓李，名字就一个字的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> ename <span class="keyword">LIKE</span> <span class="string">&#x27;李_&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询李冰冰的信息</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> ename <span class="keyword">LIKE</span> <span class="string">&#x27;李冰冰&#x27;</span>;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="sqlnull-6"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- &gt;&gt; &lt;&lt; &amp; | ~  ^（异或）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">2</span>^<span class="number">3</span>,<span class="number">2</span>&amp;<span class="number">3</span>,<span class="number">2</span>|<span class="number">3</span>,<span class="number">2</span>&gt;&gt;<span class="number">3</span>,<span class="number">2</span>&lt;&lt;<span class="number">3</span>,~<span class="number">3</span>;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="sqlnull-7"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询奖金百分比不为空的员工编号</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,commission_pct <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询奖金百分比为空的员工编号</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,commission_pct <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关于null值计算</span></span><br><span class="line"><span class="comment">-- 所有运算符遇到null都是null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算实际的薪资：  basic_salary + salary * 奖金百分比</span></span><br><span class="line"><span class="comment">-- 函数：IFNULL(表达式,用什么值代替)</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary + performance_salary *(<span class="number">1</span>+ commission_pct) <span class="keyword">FROM</span> t_salary;<span class="comment">#错误的</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary + performance_salary *(<span class="number">1</span>+ <span class="keyword">IFNULL</span>(commission_pct,<span class="number">0</span>)) <span class="keyword">FROM</span> t_salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- &lt;=&gt;安全等于</span></span><br><span class="line"><span class="comment">-- 查询奖金百分比为空的员工编号</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,commission_pct <span class="keyword">FROM</span> t_salary <span class="keyword">WHERE</span> commission_pct &lt;=&gt; <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure></div></div></div></p>
<h2 id="关联查询，联合查询"><a href="#关联查询，联合查询" class="headerlink" title="关联查询，联合查询"></a>关联查询，联合查询</h2><p><img src="https://i.loli.net/2021/04/21/d78Iuzc1KqVT6N2.png" width="80%" height="80%"><br>目的：从2张或多张表中，取出有关联的数据。</p>
<p>关联查询一共有几种情况：<br>（1）内连接：INNER JOIN 、CROSS JOIN。<br>（2）外连接：左外连接（LEFT OUTER JOIN）、右外连接（RIGHT OUTER JOIN）、全外连接（FULL OUTER JOIN）。外连接必须写关联条件，否则报语法错误。<br>（3）自连接：当table1和table2本质上是同一张表，只是用取别名的方式虚拟成两张表以代表不同的意义。<br>说明：<br>（1）连接 n个表,至少需要 n-1个连接条件。 例如：连接三个表，至少需要两个连接条件。<br>（2）当两个关联查询的表如果有字段名字相同，并且要查询中涉及该关联字段，那么需要使用表名前缀加以区分。<br>（3）当如果表名比较长时，可以给表取别名，简化SQL语句。</p>
<h3 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h3><p>定义：将两（或多）个表的所有行进行组合，连接后的行数为两（或多）个表的乘积数。</p>
<p>在MySQL中，缺少关联条件或者关联条件不准确，就会出现笛卡尔积，要避免这种情况出现。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 笛卡尔积</span></span><br><span class="line"><span class="comment">-- 查询员工姓名和所在部门名称</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee,t_department;</span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_department;</span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> t_department;</span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee <span class="keyword">JOIN</span> t_department;</span><br></pre></td></tr></table></figure></p>
<h3 id="关联条件"><a href="#关联条件" class="headerlink" title="关联条件"></a>关联条件</h3><p>表连接的约束条件可以有三种方式：<br>（1）WHERE：适用于所有关联查询。<br>（2）ON：<strong>只能和JOIN一起使用</strong>，只能写关联条件。虽然关联条件可以并到WHERE中和其他条件一起写，但分开写可读性更好。<br>（3）USING：只能和JOIN一起使用，而且要求<strong>两个</strong>关联字段在关联表中名称一致，而且只能表示关联字段值相等。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 关联条件</span></span><br><span class="line"><span class="comment">-- 把关联条件写在where后面</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee,t_department <span class="keyword">WHERE</span> t_employee.dept_id=t_department.did;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 把关联条件写在on后面，只能和JOIN一起使用</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_department <span class="keyword">ON</span> t_employee.dept_id=t_department.did;</span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> t_department <span class="keyword">ON</span> t_employee.dept_id=t_department.did;</span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee <span class="keyword">JOIN</span> t_department <span class="keyword">ON</span> t_employee.dept_id=t_department.did;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 把关联字段写在using()中，只能和JOIN一起使用</span></span><br><span class="line"><span class="comment">-- 而且两个表中的关联字段必须名称相同，而且只能表示=</span></span><br><span class="line"><span class="comment">-- 查询员工姓名与基本工资</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,basic_salary <span class="keyword">FROM</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_salary <span class="keyword">USING</span>(eid);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- n张表关联，需要n-1个关联条件</span></span><br><span class="line"><span class="comment">-- 查询员工姓名，基本工资，部门名称</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,basic_salary,dname <span class="keyword">FROM</span> t_employee,t_department,t_salary </span><br><span class="line"><span class="keyword">WHERE</span> t_employee.dept_id=t_department.did <span class="keyword">AND</span> t_employee.eid=t_salary.eid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> ename,basic_salary,dname <span class="keyword">FROM</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_department <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_salary </span><br><span class="line"><span class="keyword">ON</span> t_employee.dept_id=t_department.did <span class="keyword">AND</span> t_employee.eid=t_salary.eid;</span><br></pre></td></tr></table></figure></p>
<h3 id="内连接（INNER-JOIN）"><a href="#内连接（INNER-JOIN）" class="headerlink" title="内连接（INNER JOIN）"></a>内连接（INNER JOIN）</h3><p><img src="https://i.loli.net/2021/04/21/MjUZOeWVkliRHzc.jpg" width="25%" height="25%"></p>
<p>A∩B有两种，显式的和隐式的，返回连接表中符合连接条件和查询条件的数据行。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 显式</span></span><br><span class="line"><span class="keyword">SELECT</span> [cols_list] <span class="keyword">from</span> 表<span class="number">1</span>,表<span class="number">2</span>  <span class="keyword">where</span> [condition] <span class="comment">-- ON条件写在where中</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 隐式</span></span><br><span class="line"><span class="keyword">SELECT</span> [cols_list] <span class="keyword">from</span> 表<span class="number">1</span>  <span class="keyword">INNER</span> <span class="keyword">JOIN</span> 表<span class="number">2</span>  <span class="keyword">ON</span> [关联条件] <span class="keyword">where</span> [其他筛选条件]</span><br><span class="line"><span class="keyword">SELECT</span> [cols_list] <span class="keyword">from</span> 表<span class="number">1</span>  <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> 表<span class="number">2</span>  <span class="keyword">ON</span> [关联条件] <span class="keyword">where</span> [其他筛选条件]</span><br><span class="line"><span class="keyword">SELECT</span> [cols_list] <span class="keyword">from</span> 表<span class="number">1</span>  <span class="keyword">JOIN</span> 表<span class="number">2</span>  <span class="keyword">ON</span> [关联条件] <span class="keyword">where</span> [其他筛选条件]</span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工姓名和所在部门名称</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee,t_department <span class="keyword">WHERE</span> t_employee.dept_id=t_department.did;</span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_department <span class="keyword">ON</span> t_employee.dept_id=t_department.did;</span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> t_department <span class="keyword">ON</span> t_employee.dept_id=t_department.did;</span><br><span class="line"><span class="keyword">SELECT</span> ename,dname <span class="keyword">FROM</span> t_employee <span class="keyword">JOIN</span> t_department <span class="keyword">ON</span> t_employee.dept_id=t_department.did;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询员工姓名，基本工资，部门名称</span></span><br><span class="line"><span class="keyword">SELECT</span> ename,basic_salary,dname <span class="keyword">FROM</span> t_employee,t_department,t_salary </span><br><span class="line"><span class="keyword">WHERE</span> t_employee.dept_id=t_department.did <span class="keyword">AND</span> t_employee.eid=t_salary.eid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> ename,basic_salary,dname <span class="keyword">FROM</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_department <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_salary </span><br><span class="line"><span class="keyword">ON</span> t_employee.dept_id=t_department.did <span class="keyword">AND</span> t_employee.eid=t_salary.eid;</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/04/22/u9QnvFIEhlaC4mc.jpg" alt="查询员工姓名和所在部门名称"></p>
<h3 id="外连接（OUTER-JOIN）"><a href="#外连接（OUTER-JOIN）" class="headerlink" title="外连接（OUTER  JOIN）"></a>外连接（OUTER  JOIN）</h3><p>（1）左外连接（LEFT OUTER JOIN），简称左连接（LEFT JOIN）。<br>（2）右外连接（RIGHT OUTER JOIN），简称右连接（RIGHT JOIN）。<br>（3）全外连接（FULL OUTER JOIN），简称全连接（FULL JOIN）。</p>
<p><strong>左连接（LEFT JOIN）</strong><br>第一种：返回左表中的所有行，如果左表中行在右表中没有匹配行，则结果中右表中的列返回空值（A）。<br><img src="https://i.loli.net/2021/04/21/5M62PmzS7gZpwt1.jpg" width="25%" height="25%"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有部门信息以及该部门员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> did,dname,eid,ename </span><br><span class="line"><span class="keyword">FROM</span> t_department <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_employee</span><br><span class="line"><span class="keyword">ON</span> t_department.did = t_employee.dept_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询所有员工信息，以及员工的部门信息</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,ename,did,dname</span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_department</span><br><span class="line"><span class="keyword">ON</span> t_employee.dept_id = t_department.did ;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/04/22/ZLT2hpACxuiIOjQ.jpg" alt="查询所有部门信息以及该部门员工信息"><br><img src="https://i.loli.net/2021/04/22/DfvU4juRO32Tc7e.jpg" alt="查询所有员工信息，以及员工的部门信息"></p>
<p>第二种：返回左边中行在右表中没有匹配行的记录（A - A∩B）。<br><img src="https://i.loli.net/2021/04/21/2mvCVwKXgGFnWSj.jpg" width="25%" height="25%"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询部门信息，仅保留没有员工的部门信息</span></span><br><span class="line"><span class="comment">-- “从表外键列”是NULL</span></span><br><span class="line"><span class="keyword">SELECT</span> did,dname,eid,ename </span><br><span class="line"><span class="keyword">FROM</span> t_department <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_employee</span><br><span class="line"><span class="keyword">ON</span> t_department.did = t_employee.dept_id</span><br><span class="line"><span class="keyword">WHERE</span> t_employee.dept_id <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询员工信息，仅保留没有分配部门的员工</span></span><br><span class="line"><span class="comment">-- “从表外键列”是NULL</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,ename,did,dname</span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_department</span><br><span class="line"><span class="keyword">ON</span> t_employee.dept_id = t_department.did </span><br><span class="line"><span class="keyword">WHERE</span> t_employee.dept_id <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/04/22/n6YvjUo4i1x9put.jpg" alt="查询部门信息，仅保留没有员工的部门信息"><br><img src="https://i.loli.net/2021/04/22/xg1izFBADYvoJVW.jpg" alt="查询员工信息，仅保留没有分配部门的员工"></p>
<p><strong>右连接（RIGHT JOIN）</strong><br>第一种：恰与左连接相反，返回右表中的所有行，如果右表中行在左表中没有匹配行，则结果中左表中的列返回空值（B）。<br><img src="https://i.loli.net/2021/04/22/5Z96Wxy2ztXlGUH.jpg" width="25%" height="25%"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有部门信息以及该部门员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> did,dname,eid,ename </span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_department</span><br><span class="line"><span class="keyword">ON</span> t_department.did = t_employee.dept_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询所有员工信息，以及员工的部门信息</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,ename,did,dname</span><br><span class="line"><span class="keyword">FROM</span> t_department <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_employee</span><br><span class="line"><span class="keyword">ON</span> t_employee.dept_id = t_department.did ;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/04/22/CQu2bayw6g7ONjo.jpg" alt="查询所有部门信息以及该部门员工信息"><br><img src="https://i.loli.net/2021/04/22/ytK3Z2j6zCRwWoM.jpg" alt="查询所有员工信息，以及员工的部门信息"></p>
<p>第二种：返回右表中在左表没有匹配行的记录（B-A∩B）。<br><img src="https://i.loli.net/2021/04/22/uIRvT6KcBpF3gYq.jpg" width="25%" height="25%"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询部门信息，仅保留没有员工的部门信息</span></span><br><span class="line"><span class="comment">-- “从表外键列”是NULL</span></span><br><span class="line"><span class="keyword">SELECT</span> did,dname,eid,ename </span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_department</span><br><span class="line"><span class="keyword">ON</span> t_department.did = t_employee.dept_id</span><br><span class="line"><span class="keyword">WHERE</span> t_employee.dept_id <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询员工信息，仅保留没有分配部门的员工</span></span><br><span class="line"><span class="comment">-- “从表外键列”是NULL</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,ename,did,dname</span><br><span class="line"><span class="keyword">FROM</span> t_department <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_employee</span><br><span class="line"><span class="keyword">ON</span> t_employee.dept_id = t_department.did </span><br><span class="line"><span class="keyword">WHERE</span> t_employee.dept_id <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/04/22/MWaVLFZSh1N9Gbs.jpg" alt="查询部门信息，仅保留没有员工的部门信息"><br><img src="https://i.loli.net/2021/04/22/EFL8bzD7wBPC5mg.jpg" alt="查询员工信息，仅保留没有分配部门的员工"></p>
<p><strong>外连接（FULL JOIN）</strong><br>MySQL不支持FULL JOIN，但是可以用合并 UNION 代替。</p>
<p>第一种：A∪B。MySQL中，左连接的第一种 UNION 右连接的第一种。<br><img src="https://i.loli.net/2021/04/22/3eJMziZfgroSbqh.jpg" width="40%" height="40%"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有部门信息和员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> did,dname,eid,ename </span><br><span class="line"><span class="keyword">FROM</span> t_department <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_employee</span><br><span class="line"><span class="keyword">ON</span> t_department.did = t_employee.dept_id</span><br><span class="line"><span class="keyword">UNION</span> </span><br><span class="line"><span class="keyword">SELECT</span> did,dname,eid,ename </span><br><span class="line"><span class="keyword">FROM</span> t_department <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_employee</span><br><span class="line"><span class="keyword">ON</span> t_department.did = t_employee.dept_id;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/04/22/hfNxSI9gCpdTjRW.jpg" alt="查询所有部门信息和员工信息"></p>
<p>第二种：A∪B - A∩B。MySQL中，左连接的第二种 UNION 右连接的第二种。<br><img src="https://i.loli.net/2021/04/22/71shqV4xR3rdBXv.jpg" width="40%" height="40%"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有没有员工的部门和没有分配部门的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> did,dname,eid,ename </span><br><span class="line"><span class="keyword">FROM</span> t_department <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_employee</span><br><span class="line"><span class="keyword">ON</span> t_department.did = t_employee.dept_id</span><br><span class="line"><span class="keyword">WHERE</span> t_employee.dept_id <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> did,dname,eid,ename </span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> t_department</span><br><span class="line"><span class="keyword">ON</span> t_department.did = t_employee.dept_id</span><br><span class="line"><span class="keyword">WHERE</span> t_employee.dept_id <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/04/22/bJhClzFfZiyKPnr.jpg" alt="查询所有没有员工的部门和没有分配部门的员工"></p>
<h3 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h3><p>当table1和table2本质上是同一张表，只是用取别名的方式虚拟成两张表以代表不同的意义，然后两个表再进行内连接，外连接等查询。</p>
<h2 id="select的5个子句"><a href="#select的5个子句" class="headerlink" title="select的5个子句"></a>select的5个子句</h2><h3 id="where条件查询"><a href="#where条件查询" class="headerlink" title="where条件查询"></a>where条件查询</h3><p>从原表中的记录中进行筛选。</p>
<h3 id="group-by-分组查询"><a href="#group-by-分组查询" class="headerlink" title="group by 分组查询"></a>group by 分组查询</h3><p>很多情况下，用户都需要进行一些汇总操作，比如统计整个公司的人数或者统计每一个部门的人数等。</p>
<p><strong>聚合函数</strong><br>（1）<code>AVG(【DISTINCT】expr)</code>：返回expr的平均值。<br>（2）<code>COUNT(【DISTINCT】expr)</code>：返回expr的非NULL值的数目。<br>（3）<code>MIN(【DISTINCT】expr)</code>：返回expr的最小值。<br>（4）<code>MAX(【DISTINCT】expr)</code>：返回expr的最大值。<br>（5）<code>SUM(【DISTINCT】expr)</code>：返回expr的总和。</p>
<p><strong>面试：用count(*)，count(1)，count(字段名)谁好呢?</strong><br>对于myisam引擎的表，没有区别的。这种引擎内部有一计数器在维护着行数。<br>对于Innodb引擎的表，用count(*)直接读行数，效率很低，因为innodb真的要去数一遍。<br>count(*)和count(1)统计包括NULL值，count(字段名)统计不包括NULL值。</p>
<p><strong>MySQL中，在SELECT列表中最好不要出现GROUP BY子句中没有的列，虽然有结果但没有意义。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 聚合函数</span></span><br><span class="line"><span class="comment">-- AVG(【DISTINCT】 expr) 返回expr的平均值</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(basic_salary) <span class="keyword">FROM</span> t_salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- COUNT（【DISTINCT】 expr）返回expr的非NULL值的数目</span></span><br><span class="line"><span class="comment">-- 统计员工总人数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> t_employee;<span class="comment">#count(*)统计的是记录数</span></span><br><span class="line"><span class="comment">-- 统计员工表的员工所在部门数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(dept_id) <span class="keyword">FROM</span> t_employee;<span class="comment">#统计的是非NULL值</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> dept_id) <span class="keyword">FROM</span> t_employee;<span class="comment">#统计的是非NULL值，并且去重</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- MIN(【DISTINCT】 expr)返回expr的最小值</span></span><br><span class="line"><span class="comment">-- 查询最低基本工资值</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MIN</span>(basic_salary) <span class="keyword">FROM</span> t_salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- MAX(【DISTINCT】 expr)返回expr的最大值</span></span><br><span class="line"><span class="comment">-- 查询最高基本工资值</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(basic_salary) <span class="keyword">FROM</span> t_salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询最高基本工资与最低基本工资的差值</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(basic_salary)-<span class="keyword">MIN</span>(basic_salary) <span class="keyword">FROM</span> t_salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SUM（【DISTINCT】 expr）返回expr的总和</span></span><br><span class="line"><span class="comment">-- 查询基本工资总和</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(basic_salary) <span class="keyword">FROM</span> t_salary;</span><br></pre></td></tr></table></figure>
<p><strong>group by + 聚合函数 ：</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- group by + 聚合函数</span></span><br><span class="line"><span class="comment">-- 统计每个部门的人数</span></span><br><span class="line"><span class="keyword">SELECT</span> dept_id,<span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> t_employee</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> dept_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 统计每个部门的平均基本工资</span></span><br><span class="line"><span class="keyword">SELECT</span> emp.dept_id,<span class="keyword">AVG</span>(s.basic_salary )</span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">AS</span> emp,t_salary <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">WHERE</span> emp.eid = s.eid</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> emp.dept_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 统计每个部门的年龄最大者</span></span><br><span class="line"><span class="keyword">SELECT</span> dept_id,<span class="keyword">MIN</span>(birthday) <span class="keyword">FROM</span> t_employee <span class="keyword">GROUP</span> <span class="keyword">BY</span> dept_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 统计每个部门基本工资最高者</span></span><br><span class="line"><span class="keyword">SELECT</span> emp.dept_id,<span class="keyword">MAX</span>(s.basic_salary )</span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">AS</span> emp,t_salary <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">WHERE</span> emp.eid = s.eid</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> emp.dept_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 统计每个部门基本工资之和</span></span><br><span class="line"><span class="keyword">SELECT</span> emp.dept_id,<span class="keyword">SUM</span>(s.basic_salary )</span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">AS</span> emp,t_salary <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">WHERE</span> emp.eid = s.eid</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> emp.dept_id;</span><br></pre></td></tr></table></figure></p>
<h3 id="having-筛选"><a href="#having-筛选" class="headerlink" title="having 筛选"></a>having 筛选</h3><p>having与where类似，可筛选数据。<br>having与where不同点：<br>（1）where针对表中的列发挥作用。having针对查询结果中的列发挥作用。<br>（2）where不能用分组函数，而having可以用分组函数。<br>（3）having只用于group by分组统计语句之后。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 按照部门统计员工人数，仅显示部门人数少于3人的</span></span><br><span class="line"><span class="keyword">SELECT</span> dept_id,<span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> c </span><br><span class="line"><span class="keyword">FROM</span> t_employee </span><br><span class="line"><span class="keyword">WHERE</span> dept_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> dept_id</span><br><span class="line"><span class="keyword">HAVING</span> c &lt;<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询每个部门的平均工资，并且仅显示平均工资高于10000</span></span><br><span class="line"><span class="keyword">SELECT</span> emp.dept_id,<span class="keyword">AVG</span>(s.basic_salary ) <span class="keyword">AS</span> avg_salary</span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">AS</span> emp,t_salary <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">WHERE</span> emp.eid = s.eid <span class="keyword">AND</span> dept_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> emp.dept_id</span><br><span class="line"><span class="keyword">HAVING</span> avg_salary &gt;<span class="number">10000</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="order-by-排序"><a href="#order-by-排序" class="headerlink" title="order by 排序"></a>order by 排序</h3><p>1、按一个或多个字段对查询结果进行排序。<br>说明：先按col1排序如果col1相同就按照col2排序，依次类推。col1，col2，col3可以是select后面的字段也可以不是。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 用法：</span></span><br><span class="line">order by col1,col2,col3...</span><br></pre></td></tr></table></figure></p>
<p>2、默认是升序，也可以在字段后面加asc显示说明是升序，desc为降序。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 例如：</span></span><br><span class="line">order by click_count desc; </span><br><span class="line"><span class="comment">-- 如果两个字段排序不一样，例如：</span></span><br><span class="line">order by 字段1 asc ,字段2 desc;</span><br></pre></td></tr></table></figure><br>3、order by 后面除了跟1个或多个字段，还可以写表达式，函数，别名等。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 排序</span></span><br><span class="line"><span class="comment">-- 查询员工基本工资，按照基本工资升序排列，如果工资相同，按照eid升序排列</span></span><br><span class="line"><span class="keyword">SELECT</span> t_employee.eid,basic_salary <span class="keyword">FROM</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_salary</span><br><span class="line"><span class="keyword">ON</span> t_employee.eid = t_salary.eid</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> basic_salary,eid;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询员工基本工资，按照基本工资降序排列，如果工资相同，按照eid排列</span></span><br><span class="line"><span class="keyword">SELECT</span> t_employee.eid,basic_salary <span class="keyword">FROM</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_salary</span><br><span class="line"><span class="keyword">ON</span> t_employee.eid = t_salary.eid</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> basic_salary <span class="keyword">DESC</span>,eid;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 统计每个部门的平均基本工资，并按照平均工资降序排列</span></span><br><span class="line"><span class="keyword">SELECT</span> emp.dept_id,<span class="keyword">AVG</span>(s.basic_salary)</span><br><span class="line"><span class="keyword">FROM</span> t_employee <span class="keyword">AS</span> emp,t_salary <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">WHERE</span> emp.eid = s.eid</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> emp.dept_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">AVG</span>(s.basic_salary) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>
<h3 id="limit-分页"><a href="#limit-分页" class="headerlink" title="limit 分页"></a>limit 分页</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">limit m,n</span><br></pre></td></tr></table></figure>
<p>m表示从下标为m的记录开始查询，第一条记录下标为0，n表示取出n条出来，如果从m开始不够n条了，就有几条取几条。<br>m=(page-1)*n，page页码，n表示每页显示的条数。</p>
<p>如果第一页“limit 0,n”<br>如果第二页“limit n,n”<br>依次类推，得出公式“limit (page-1)*n,n”</p>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>某些情况下，当进行一个查询时，需要的条件或数据要用另外一个 select 语句的结果，这个时候，就要用到子查询。<br>比如：谁比Abel工资高？这就涉及一个子问题：Abel工资是多少？</p>
<p>为了给主查询（外部查询）提供数据而首先执行的查询（内部查询）被叫做子查询。<br>一般根据子查询的嵌入位置分为，where型子查询，from型子查询，exists型子查询。</p>
<h3 id="where型子查询"><a href="#where型子查询" class="headerlink" title="where型子查询"></a>where型子查询</h3><p>where型子查询即把内层sql语句查询的结果作为外层sql查询的条件。<br>1、子查询要包含在括号内。<br>2、建议将子查询放在比较条件的右侧。<br>3、单行操作符对应单行子查询，多行操作符对应多行子查询。<br>（1）单行操作符 右边子查询必须返回的是<strong>单个值</strong>，单行比较运算符（=,&gt;,&gt;=,&lt;,&lt;=,&lt;&gt;）。<br>（2）多行操作符 右边子查询必须返回的是<strong>单列多行</strong>，可用IN,ALL,ANY其中ALL和ANY运算符必须与单行比较运算符（=,&gt;,&gt;=,&lt;,&lt;=,&lt;&gt;）结合使用。</p>
<p>IN：等于任何一个。<br>ALL：和子查询返回的所有值比较。例如：sal&gt;ALL(1,2,3)等价于sal&gt;1 &amp;&amp; sal&gt;2 &amp;&amp; sal&gt;3，即大于所有。<br>ANY：和子查询返回的任意一个值比较。例如：sal&gt;ANY(1,2,3)等价于sal&gt;1 or sal&gt;2 or sal&gt;3，即大于任意一个就可以。<br>EXISTS：判断子查询是否有返回结果（不关心具体行数和内容），如果返回则为TRUE，否则为FALSE。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 子查询</span></span><br><span class="line"><span class="comment">-- where型子查询</span></span><br><span class="line"><span class="comment">-- 查询比“孙红雷”的工资高的员工编号</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_salary</span><br><span class="line"><span class="keyword">WHERE</span> basic_salary &gt; (<span class="keyword">SELECT</span> basic_salary <span class="keyword">FROM</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_salary <span class="keyword">ON</span> t_employee.eid=t_salary.eid <span class="keyword">WHERE</span> t_employee.ename=<span class="string">&#x27;孙红雷&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询和孙红雷，李晨在同一个部门的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee</span><br><span class="line"><span class="keyword">WHERE</span> dept_id <span class="keyword">IN</span>(<span class="keyword">SELECT</span> dept_id <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> ename=<span class="string">&#x27;孙红雷&#x27;</span> <span class="keyword">OR</span> ename = <span class="string">&#x27;李晨&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee</span><br><span class="line"><span class="keyword">WHERE</span> dept_id = <span class="keyword">ANY</span>(<span class="keyword">SELECT</span> dept_id <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> ename=<span class="string">&#x27;孙红雷&#x27;</span> <span class="keyword">OR</span> ename = <span class="string">&#x27;李晨&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询全公司工资最高的员工编号，基本工资</span></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary</span><br><span class="line"><span class="keyword">WHERE</span> basic_salary = (<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(basic_salary) <span class="keyword">FROM</span> t_salary);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> eid,basic_salary <span class="keyword">FROM</span> t_salary</span><br><span class="line"><span class="keyword">WHERE</span> basic_salary &gt;= <span class="keyword">ALL</span>(<span class="keyword">SELECT</span> basic_salary <span class="keyword">FROM</span> t_salary);</span><br></pre></td></tr></table></figure></p>
<h3 id="from型子查询"><a href="#from型子查询" class="headerlink" title="from型子查询"></a>from型子查询</h3><p>from型子查询即把内层sql语句查询的结果作为临时表供外层sql语句再次查询。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- from型</span></span><br><span class="line"><span class="comment">-- 找出比部门平均工资高的员工编号，基本工资</span></span><br><span class="line"><span class="keyword">SELECT</span> t_employee.eid,basic_salary </span><br><span class="line"><span class="keyword">FROM</span> t_salary <span class="keyword">INNER</span> <span class="keyword">JOIN</span> t_employee <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> emp.dept_id <span class="keyword">AS</span> did,<span class="keyword">AVG</span>(s.basic_salary) <span class="keyword">AS</span> avg_salary</span><br><span class="line">    <span class="keyword">FROM</span> t_employee <span class="keyword">AS</span> emp,t_salary <span class="keyword">AS</span> s</span><br><span class="line">    <span class="keyword">WHERE</span> emp.eid = s.eid</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> emp.dept_id) <span class="keyword">AS</span> temp</span><br><span class="line"><span class="keyword">ON</span> t_salary.eid = t_employee.eid <span class="keyword">AND</span> t_employee.dept_id = temp.did</span><br><span class="line"><span class="keyword">WHERE</span> t_salary.basic_salary &gt; temp.avg_salary;</span><br></pre></td></tr></table></figure></p>
<h3 id="exists型子查询"><a href="#exists型子查询" class="headerlink" title="exists型子查询"></a>exists型子查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- exists型</span></span><br><span class="line"><span class="comment">-- 查询部门信息，该部门必须有员工</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_department </span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_employee <span class="keyword">WHERE</span> t_employee.dept_id = t_department.did);</span><br></pre></td></tr></table></figure>
<h3 id="复制表子查询（了解）"><a href="#复制表子查询（了解）" class="headerlink" title="复制表子查询（了解）"></a>复制表子查询（了解）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 复制表</span></span><br><span class="line"><span class="comment">-- （1）拷贝表结构</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> newadmin <span class="keyword">LIKE</span> <span class="keyword">admin</span>;</span><br><span class="line"><span class="comment">-- （2）拷贝表结构和数据（但约束与索引除外）</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> newadmin  <span class="keyword">AS</span>   ( <span class="keyword">SELECT</span> *  <span class="keyword">FROM</span> <span class="keyword">admin</span>  )  ;</span><br><span class="line"><span class="comment">-- （3）拷贝表结构+数据</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> newadmin <span class="keyword">LIKE</span> <span class="keyword">admin</span>;   </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> newadmin <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">admin</span>;</span><br><span class="line"><span class="comment">-- （4）跨数据库拷贝表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> newadmin <span class="keyword">LIKE</span> shop.admin;   </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> newshop.newadmin <span class="keyword">LIKE</span> shop.admin; </span><br><span class="line"><span class="comment">-- （5）拷贝一个表中其中的一些字段（指定新名），其中一些数据</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> newadmin <span class="keyword">AS</span>   </span><br><span class="line">(<span class="keyword">SELECT</span> <span class="keyword">id</span>, username <span class="keyword">AS</span> uname, <span class="keyword">password</span> <span class="keyword">AS</span> pass <span class="keyword">FROM</span> <span class="keyword">admin</span>  <span class="keyword">WHERE</span> <span class="keyword">id</span>&lt;<span class="number">10</span> );</span><br><span class="line"><span class="comment">-- （6）在创建表的同时定义表中的字段信息。</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tt</span><br><span class="line">(eid <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment) <span class="keyword">as</span></span><br><span class="line">(<span class="keyword">select</span> employee_id <span class="keyword">as</span> eid,first_name,last_name,email <span class="keyword">from</span> employees); </span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 复制数据</span></span><br><span class="line"><span class="comment">-- 在 INSERT 语句中加入子查询。</span></span><br><span class="line"><span class="comment">-- 不必书写 VALUES 子句。 </span></span><br><span class="line"><span class="comment">-- 子查询中的值列表应与 INSERT 子句中的列名对应。</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp2 </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> department_id = <span class="number">90</span>;</span><br><span class="line"><span class="comment">-- 或</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> sales_reps(<span class="keyword">id</span>, <span class="keyword">name</span>, salary, commission_pct)</span><br><span class="line"><span class="keyword">SELECT</span> employee_id, last_name, salary, commission_pct</span><br><span class="line"><span class="keyword">FROM</span>   employees</span><br><span class="line"><span class="keyword">WHERE</span>  job_id <span class="keyword">LIKE</span> <span class="string">&#x27;%REP%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h2><p>MySQL数据库提供了很多函数包括：<br>（1）数学函数；<br>（2）字符串函数；<br>（3）日期和时间函数；<br>（4）条件判断函数；流程控制函数；<br>（5）系统信息函数；<br>（6）加密函数；<br>（7）格式化函数；</p>
<h3 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ABS（x）        返回x的绝对值</span><br><span class="line">CEIL（x）       返回大于x的最小整数值</span><br><span class="line">FLOOR（x）      返回大于x的最大整数值</span><br><span class="line">MOD(x,y)        返回x&#x2F;y的模</span><br><span class="line">RAND(x)         返回[0,1)的随机值</span><br><span class="line">ROUND(x,y)      返回参数x的四舍五入的有y位的小数的值</span><br><span class="line">TRUNCATE(x,y)   返回数字x截断为y位小数的结果</span><br><span class="line">SQRT(x)         返回x的平方根</span><br><span class="line">POW(x,y)        返回x的y次方</span><br></pre></td></tr></table></figure>
<h3 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">CONCAT(S1,S2,......,Sn)            连接S1,S2,......,Sn为一个字符串</span><br><span class="line">CONCAT_WS(s, S1,S2,......,Sn)      同CONCAT(s1,s2,...)函数，但是每个字符串之间要加上s</span><br><span class="line">CHAR_LENGTH(s)                     返回字符串s的字符数</span><br><span class="line">LENGTH(s)                          返回字符串s的字节数，和字符集有关</span><br><span class="line">INSERT(str, index , len, instr)    将字符串str从第index位置开始，len个字符长的子串替换为字符串instr</span><br><span class="line">UPPER(s) 或 UCASE(s)               将字符串s的所有字母转成大写字母</span><br><span class="line">LOWER(s) 或 LCASE(s)               将字符串s的所有字母转成小写字母</span><br><span class="line">LEFT(s,n)                          返回字符串s最左边的n个字符</span><br><span class="line">RIGHT(s,n)                         返回字符串s最右边的n个字符</span><br><span class="line">LPAD(str, len, pad)                用字符串pad对str最左边进行填充，直到str的长度为len个字符</span><br><span class="line">RPAD(str ,len, pad)                用字符串pad对str最右边进行填充，直到str的长度为len个字符</span><br><span class="line">LTRIM(s)                           去掉字符串s左侧的空格</span><br><span class="line">RTRIM(s)                           去掉字符串s右侧的空格</span><br><span class="line">TRIM(s)                            去掉字符串s开始与结尾的空格</span><br><span class="line">TRIM(【BOTH 】s1 FROM s)           去掉字符串s开始与结尾的s1</span><br><span class="line">TRIM(【LEADING】s1 FROM s)         去掉字符串s开始处的s1</span><br><span class="line">TRIM(【TRAILING】s1 FROM s)        去掉字符串s结尾处的s1</span><br><span class="line">REPEAT(str, n)                     返回str重复n次的结果</span><br><span class="line">REPLACE（str, a, b）               用字符串b替换字符串str中所有出现的字符串a</span><br><span class="line">STRCMP(s1,s2)                      比较字符串s1,s2</span><br><span class="line">SUBSTRING(s,index,len)             返回从字符串s的index位置其len个字符</span><br></pre></td></tr></table></figure>
<h3 id="日期时间函数"><a href="#日期时间函数" class="headerlink" title="日期时间函数"></a>日期时间函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">CURDATE()\CURRENT_DATE()    返回当前日期</span><br><span class="line">CURTIME()\CURRENT_TIME()    返回当前时间</span><br><span class="line">NOW()\SYSDATE()\CURRENT_TIMESTAMP()\LOCALTIME()\LOCALTIMESTAMP()  返回当前系统日期时间</span><br><span class="line">YEAR(date)\MONTH(date)\DAY(date)\HOUR(time)\MINUTE(time)\SECOND(time)    返回具体的时间值</span><br><span class="line">WEEK(date)\WEEKOFYEAR(date)  返回一年中的第几周</span><br><span class="line">DAYOFWEEK()                  返回周几，注意：周日是1，周一是2...周六是7</span><br><span class="line">WEEKDAY(date)                返回周几，注意：周一是0，周二是1...周日是6</span><br><span class="line">DAYNAME(date)                返回星期，MONDAY,TUESDAY...SUNDAY</span><br><span class="line">MONTHNAME(date)              返回月份，JANUARY...DECTMBER</span><br><span class="line">DATEDIFF(date1,date2)        返回date1 - date2的日期间隔天数</span><br><span class="line">TIMEDIFF(time1,time2)        返回time1 - time2的时间间隔 时:分:秒</span><br><span class="line">DATE_ADD(datetime, INTERVALE expr type)    返回与给定日期时间相差INTERVAL时间段的日期时间</span><br><span class="line">DATE_FORMAT(datetime ,fmt)   日期转字符串，按照fmt格式</span><br><span class="line">STR_TO_DATE(str, fmt)        字符串转日期，按照fmt格式</span><br></pre></td></tr></table></figure>
<p>（1）DATE_ADD(datetime,INTERVAL  expr  type)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATE_ADD</span>(<span class="keyword">NOW</span>(), <span class="built_in">INTERVAL</span> <span class="number">1</span> <span class="keyword">YEAR</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATE_ADD</span>(<span class="keyword">NOW</span>(), <span class="built_in">INTERVAL</span> <span class="number">-1</span> <span class="keyword">YEAR</span>);   <span class="comment">#可以是负数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATE_ADD</span>(<span class="keyword">NOW</span>(), <span class="built_in">INTERVAL</span> <span class="string">&#x27;1_1&#x27;</span> YEAR_MONTH);   <span class="comment">#需要单引号</span></span><br></pre></td></tr></table></figure><br>表达式类型：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">YEAR MONTH DAY HOUR MINUTE SECOND</span><br><span class="line">YEAR_MONTH DAY_HOUR DAY_MINUTE DAY_SECOND HOUR_MINUTE HOUR_SECOND MINUTE_SECOND</span><br></pre></td></tr></table></figure><br>（2）DATE_FORMAT(datetime ,fmt)和STR_TO_DATE(str, fmt)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">格式符    说明                               格式符    说明</span><br><span class="line">%Y    4位数字表示年份                          %y     表示两位数字表示年份</span><br><span class="line">%M    月名表示月份（January,..）               %m     两位数字表示月份（01,02,03。。。）</span><br><span class="line">%b    缩写的月名（Jan.，Feb.，..）             %c     数字表示月份（1,2,3,...）</span><br><span class="line">%D    英文后缀表示月中的天数（1st,2nd,3rd,..） %d     两位数字表示月中的天数(01,02...)</span><br><span class="line">%e    数字形式表示月中的天数（1,2,3,4,5..）        </span><br><span class="line">%H    两位数字表示小数，24小时制（01,02..）   %h和%I  两位数字表示小时，12小时制（01,02..）</span><br><span class="line">%k    数字形式的小时，24小时制(1,2,3..)        %l     数字形式表示小时，12小时制（1,2,3,4....）</span><br><span class="line">%i    两位数字表示分钟（00,01,02）            %S和%s  两位数字表示秒(00,01,02...)</span><br><span class="line">%W    一周中的星期名称（Sunday..）             %a     一周中的星期缩写（Sun.，Mon.,Tues.，..）</span><br><span class="line">%w    以数字表示周中的天数(0&#x3D;Sunday,1&#x3D;Monday..)        </span><br><span class="line">%j    以3位数字表示年中的天数(001,002..)       %U     以数字表示年中的第几周，（1,2,3。。）其中Sunday为周中第一天</span><br><span class="line">%u    以数字表示年中的第几周（1,2,3..）其中Monday为周中第一天      </span><br><span class="line">%T    24小时制                                 %r     12小时制</span><br><span class="line">%p    AM或PM                                   %%     表示%</span><br></pre></td></tr></table></figure></p>
<h3 id="流程函数"><a href="#流程函数" class="headerlink" title="流程函数"></a>流程函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">IF(value,t ,f)<span class="comment">-- 如果value是真，返回t，否则返回f</span></span><br><span class="line">IFNULL(value1, value2)<span class="comment">-- 如果value1不为空，返回value1，否则返回value2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 相当于Java的if...else if...</span></span><br><span class="line">CASE </span><br><span class="line">WHEN 条件1 THEN result1</span><br><span class="line">WHEN 条件2 THEN result2</span><br><span class="line">....</span><br><span class="line">[ELSE resultn]</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 相当于Java的switch</span></span><br><span class="line"><span class="keyword">CASE</span>  expr </span><br><span class="line"><span class="keyword">WHEN</span> 常量值<span class="number">1</span> <span class="keyword">THEN</span> 值<span class="number">1</span></span><br><span class="line"><span class="keyword">WHEN</span> 常量值<span class="number">1</span> <span class="keyword">THEN</span> 值<span class="number">1</span></span><br><span class="line">....</span><br><span class="line">[<span class="keyword">ELSE</span> 值n]</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ename ,<span class="keyword">CASE</span> </span><br><span class="line"><span class="keyword">WHEN</span> salary&gt;=<span class="number">15000</span> <span class="keyword">THEN</span> <span class="string">&#x27;高薪&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> salary&gt;=<span class="number">10000</span> <span class="keyword">THEN</span> <span class="string">&#x27;潜力股&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> salary&gt;=<span class="number">8000</span> <span class="keyword">THEN</span> <span class="string">&#x27;屌丝&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">&#x27;草根&#x27;</span></span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"><span class="keyword">FROM</span> t_employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">oid</span>,<span class="string">`status`</span>, <span class="keyword">CASE</span> <span class="string">`status`</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="string">&#x27;未付款&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">2</span> <span class="keyword">THEN</span> <span class="string">&#x27;已付款&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">3</span> <span class="keyword">THEN</span> <span class="string">&#x27;已发货&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">4</span> <span class="keyword">THEN</span> <span class="string">&#x27;确认收货&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">&#x27;无效订单&#x27;</span></span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"><span class="keyword">FROM</span> t_order;</span><br></pre></td></tr></table></figure>
<h3 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">database()    返回当前数据库名</span><br><span class="line">version()     返回当前数据库版本</span><br><span class="line">user()        返回当前登录用户名</span><br><span class="line">password(str) 返回字符串str的加密版本，41位长的字符串</span><br><span class="line">md5(str)      返回字符串str的md5值，也是一种加密方式</span><br></pre></td></tr></table></figure>
<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><p>事务属于DCL，DCL用来控制数据库的访问，包括如下SQL语句：<br>（1）GRANT：授予访问权限。<br>（2）REVOKE：撤销访问权限。<br>（3）COMMIT：提交事务处理。<br>（4）ROLLBACK：事务处理回退。<br>（5）SAVEPOINT：设置保存点。<br>（6）LOCK：对数据库的特定部分进行锁定。</p>
<p>事务，可以理解为数据库的多线程处理。</p>
<h3 id="事务的ACID特性"><a href="#事务的ACID特性" class="headerlink" title="事务的ACID特性"></a>事务的ACID特性</h3><p>（1）原子性(Atomicity)：原子性是指数据库事务是一个不可分割的工作单位。事务中的操作要么都发生，要么都不发生。<br>（2）一致性(Consistency)：指数据的规则，在事务前/后应保持一致。事务必须使数据库从一个一致性状态变换到另外一个一致性状态。<br>（3）隔离性(Isolation)：简单点说，某个事务的操作对其他事务不可见的，并发执行的各个事务之间不能相互干扰。<br>（4）持久性(Durability)：持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来的其他操作和数据库故障不应该对其有任何影响。</p>
<h3 id="事务的用法"><a href="#事务的用法" class="headerlink" title="事务的用法"></a>事务的用法</h3><p>（1）开启事务(start transaction)。<br>（2）执行sql操作(普通sql操作)。<br>（3）提交/回滚(commit/rollback)。<br>注意:<br>（1）建表的时候,选择<strong>Innodb引擎</strong>才支持事务。<br>（2）默认情况下，MySQL是自动提交事务，每次执行一个 SQL 语句时，如果执行成功，就会向数据库自动提交，而不能回滚。如果某一组操作需要在一个事务中，那么需要使用start transaction，一旦rollback或commit就结束当次事务，之后的操作又自动提交。<br>（3）如果需要在当前会话（连接）的整个过程中都取消自动提交事务，进行手动提交事务，就需要设置set autocommit = false;或set autocommit = 0;那样的话每一句SQL都需要手动commit提交才会真正生效。rollback或commit之前的所有操作都视为一个事务，之后的操作视为另一个事务，还需要手动提交或回滚。<br>（4）和Oracle一样，DDL语句是不能回滚的，并且部分的DDL语句会造成隐式的提交，因此最好事务中不要涉及DDL语句。事务回滚只对insert、update、delete有效，对create、drop等DDL无效。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 开启手动处理事务模式</span></span><br><span class="line"><span class="comment">-- set autocommit = false;</span></span><br><span class="line"><span class="comment">-- 开始事务（推荐）</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看当前表的数据</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_stu_detail;</span><br><span class="line"><span class="comment">-- 删除整张表的数据</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_stu_detail;</span><br><span class="line"><span class="comment">-- 查询该表数据，发现显示删除后的结果</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_stu_detail;</span><br><span class="line"><span class="comment">-- 回滚</span></span><br><span class="line"><span class="keyword">rollback</span></span><br><span class="line"><span class="comment">-- 查看当前表的数据，发现又回来了</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_stu_detail;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除整张表的数据</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_stu_detail;</span><br><span class="line"><span class="comment">-- 提交事务（不能回滚了）</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 查看当前表的数据，发现真删除了</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_stu_detail;</span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 插入一条记录</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_stu_detail <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;a@163.com&#x27;</span>, <span class="string">&#x27;北三家&#x27;</span>);</span><br><span class="line"><span class="comment">-- 保存还原点1</span></span><br><span class="line"><span class="keyword">savepoint</span> point1;</span><br><span class="line"><span class="comment">-- 插入一条记录</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_stu_detail <span class="keyword">VALUES</span> (<span class="number">2</span>,  <span class="string">&#x27;b@163.com&#x27;</span>, <span class="string">&#x27;北七家&#x27;</span>);</span><br><span class="line"><span class="comment">-- 保存还原点2</span></span><br><span class="line"><span class="keyword">savepoint</span> point2;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看当前效果</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_stu_detail;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 回滚到某个还原点</span></span><br><span class="line"><span class="keyword">rollback</span> <span class="keyword">to</span> point1;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 提交事务</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 清空表，DDL语句无法回滚</span></span><br><span class="line"><span class="keyword">truncate</span> t_stu_detail;</span><br><span class="line"><span class="comment">-- 回滚无效</span></span><br><span class="line"><span class="keyword">rollback</span>;</span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 修改表结构</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> t_stu_detail <span class="keyword">add</span> description <span class="built_in">varchar</span>(<span class="number">50</span>);</span><br><span class="line"><span class="comment">-- 回滚，对于修改表结构的语句无法回滚</span></span><br><span class="line"><span class="keyword">rollback</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="数据库的隔离级别"><a href="#数据库的隔离级别" class="headerlink" title="数据库的隔离级别"></a>数据库的隔离级别</h3><p>对于同时运行的多个事务（<strong>多线程并发</strong>）, 当这些事务访问数据库中相同的数据时, 如果没有采取必要的隔离机制, 就会导致各种并发问题，这些问题的本质就是线程安全问题，共享数据的问题:<br>（1）<strong>脏读</strong>: 对于两个事务 T1, T2。T1 读取了已经被 T2 更新但还<strong>没有被提交</strong>的字段, 之后,若 T2 <strong>回滚</strong>, T1读取的内容就是临时且无效的。<br>（2）<strong>不可重复读</strong>: 对于两个事务 T1, T2。T1 读取了一个字段, 然后 T2 <strong>更新并提交</strong>了该字段，之后,T1再次读取同一个字段, 值就不同了。<br>（3）<strong>幻读</strong>: 对于两个事务 T1, T2。T1 从一个表中读取了一个字段, 然后 T2 在该表中<strong>插入、删除</strong>了一些新的行, 之后, 如果 T1 再次读取同一个表, 就会<strong>多出、少了</strong>几行。</p>
<p>数据库事务的隔离性: 数据库系统必须具有隔离并发运行各个事务的能力, 使它们不会相互影响, 避免各种并发问题。一个事务与其他事务隔离的程度称为隔离级别. 数据库规定了多种事务隔离级别, 不同隔离级别对应不同的干扰程度, 隔离级别越高, 数据一致性就越好, 但并发性越弱。</p>
<p>数据库的4种事务隔离级别：<br>| 隔离级别 | 描述 |<br>| :——-| :—— |<br>| <strong>READ-UNCOMMITTED</strong>（读未提交数据） | 允许事务读取其他事务未提交的数据。脏读,不可重复读,幻读的问题都会出现。 |<br>| <strong>READ-COMMITTED</strong>（读已提交数据） | 只允许事务读取其他事务已经提交的数据。可避免脏读,但不可重复读,幻读的问题仍会出现。 |<br>|<strong>REPEATABLE-READ</strong>（可重复读）|确保事务可以多次从一个字段中读取相同的值。在这个事务持续期间，禁止其他事务对<strong>该字段</strong>进行更新(行锁)。可以避免脏读和不可重复读，但幻读的问题仍然存在。|<br>|<strong>SERIALIZABLE</strong>（串行化）|确保事务可以从一个表中读取相同的行。在这个事务持续期间，禁止其他事务对<strong>该表</strong>执行插入、更新、删除操作(表锁)。所有并发问题都可以避免，但是性能十分低下。|<br>Oracle 支持 2 种事务隔离级别：READ COMMITED, SERIALIZABLE。Oracle 默认的事务隔离级别为READ COMMITED。<br>Mysql 支持 4 种事务隔离级别。Mysql默认事务级别为REPEATABLE-READ。在Mysql5.0版本后默认的隔离级别也可以避免幻读了。INNODB使用了MVCC (Multiversion Concurrency Control)，即多版本并发控制技术防止幻读。真正的像拍照一样，其他事务新插入或删除的记录也看不出来。</p>
<p>在Mysql中设置隔离级别：<br>每启动一个 mysql 程序, 就会获得一个单独的数据库连接。 每个数据库连接都有一个变量 <code>@@tx_isolation</code>, 表示当前的事务隔离级别。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看当前的隔离级别:</span></span><br><span class="line"><span class="keyword">SELECT</span> @@tx_isolation;</span><br><span class="line"><span class="comment">-- 查看全局的隔离级别</span></span><br><span class="line"><span class="keyword">select</span> @@global.tx_isolation;</span><br><span class="line"><span class="comment">-- 设置当前 mySQL 连接的隔离级别</span></span><br><span class="line"><span class="keyword">set</span> tx_isolation =<span class="string">&#x27;repeatable-read&#x27;</span>;</span><br><span class="line"><span class="comment">-- 设置数据库系统的全局的隔离级别</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> tx_isolation =<span class="string">&#x27;read-committed&#x27;</span>;  </span><br><span class="line"><span class="comment">-- 设置会话隔离级别</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">SESSION</span> tx_isolation=<span class="string">&#x27;read-committed&#x27;</span>; </span><br></pre></td></tr></table></figure></p>
<h2 id="权限与安全"><a href="#权限与安全" class="headerlink" title="权限与安全"></a>权限与安全</h2><p>数据库的权限和数据库的安全是息息相关的，不当的权限设置可能会导致各种各样的安全隐患，操作系统的某些设置也会对MySQL的安全造成影响。</p>
<h3 id="权限系统的工作原理"><a href="#权限系统的工作原理" class="headerlink" title="权限系统的工作原理"></a>权限系统的工作原理</h3><p>MySQL的权限系统通过下面两个阶段进行认证：<br>（1）对连接到数据库的用户进行身份认证，以此来判断此用户是否属于合法的用户，合法的用户通过认证，不合法的用户拒绝连接。<br>（2）对通过认证的合法的用户则赋予相应的权限，用户可以在这些权限范围内对数据库做相应的操作。</p>
<p><strong>1、身份认证</strong><br>MySQL是通过<strong>IP地址和用户名</strong>联合进行认证的，即同样的一个用户名如果来自不同的IP地址，则MySQL将其视为不同的用户。<br>例如MySQL安装后默认创建的用户root@localhost表示用户root只能从本地(localhost)进行连接才可以通过认证，此用户从其他任何主机对数据库进行的连接都将被拒绝，除非安装时选择了（Enable root access from remote machines），那创建的就是root@%用户，就表示可以从任意主机通过root用户进行连接。<br><strong>2、权限表的存取</strong><br>在权限存取的两个过程中，系统会用到”mysql”数据库中user和db、host这三个最重要的权限表。<br>user表中的权限是针对所有数据库的。<br>db表存储了某个用户对一个数据库的权限。<br>host表中存储了某个主机对数据库的操作权限,配合db表对给定主机上数据库级操作权限做更细致的控制,但很少用,新版本已经取消了host表。</p>
<p>当用户进行连接时，权限表的存取过程有一些两个阶段：<br>（1）先从user表中的host,user和password这3个字段中判断连接的IP,用户名和密码是否存在表中,若存在,则通过身份验证，否则拒绝连接。<br>（2）如果通过身份验证，则按照权限表的顺序得到数据库权限：user-&gt;db-&gt;tables_priv-&gt;columns_priv。在这几个权限表中，权限范围依次递减，全局权限覆盖局部权限。<br>当用户通过权限认证，进行权限分配是时先检查全局权限表user，如果user中对应权限为Y，则此用户对所有数据库的权限都为Y，将不再检查db、tables_priv和columns_priv；如果为N，则到db表中检查此用户对应的具体数据库，并得到db中为Y的权限，如果db中相应权限为N，则检查tables_priv中此数据库对应的具体表，取得表中为Y的权限，如果tables_priv中相应的权限为N，则检查columns_priv中此表对应的具体列，取得列中为Y的权限。</p>
<p><strong>每个用户的权限，有4个权限级别：全局&gt;数据库&gt;表&gt;字段。依次校验权限，有过前面通过了，后面就不校验了。</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看用户权限</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">grants</span> <span class="keyword">for</span> <span class="keyword">user</span>@host;</span><br></pre></td></tr></table></figure></p>
<p><strong>用户表user</strong><br>user表有39个字段。这些字段可以分为4类：<br>1、用户列：host，user，password三个字段<br>2、安全列：ssl_type、ssl_cipher、x509_issuer、x509_subject<br>ssl用于加密；x509标准可以用来标识用户。普通的发行版都没有加密功能。可以使用SHOW VARIABLES LIKE ‘have_openssl’语句来查看是否具有ssl功能。如果取值为DISABLED，那么则没有ssl加密功能。<br>3、资源控制列：max_questions（每小时可以允许执行多少次查询）、max_updates（每小时可以允许执行多少次更新）、max_connections（每小时可以建立多少连接）、max_user_connections（单个用户可以同时具有的连接数）。默认值为0，表示无限制。<br>4、权限列：这些字段的值只有Y和N。Y表示该权限可以用到所有数据库上；N表示该权限不能用到所有数据库上；通常，可以使用GRANT语句Wie用户赋予一些权限，也可以通过Update语句更新user表的方式来设置权限；不过，修改user表之后，一定要执行一下FLUSH PRIVILEGES。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">列                           说明</span><br><span class="line">Select_priv    确定用户是否可以通过SELECT命令选择数据</span><br><span class="line">Insert_priv    确定用户是否可以通过INSERT命令插入数据</span><br><span class="line">Update_priv    确定用户是否可以通过UPDATE命令修改现有数据</span><br><span class="line">Delete_priv    确定用户是否可以通过DELETE命令删除现有数据</span><br><span class="line">Create_priv    确定用户是否可以创建新的数据库和表</span><br><span class="line">Drop_priv      确定用户是否可以删除现有数据库和表</span><br><span class="line">Reload_priv    确定用户是否可以执行刷新和重新加载MySQL所用各种内部缓存的特定命令，包括日志、权限、主机、查询和表执行flush-hosts,flush-logs,flush-privileges,flush-status,flush-tables,flush-threads,refresh,reload等命令</span><br><span class="line">Shutdown_priv   确定用户是否可以关闭MySQL服务器。在将此权限提供给root账户之外的任何用户时，都应当非常谨慎</span><br><span class="line">Process_priv    确定用户是否可以通过SHOW PROCESSLIST命令查看其他用户的进程</span><br><span class="line">File_priv       确定用户是否可以执行SELECT INTO OUTFILE和LOAD DATA INFILE命令，查看服务器主机上的文件</span><br><span class="line">Grant_priv      确定用户是否可以将已经授予给该用户自己的权限再授予其他用户</span><br><span class="line">References_priv 目前只是某些未来功能的占位符；现在没有作用</span><br><span class="line">Index_priv      确定用户是否可以创建和删除表索引</span><br><span class="line">Alter_priv      确定用户是否可以重命名和修改表结构</span><br><span class="line">Show_db_priv    确定用户是否可以查看服务器上所有数据库的名字，包括用户拥有足够访问权限的数据库</span><br><span class="line">Super_priv      确定用户是否可以执行某些强大的管理功能，例如通过KILL命令删除用户进程，使用SET GLOBAL修改全局MySQL变量，执行关于复制和日志的各种命令</span><br><span class="line">Create_tmp_table_priv  确定用户是否可以创建临时表</span><br><span class="line">Lock_tables_priv       确定用户是否可以使用LOCK TABLES命令阻止对表的访问&#x2F;修改</span><br><span class="line">Execute_priv           确定用户是否可以执行存储过程</span><br><span class="line">Repl_slave_priv        确定用户是否可以读取用于维护复制数据库环境的二进制日志文件。此用户位于主系统中，有利于主机和客户机之间的通信</span><br><span class="line">Repl_client_priv       确定用户是否可以确定复制从服务器和主服务器的位置</span><br><span class="line">Create_view_priv       确定用户是否可以创建视图</span><br><span class="line">Show_view_priv         确定用户是否可以查看视图或了解视图如何执行</span><br><span class="line">Create_routine_priv    确定用户是否可以更改或放弃存储过程和函数</span><br><span class="line">Alter_routine_priv     确定用户是否可以修改或删除存储函数及函数</span><br><span class="line">Create_user_priv       确定用户是否可以执行CREATE USER命令，这个命令用于创建新的MySQL账户</span><br><span class="line">Event_priv             确定用户能否创建、修改和删除事件</span><br><span class="line">Trigger_priv           确定用户能否创建和删除触发器</span><br></pre></td></tr></table></figure><br>其他几个db、host、tables_priv、columns_priv权限表类似，可以通过desc查看字段。</p>
<h3 id="账号管理"><a href="#账号管理" class="headerlink" title="账号管理"></a>账号管理</h3><p><strong>1、创建或更改账号</strong><br>语句命令方式，有两种方法：<br>（1）使用GRANT语法创建（推荐）<br>（2）直接insert，update权限表<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> 权限类型列表 </span><br><span class="line"><span class="keyword">on</span>  object_type &#123;表名称|*|*.*|db_name.*&#125;</span><br><span class="line"> <span class="keyword">to</span> <span class="keyword">user</span> [<span class="keyword">identified</span> <span class="keyword">by</span> <span class="keyword">password</span> ‘密码’][,<span class="keyword">user</span> [<span class="keyword">identified</span> <span class="keyword">by</span> <span class="keyword">password</span> ‘密码’] ....</span><br><span class="line"><span class="keyword">with</span> <span class="keyword">grant</span> <span class="keyword">option</span>;</span><br><span class="line"><span class="comment">-- 其中：object_type = TABLE | FUNCTION | PROCEDURE</span></span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 例1：创建用户admin，权限为可以在所有数据库上执行所有权限，但只能从本地进行连接</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="keyword">admin</span>@localhost;</span><br><span class="line"><span class="comment">-- 可以发现除了Grant_priv权限外，所有权限在user表里面都是Y.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 例2：在例1基础上，增加对admin的grant权限</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="keyword">admin</span>@localhost <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 例3：在例2基础上，设置密码为“123”</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="keyword">admin</span>@localhost <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">&#x27;123&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 例4：创建新用户chai，可以从任何IP进行连接，权限为对test数据库的所有表进行SELECT、UPDATE、INSERT、DELETE操作，初始密码为“123”</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">UPDATE</span>,<span class="keyword">DELETE</span> <span class="keyword">ON</span> test.* <span class="keyword">TO</span> <span class="string">&#x27;chai&#x27;</span>@<span class="string">&#x27;%&#x27;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"><span class="comment">-- 发现此例，user表中权限都是N，db表中增加的记录权限则都是Y。</span></span><br></pre></td></tr></table></figure><br>注意：<br>1、mysql数据库的user表中user的值为空，表示所有用户都可以连接（此处不能用*，*表示用户名为*的用户了）<br>2、mysql数据库的user表中host的值为*或空，表示所有外部IP都可以连接，但是不包括本地服务器localhost，因此如果要包括本地服务器，必须单独为localhost赋予权限。如果host的值为%，表示所有IP，包括本地服务器localhost。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Host值              User值    被条目匹配的连接</span><br><span class="line">‘thomas.loc.gov’    ‘fred’    fred，从thomas.loc.gov连接</span><br><span class="line">‘thomas.loc.gov’    ‘’        任何用户，从thomas.loc.gov连接</span><br><span class="line">‘%’                 ‘fred’    fred，从任何主机连接</span><br><span class="line">‘%’                 ‘’        任何用户，从任何主机连接</span><br><span class="line">‘%.loc.gov’         ‘fred’    fred，从在loc.gov域的任何主机连接</span><br><span class="line">‘x.y.%’             ‘fred’    fred，从在x.y.net，x.y.com等主机连</span><br><span class="line">‘144.155.166.177’   ‘fred’    fred，从144.155.166.177的IP地址连接</span><br><span class="line">‘144.155.166.%’     ‘fred’    fred，从‘144.155.166.*的C类子网的任何主机连接</span><br></pre></td></tr></table></figure><br>如果有多个匹配，服务器必须选择使用哪个条目，按照下述原则来解决：<br>（1）服务器在启动时读入user表后进行排序。首先以最具体的host值排序，%排后面，如果host相同，以最具体的user值排序，空User值排后面。<br>（2）服务器使用与客户端和用户名匹配的第一行。</p>
<p><strong>2、查看账户权限</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">grants</span> <span class="keyword">for</span> <span class="keyword">user</span>@host;</span><br></pre></td></tr></table></figure><br><strong>3、删除用户</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> 用户名;</span><br></pre></td></tr></table></figure></p>
<h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><p><strong>1、在命令行出现乱码问题:</strong><br>按照数据库时选择utf8, 而我们在windows下窗口是GBK的,因此,需要在命令行客户端声明字符集.<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 告诉服务器，当前客户端用的GBK编码，防止乱码</span></span><br><span class="line">mysql&gt; set names gbk;  </span><br><span class="line"><span class="comment">-- 可以查看字符集</span></span><br><span class="line">mysql&gt; show variables like &#x27;character_set_%&#x27;; </span><br></pre></td></tr></table></figure><br><strong>2、退出当前错误语句</strong><br>语句打错以后应该退出本语句，再继续打新语句。<br>也可以打\c,快速退出本语句。</p>
<p><strong>3、忘记root用户密码问题？安全模式登录。</strong><br>（1）通过任务管理器或者服务管理，关掉mysqld(服务进程)，命令行：<code>net stop 服务名</code>。<br>（2）开启mysqld：<code>mysqld --skip-grant-tables</code>。开启mysqld后不要关闭。<br>（3）此时mysqld服务进程已经打开，并且不需要权限检查。<br>（4）开启另一个终端，输入<code>mysql -uroot</code>无密码登陆服务器。<br>（5）修改权限表：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 依次执行下列语句</span></span><br><span class="line"><span class="keyword">use</span> mysql;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">user</span> <span class="keyword">set</span> <span class="keyword">Password</span> = <span class="keyword">password</span>(<span class="string">&#x27;123456&#x27;</span>) <span class="keyword">where</span> <span class="keyword">User</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure><br>（6）通过任务管理器，关掉mysqld服务进程。<br>（7）再次通过服务管理，打mysql服务。<br>（8）即可用修改后的新密码登陆。</p>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2019\03\25\MySQL\02.MySQL练习题\" rel="bookmark">MySQL练习题</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2019\04\01\MySQL\03.Python和数据库\" rel="bookmark">Python和数据库</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2019\04\03\MySQL\04.Java和数据库\" rel="bookmark">Java和数据库</a></div>
    </li>
  </ul>


    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>SoundMemories
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://soundmemories.github.io/2019/03/23/MySQL/01.MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/" title="MySQL数据库">https://soundmemories.github.io/2019/03/23/MySQL/01.MySQL数据库/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"><i class="fa fa-tag"></i> MySQL</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/02/13/Python/21.Python-%E6%A0%87%E5%87%86%E5%BA%93/" rel="prev" title="Python-标准库">
                  <i class="fa fa-chevron-left"></i> Python-标准库
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/03/25/MySQL/02.MySQL%E7%BB%83%E4%B9%A0%E9%A2%98/" rel="next" title="MySQL练习题">
                  MySQL练习题 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SoundMemories</span>
</div>
  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9tdXNlLw==">NexT.Muse</span> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@next-theme/pjax@0.4.0/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>
  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollRestoration: false,
  scrollTo: !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  




  <script src="/js/local-search.js"></script>








<script data-pjax>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  const url = element.dataset.target;
  const pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  const pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  const fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script data-pjax>
if (document.querySelectorAll('.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8.8.2/dist/mermaid.min.js', () => {
    mermaid.init({
      theme    : 'neutral',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    }, '.mermaid');
  }, window.mermaid);
}
</script>





  








    <div class="pjax">
  

  
      <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = '//cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink.listen({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://soundmemories.github.io/2019/03/23/MySQL/01.MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/',]
      });
      });
  </script>

    </div>
</body>
</html>

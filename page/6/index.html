<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Monda:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"soundmemories.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.0.2","exturl":true,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>

  <meta name="description" content="今日事，今日毕">
<meta property="og:type" content="website">
<meta property="og:title" content="SoundMemories">
<meta property="og:url" content="https://soundmemories.github.io/page/6/index.html">
<meta property="og:site_name" content="SoundMemories">
<meta property="og:description" content="今日事，今日毕">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="SoundMemories">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://soundmemories.github.io/page/6/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>SoundMemories</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">SoundMemories</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-主页">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>主页</a>

  </li>
        <li class="menu-item menu-item-分类">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-标签">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-归档">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-关于">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>
	   
		  
      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="SoundMemories"
      src="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
  <p class="site-author-name" itemprop="name">SoundMemories</p>
  <div class="site-description" itemprop="description">今日事，今日毕</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">113</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NvdW5kbWVtb3JpZXM=" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;soundmemories"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnNvdW5kbWVtb3JpZXNAMTYzLmNvbQ==" title="E-Mail → mailto:soundmemories@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/05/02/Machine%20Learning/05.ML-Hadoop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/02/Machine%20Learning/05.ML-Hadoop/" class="post-title-link" itemprop="url">ML-Hadoop</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-05-02 00:00:00" itemprop="dateCreated datePublished" datetime="2020-05-02T00:00:00+08:00">2020-05-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>42k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>38 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="大数据"><a href="#大数据" class="headerlink" title="大数据"></a>大数据</h1><p>大数据：指<strong>无法在一定时间范围</strong>内用常规软件工具进行捕捉、管理和处理的数据集合，是需要新处理模式才能具有更强的决策力、洞察发现力和流程优化能力的<strong>海量、高增长率和多样化的信息资产</strong>。主要解决，海量数据的<strong>存储</strong>和海量数据的<strong>分析计算</strong>问题。</p>
<p>一般数据存储单位：bit、Byte、KB、MB、GB、TB、PB、EB、ZB、YB、BB、NB、DB。<br><div class="note info"><p>1Byte = 8bit、1K = 1024Byte、1MB = 1024K、1G = 1024M、1T = 1024G、1P = 1024T…</p>
</div></p>
<p><strong>1、大数据的特点：</strong><br>（1）<strong>大量（Volume）</strong>：截至目前，人类生产的所有印刷材料的数据量是200PB，而历史上全人类总共说过的话的数据量大约是5EB。当前，典型个人计算机硬盘的容量为TB量级，而一些大企业的数据量已经接近EB量级。<br>（2）<strong>高速（Velocity）</strong>：这是大数据区分于传统数据挖掘的最显著特征。预计到2022年，全球数据使用量将达到40ZB。在如此海量的数据面前，处理数据的效率就是企业的生命。<br>（3）<strong>多样（Variety）</strong>：类型的多样性也让数据被分为<strong>结构化数据</strong>和<strong>非结构化数据</strong>。相对于以往便于存储的以数据库/文本为主的结构化数据，非结构化数据越来越多，包括网络日志、音频、视频、图片、地理位置信息等，这些多类型的数据对数据的处理能力提出了更高要求。<br>（4）<strong>低价值密度（Value）</strong>：价值密度的高低与数据总量的大小成反比。比如，在某一天的监控视频中，我们只关心出事故的那一分钟。如何快速对有价值数据“提纯”成为目前大数据背景下待解决的难题。<br>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/05/02/Machine%20Learning/05.ML-Hadoop/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/04/30/Machine%20Learning/04.ML-Matplolib/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/30/Machine%20Learning/04.ML-Matplolib/" class="post-title-link" itemprop="url">ML-Matplotlib</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-30 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-30T00:00:00+08:00">2020-04-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>94k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1:25</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Matplotlib概述"><a href="#Matplotlib概述" class="headerlink" title="Matplotlib概述"></a>Matplotlib概述</h1><p>Matplotlib 是建立在 NumPy 数组基础上的多平台数据可视化程序库，最初被设计用于完善 SciPy 的生态环境。  John Hunter 希望能画出类似 MATLAB 风格的交互式图形，之后 John 就把补丁做成了 Matplotlib 程序包。</p>
<p>Matplotlib 支持几十种图形显示接口与输出格式，这使得用户无论在哪种操作系统上都可以输出自己想要的图形格式。这种跨平台、面面俱到的特点已经成为 Matplotlib 最强大的功能之一，新版的 Matplotlib 已经可以轻松实现主流的绘图风格，人们不断在 Matplotlib 的基础上开发出新的程序包，实现更加简洁、现代化的 API，例如 Seaborn、ggplot、HoloViews、Altair，以 及 Pandas 对 Matplotlib 的 API 封装的画图功能。虽然已经有了封装后的高级工具，但是掌握 Matplotlib 的语法更能让你灵活地控制最终的图形结果。</p>
<p>和Pandas一样，使用<code>pip install matplotlib</code>进行安装，可查看和引用它：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看包的版本</span></span><br><span class="line">mpl.__version__</span><br><span class="line"><span class="comment"># 自动补全</span></span><br><span class="line">mpl.&lt;TAB&gt;</span><br><span class="line"><span class="comment"># 内置的文档</span></span><br><span class="line">mpl?</span><br></pre></td></tr></table></figure></p>
<h1 id="Matplotlib三层结构"><a href="#Matplotlib三层结构" class="headerlink" title="Matplotlib三层结构"></a>Matplotlib三层结构</h1><h2 id="容器层"><a href="#容器层" class="headerlink" title="容器层"></a>容器层</h2><p>容器层主要由Canvas、Figure、Axes组成。<br>（1）Canvas是位于最底层的系统层，在绘图的过程中充当<strong>画板</strong>的角色，即放置画布（Figure）的工具。<br>（2）Figure是Canvas上面的一层，也是需要用户来操作的应用层的第一层，在绘图的过程中充当<strong>画布</strong>的角色。<br>（3）Axes是Figure之上的一层，是应用层的第二层，在绘图的过程中相当于画布上的<strong>绘图区</strong>角色。</p>
<div class="note info"><p>Figure：指整个图形（可以通过plt.figure()设置画布的大小和分辨率等。<br>Axes：指坐标系，数据的绘图区。<br>Axis指坐标轴，坐标系中的一条轴，包含大小限制、刻度和刻度标签。</p>
<p>一个figure（画布）可以包含多个axes（绘图区/坐标系），但是一个axes只能属于一个figure。<br>一个axes（绘图区/坐标系）可以包含多个axis（坐标轴），包含两个即为2d坐标系，3个即为3d坐标系。</p>
</div>
<p><img src="https://i.loli.net/2021/05/20/kQxnK39Ar1wbIYJ.jpg" width="50%" height="50%"></p>
<h2 id="图像层"><a href="#图像层" class="headerlink" title="图像层"></a>图像层</h2><p>图像层建立建立在Axes上面，是指Axes内通过plot、scatter、bar、histogram、pie等函数<strong>根据数据绘制出的图像</strong>。<br><img src="https://i.loli.net/2021/05/20/9QKgsyWvTEdS7kf.png" width="70%" height="70%"></p>
<h2 id="辅助显示层"><a href="#辅助显示层" class="headerlink" title="辅助显示层"></a>辅助显示层</h2><p>辅助显示层也是建立在Axes上面，为Axes（绘图区）内的，<strong>除了根据数据绘制出的图像以外的内容</strong>，主要包括Axes外观(facecolor)、边框线(spines)、坐标轴(axis)、坐标轴名称(axis label)、坐标轴刻度(tick)、坐标轴刻度标签(tick label)、网格线(grid)、图例(legend)、标题(title)等内容。该层的设置可使图像显示更加直观更加容易被用户理解，但又不会对图像产生实质的影响。<br><img src="https://i.loli.net/2021/05/20/xw5SpbBa6J81Mqo.png" alt=""></p>
<h1 id="Matplotlib配置和技巧"><a href="#Matplotlib配置和技巧" class="headerlink" title="Matplotlib配置和技巧"></a>Matplotlib配置和技巧</h1><h2 id="数据格式"><a href="#数据格式" class="headerlink" title="数据格式"></a>数据格式</h2><p>matplotlib的所有plotting function期待输入numpy.array或者numpy.ma.masked_array类型的数据作为输入。某些长得像numpy.array的数据比如numpy.matrix类型的输入数据可能会导致matplotlib工作异常。如果确实需要使用numpy.matrix，你应该首先将它转换为numpy.array。</p>
<h2 id="pyplot、pylab"><a href="#pyplot、pylab" class="headerlink" title="pyplot、pylab"></a>pyplot、pylab</h2><p><strong>matplotlib.pyplot</strong>：位于matplotlib的顶层，它为底层的面向对象接口提供了一个state-machine interface。这个state-machine必要的时候隐式创建Figure和Axes，并维护current Figure和current Axes。该模块中的很多函数是用于给当前Figure的当前Axes添加plot element，比如line、text、image等。它非常类似于Matlab的用法。常用方法参考<span class="exturl" data-url="aHR0cHM6Ly9tYXRwbG90bGliLm9yZy9zdGFibGUvYXBpL19hc19nZW4vbWF0cGxvdGxpYi5weXBsb3QuaHRtbD9oaWdobGlnaHQ9bWF0cGxvdGxpYiUyMHB5cGxvdCNtb2R1bGUtbWF0cGxvdGxpYi5weXBsb3Q=">pyplot<i class="fa fa-external-link-alt"></i></span></p>
<p>matplotlib.pyplot的下一层是面向对象的接口：在这一层pyplot只是用部分函数来创建Figure，然后通过该Figure显式的创建Axes，然后通过面向对象的接口在该Axes上添加图形。极端情况下用户可以完全抛弃pyplot而完全使用面向对象的接口。</p>
<p><strong>matplotlib.pylab</strong>：是一个便利的module，它导入了matplotlib.pyplot以及numpy，它只是为了plot以及math方便而用。<strong>官方文档不推荐使用它。</strong></p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>官网<span class="exturl" data-url="aHR0cHM6Ly9tYXRwbG90bGliLm9yZy9zdGFibGUvdHV0b3JpYWxzL2ludHJvZHVjdG9yeS9jdXN0b21pemluZy5odG1s">customizing<i class="fa fa-external-link-alt"></i></span>。<br>matplotlib配置信息是从配置文件<code>.matplotlibrc</code>中读取的。<br>在配置文件中可以为matplotlib几乎所有的属性指定永久有效的默认值。<br>你可以通过索引字典改变这些设置，可通过<code>mpl.rcdefaults()</code>恢复初始值。使用 plt.style 来选择图形的绘图风格。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看配置</span></span><br><span class="line">mpl.rcParams</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">RcParams(&#123;&#x27;_internal.classic_mode&#x27;: False,</span></span><br><span class="line"><span class="string">          &#x27;agg.path.chunksize&#x27;: 0,</span></span><br><span class="line"><span class="string">          &#x27;animation.avconv_args&#x27;: [],</span></span><br><span class="line"><span class="string">          &#x27;animation.avconv_path&#x27;: &#x27;avconv&#x27;,</span></span><br><span class="line"><span class="string">          &#x27;animation.bitrate&#x27;: -1,</span></span><br><span class="line"><span class="string">          &#x27;animation.codec&#x27;: &#x27;h264&#x27;,</span></span><br><span class="line"><span class="string">          &#x27;animation.convert_args&#x27;: [],</span></span><br><span class="line"><span class="string">          &#x27;animation.convert_path&#x27;: &#x27;convert&#x27;,</span></span><br><span class="line"><span class="string">          &#x27;animation.embed_limit&#x27;: 20.0,</span></span><br><span class="line"><span class="string">          &#x27;animation.ffmpeg_args&#x27;: [],</span></span><br><span class="line"><span class="string">          &#x27;animation.ffmpeg_path&#x27;: &#x27;ffmpeg&#x27;,</span></span><br><span class="line"><span class="string">          &#x27;animation.frame_format&#x27;: &#x27;png&#x27;,</span></span><br><span class="line"><span class="string">          &#x27;animation.html&#x27;: &#x27;none&#x27;,</span></span><br><span class="line"><span class="string">          ...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 字典修改所有已经加载的配置项</span></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;lines.color&#x27;</span>] = <span class="string">&#x27;r&#x27;</span></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;lines.color&#x27;</span>]</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;r&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 恢复初始值</span></span><br><span class="line">mpl.rcdefaults()</span><br><span class="line">mpl.rcParams[<span class="string">&#x27;lines.color&#x27;</span>]</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;C0&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 配置绘图样式，经典风格classic</span></span><br><span class="line">plt.style.use(<span class="string">&#x27;classic&#x27;</span>)</span><br></pre></td></tr></table></figure><br>如果你不希望在每次代码开始时进行参数配置，则可以在项目中给出配置文件。配置文件有三个位置：<br>（1）系统级配置文件。通常在 python 的 site-packages 目录下。每次重装 matplotlib 之后该配置文件就会被覆盖。<br>（2）用户级配置文件。通常在<code>$HOME</code>目录下。可以用<code>mpl.get_configdir()</code>函数来查找当前用户的配置文件目录。可以通过<code>MATPLOTLIBRC</code>修改它的位置。<br>（3）当前工作目录。即项目的目录。在当前目录下，可以为目录所包含的当前项目给出配置文件，文件名为<code>.matplotlibrc</code>。<br>优先级：<code>当前工作目录 &gt; 用户级配置文件 &gt; 系统级配置文件</code>。查看当前使用的配置文件的路径为：<code>mpl.matplotlib_fname()</code>。</p>
<p>配置文件的内容常见的有以下几种：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">axes            设置坐标轴边界和表面的颜色、坐标刻度值大小和网格的显示</span><br><span class="line">backend         设置目标输出TkAgg和GTKAgg</span><br><span class="line">figure          控制dpi、边界颜色、图像大小和子区(subplot)设置</span><br><span class="line">font            字体(font family)、字体大小和样式设置</span><br><span class="line">grid            设置网格颜色和线型</span><br><span class="line">legend          设置图例以及其中的文本显示</span><br><span class="line">line            设置线条（颜色、线型、宽度等）和标记</span><br><span class="line">patch           填充2D空间的图形图像，如多边形和圆。控制线宽、颜色和抗锯齿设置等。</span><br><span class="line">savefig         对保存的图形进行单独设置。如渲染的文件背景为白色。</span><br><span class="line">text            设置字体颜色、文本解析（纯文本和latex标记）等。</span><br><span class="line">verbose:        设置matplotlib执行期间的信息输出，如silent、helpful、debug和debug--annoying</span><br><span class="line">xticks、yticks  为x、y轴的主刻度和次刻度设置颜色、大小、方向以及标签大小</span><br></pre></td></tr></table></figure></p>
<p>Matplotlib 每次加载时，都会定义一个<strong>运行时配置</strong>（runtime configuration，rc），其中包含了所有你创建的图形元素的默认风格。你可以用 <code>plt.rc()</code> 简便方法随时修改这个配置。这些配置会保存在<code>.matplotlibrc</code>文件中。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> cycler</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先复制一下目前的 rcParams 字典，这样可以在修改之后再还原回来</span></span><br><span class="line">IPython_default = plt.rcParams.copy()</span><br><span class="line"></span><br><span class="line">colors = cycler(<span class="string">&#x27;color&#x27;</span>,[<span class="string">&#x27;#EE6666&#x27;</span>, <span class="string">&#x27;#3388BB&#x27;</span>, <span class="string">&#x27;#9988DD&#x27;</span>,<span class="string">&#x27;#EECC55&#x27;</span>, <span class="string">&#x27;#88BB44&#x27;</span>, <span class="string">&#x27;#FFBBBB&#x27;</span>])</span><br><span class="line"></span><br><span class="line">plt.rc(<span class="string">&#x27;axes&#x27;</span>, facecolor=<span class="string">&#x27;#E6E6E6&#x27;</span>, edgecolor=<span class="string">&#x27;none&#x27;</span>,axisbelow=<span class="literal">True</span>, grid=<span class="literal">True</span>, prop_cycle=colors)</span><br><span class="line">plt.rc(<span class="string">&#x27;grid&#x27;</span>, color=<span class="string">&#x27;w&#x27;</span>, linestyle=<span class="string">&#x27;solid&#x27;</span>)</span><br><span class="line">plt.rc(<span class="string">&#x27;xtick&#x27;</span>, direction=<span class="string">&#x27;out&#x27;</span>, color=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">plt.rc(<span class="string">&#x27;ytick&#x27;</span>, direction=<span class="string">&#x27;out&#x27;</span>, color=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">plt.rc(<span class="string">&#x27;patch&#x27;</span>, edgecolor=<span class="string">&#x27;#E6E6E6&#x27;</span>)</span><br><span class="line">plt.rc(<span class="string">&#x27;lines&#x27;</span>, linewidth=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直方图</span></span><br><span class="line">x = np.random.randn(<span class="number">1000</span>)</span><br><span class="line">plt.hist(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不用时，还原默认配置</span></span><br><span class="line"><span class="comment"># plt.rcParams.update(IPython_default)</span></span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/EiDR8KCS5XTZVzU.jpg" alt=""><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 折线图</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    plt.plot(np.random.rand(<span class="number">10</span>))</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/QeFNs14KUYZkBgA.jpg" alt=""></p>
<h2 id="样式表"><a href="#样式表" class="headerlink" title="样式表"></a>样式表</h2><p>手动用<code>plt.rc()</code>修改配置，太麻烦，Matplotlib 中增加了一个非常好用的 style 模块里面包含了大量的新式默认样式表，还支持创建和打包你自己的风格。虽然这些样式表实现的格式功能与前面介绍的<code>.matplotlibrc</code>文件类似，但是它的文件扩展名是<code>.mplstyle</code>。通过<code>plt.style.available</code> 命令可以看到所有可用的风格：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看前5个样式</span></span><br><span class="line">plt.style.available[:<span class="number">5</span>]</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[&#x27;fivethirtyeight&#x27;,</span></span><br><span class="line"><span class="string">&#x27;seaborn-pastel&#x27;,</span></span><br><span class="line"><span class="string">&#x27;seaborn-whitegrid&#x27;,</span></span><br><span class="line"><span class="string">&#x27;ggplot&#x27;,</span></span><br><span class="line"><span class="string">&#x27;grayscale&#x27;]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br>使用某一个样式：<code>plt.style.use(&#39;stylename&#39;)</code>，但需要注意的是，这样会改变后面所有的风格！如果需要，你可以使用风格上下文管理器临时更换至另一种风格：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> plt.style.context(<span class="string">&#x27;stylename&#x27;</span>):</span><br><span class="line">    <span class="comment">#...</span></span><br></pre></td></tr></table></figure><br>常用的是seaborn风格，除了<code>plt.style.use(&#39;seaborn-pastel&#39;)</code>这种方式导入样式，还能用<code>import seaborn</code>，在 Notebook 导入 Seaborn 程序库后会自动加载seaborn样式。</p>
<h2 id="绘图显示"><a href="#绘图显示" class="headerlink" title="绘图显示"></a>绘图显示</h2><p>如何显示你的图形，就取决于具体的开发环境了。 Matplotlib 的最佳实践与你使用的开发环境有关。简单来说，就是有三种开发环境，分别是<strong>脚本</strong>、 <strong>IPython shell</strong> 和 <strong>IPython Notebook</strong>。<br>（1）<strong>脚本</strong>文件中使用Matplotlib，那么显示图形的时候<strong>必须使用<code>plt.show()</code></strong>。<br>（2）<strong>IPython shell</strong>中<strong>交互式</strong>地使用Matplotlib，需使用<code>%matplotlib</code>魔法命令启动Matplotlib模式。<br>（3）<strong>IPython Notebook</strong>中使用Matplotlib有两种方式：<code>%matplotlib notebook</code> 启动<strong>交互式</strong>图形；<code>%matplotlib inline</code> 启动<strong>静态</strong>图形。<br>之后的所有Notebook中的例子都会使用静态模式。<br><div class="note info"><p>plt.show() 会启动一个事件循环（event loop），并找到所有当前可用的图形对象，然后打开一个或多个交互式窗口显示图形。但一个 Python 会话中只能使用一次 plt.show()，因此通常都把它放在脚本的最后。</p>
<p>IPython shell中启动Matplotlib 模式后，任何 plt 命令都会自动打开一个图形窗口，增加新的命令，图形就会更新，所以不需要使用 plt.show()。有一些变化（例如改变已经画好的线条属性）不会自动及时更新；对于这些变化，可以使用plt.draw() 强制更新。</p>
<p>IPython Notebook 中，静态模式时，运行单元格中的命令之后（每一个 Notebook 核心任务 / 会话只需要运行一次），在每一个 Notebook 的单元中创建图形就会直接将 PNG 格式图形文件嵌入在单元中。</p>
</div></p>
<h2 id="图形保存"><a href="#图形保存" class="headerlink" title="图形保存"></a>图形保存</h2><p>Matplotlib 的一个优点是能够将图形保存为各种不同的数据格式。你可以用 <code>savefig()</code> 命令将图形保存为文件。例如，如果要将图形保存为 PNG 格式，你可以运行这行代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line">plt.plot(x, np.sin(x), <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">plt.plot(x, np.cos(x), <span class="string">&#x27;--&#x27;</span>)</span><br><span class="line"><span class="comment"># 保存图形</span></span><br><span class="line">fig.savefig(<span class="string">&#x27;my_figure.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示保存的图形</span></span><br><span class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> Image</span><br><span class="line">Image(<span class="string">&#x27;my_figure.png&#x27;</span>)</span><br></pre></td></tr></table></figure><br>在 savefig() 里面，保存的图片文件格式就是文件的扩展名。 你可以通过 canvas 对象的方法查看系统支持的文件格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fig.canvas.get_supported_filetypes()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#123;&#x27;ps&#x27;: &#x27;Postscript&#x27;,</span></span><br><span class="line"><span class="string"> &#x27;eps&#x27;: &#x27;Encapsulated Postscript&#x27;,</span></span><br><span class="line"><span class="string"> &#x27;pdf&#x27;: &#x27;Portable Document Format&#x27;,</span></span><br><span class="line"><span class="string"> &#x27;pgf&#x27;: &#x27;PGF code for LaTeX&#x27;,</span></span><br><span class="line"><span class="string"> &#x27;png&#x27;: &#x27;Portable Network Graphics&#x27;,</span></span><br><span class="line"><span class="string"> &#x27;raw&#x27;: &#x27;Raw RGBA bitmap&#x27;,</span></span><br><span class="line"><span class="string"> &#x27;rgba&#x27;: &#x27;Raw RGBA bitmap&#x27;,</span></span><br><span class="line"><span class="string"> &#x27;svg&#x27;: &#x27;Scalable Vector Graphics&#x27;,</span></span><br><span class="line"><span class="string"> &#x27;svgz&#x27;: &#x27;Scalable Vector Graphics&#x27;&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="两种画图接口"><a href="#两种画图接口" class="headerlink" title="两种画图接口"></a>两种画图接口</h2><p>Matplotlib 有一个容易让人混淆的特性，就是它的两种画图接口：一个是便捷的<strong>MATLAB风格接口</strong>，另一个是功能更强大的<strong>面向对象接口</strong>。下面来快速对比一下两种接口的主要差异。<br>（1）MATLAB风格接口：许多语法都和MATLAB类似。MATLAB风格的工具位于 <code>pyplot（plt）</code>接口中。这种接口最重要的特性是有状态的：它会持续跟踪“当前的”图形和坐标轴，所有 plt 命令都可以应用。你可以用 <code>plt.gcf()</code>（获取当前图形，figure对象）和 <code>plt.gca()</code>（获取当前坐标轴，Axes对象）来查看具体信息。虽然这个有状态的接口画起图来又快又方便，但是也很容易出问题，例如，当创建上面的第二个子图时，想回到第一个子图，并增加新内容，这在MATLAB风格接口中实现就非常复杂了。<br>（2）面向对象接口：画图函数不再受到当前“活动”图形或坐标轴的限制，而变成了显式的 Figure 和 Axes 的方法。可以适应更复杂的场景，更好地控制你自己的图形。</p>
<p>虽然在画简单图形时，选择哪种绘图风格主要看个人喜好，但是在画比较复杂的图形时，面向对象方法会更方便。在绝大多数场景中，<code>plt.plot()</code> 与 <code>ax.plot()</code> 的差异非常小，但是后文会重点指出其中的一些陷阱。</p>
<div class="tabs" id="f1"><ul class="nav-tabs"><li class="tab active"><a href="#f1-1">MATLAB风格接口</a></li><li class="tab"><a href="#f1-2">面向对象接口</a></li></ul><div class="tab-content"><div class="tab-pane active" id="f1-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">plt.figure() <span class="comment"># 创建图形</span></span><br><span class="line"><span class="comment"># 创建两个子图中的第一个，设置坐标轴</span></span><br><span class="line">plt.subplot(<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>) <span class="comment"># (行、列、子图编号)</span></span><br><span class="line">plt.plot(x, np.sin(x))</span><br><span class="line"><span class="comment"># 创建两个子图中的第二个，设置坐标轴</span></span><br><span class="line">plt.subplot(<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">plt.plot(x, np.cos(x))</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="f1-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先创建图形网格</span></span><br><span class="line"><span class="comment"># ax是一个包含两个Axes对象的数组</span></span><br><span class="line">fig, ax = plt.subplots(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 在每个对象上调用plot()方法</span></span><br><span class="line">ax[<span class="number">0</span>].plot(x, np.sin(x))</span><br><span class="line">ax[<span class="number">1</span>].plot(x, np.cos(x))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者用pylab接口画图，但官方不建议使用！</span></span><br><span class="line">plt.plot(x, np.sin(x))</span><br></pre></td></tr></table></figure></div></div></div>
<p>对于非交互式绘图，官方文档推荐用pyplot创建Figure，然后使用面向对象接口来绘图。</p>
<h2 id="颜色相关"><a href="#颜色相关" class="headerlink" title="颜色相关"></a>颜色相关</h2><p>可以通过<code>matplotlib.pyplot.colors()</code>方法获取matplotlib支持的所有颜色。该方法不做任何事情，就是提供一个帮助文档。<br>或者参考官方提供的颜色代码：<span class="exturl" data-url="aHR0cHM6Ly94a2NkLmNvbS9jb2xvci9yZ2Iv">colors<i class="fa fa-external-link-alt"></i></span>。<br><strong>Ⅰ、字符串</strong><br>matplotlib提供了下面颜色的别名：’b’：蓝色；’g’：绿色；’r’：红色；’y’：黄色；’c’：青色；’k’：黑色；’m’：洋红色；’w’：白色。</p>
<p>你也可以定制自己的颜色。有两种方法：<br>（1）使用HTML十六进制字符串/颜色名字：如’#eeefff’，如’red’<br>（2）使用一个归一化到闭区间[0-1]的RGB元组：如color=(0.3,0.3,0.4)</p>
<p><strong>Ⅱ、颜色代码转换</strong><br>matplotlib.colors是一个模块，用于转换数字或者颜色参数到 RGB 或者 RGBA。<br>RGB：一个浮点数元组，有3个浮点数。每个数都是 0-1之间。<br>RGBA：一个浮点数元组，有4个浮点数。每个数都是 0-1之间。</p>
<p>colors.cnames是个字典，它给出了常用颜色的字符串和对应的#FFFFFF形式。<br><code>colors.rgb2hex(rgb)</code>：给出了rgb元组到#FFFFFF形式。 而<code>hex2color(s)</code>给出了#FFFFFF到rgb形式。</p>
<p>colors.ColorConverter类是个颜色转换器类。它提供了下面方法用于转换颜色：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.to_rgb(arg)：转换其他类型的颜色到标准的rgb三元组。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">arg: 可以为一个rgb/rgba序列/一个字符串，字符串格式为：</span></span><br><span class="line"><span class="string">    一个代表颜色的字符，如&#x27;rgbcmykw&#x27;</span></span><br><span class="line"><span class="string">    一个十六进制的颜色字符串，如&#x27;#0FFFFFF&#x27;</span></span><br><span class="line"><span class="string">    一个标准的颜色的名字，如&#x27;red&#x27;</span></span><br><span class="line"><span class="string">    一个代表浮点数的字符串，如&#x27;0.5&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">.to_rgba(arg, alpha=<span class="literal">None</span>)：转换其他类型的颜色到标准的rgba四元组</span><br><span class="line">.to_rgba_array(c, alpha=<span class="literal">None</span>)：它返回一个ndarray，而不是一个元组</span><br><span class="line">colors.colorConverter是模块提供的一个默认的实例。</span><br></pre></td></tr></table></figure><br><strong>Ⅲ、颜色条</strong><br>通过 plt.colorbar() 函数就可以创建最简单的颜色条：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">plt.style.use(<span class="string">&#x27;classic&#x27;</span>)</span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">1000</span>)</span><br><span class="line">I = np.sin(x) * np.cos(x[:, np.newaxis])</span><br><span class="line">plt.imshow(I)</span><br><span class="line">plt.colorbar()</span><br></pre></td></tr></table></figure><br>可以通过 cmap 参数配置调色盘，下面详细介绍下调色盘和配色方案等。<br><strong>1、调色盘</strong><br>参考调色盘：<span class="exturl" data-url="aHR0cHM6Ly9tYXRwbG90bGliLm9yZy8yLjAuMi9leGFtcGxlcy9jb2xvci9jb2xvcm1hcHNfcmVmZXJlbmNlLmh0bWw=">colormaps<i class="fa fa-external-link-alt"></i></span>。</p>
<p>matplotlib.cm模块包含了一系列的colormap，以及相关的函数。它主要有两个函数：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">matplotlib.cm.get_cmap(name=<span class="literal">None</span>, lut=<span class="literal">None</span>)：获取一个colormap实例。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">name：指定了colormap的名字。如果为None，则使用rc配置。如果它已经是colormap实例，则直接返回该实例。</span></span><br><span class="line"><span class="string">      注意：register_cmap注册的colormap优先查询</span></span><br><span class="line"><span class="string">lut：一个整数。如果非None，则指定了查询表的number of entries</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">matplotlib.cm.register_cmap(name=<span class="literal">None</span>, cmap=<span class="literal">None</span>, data=<span class="literal">None</span>, lut=<span class="literal">None</span>)：注册一个colormap。有两种使用方式：</span><br><span class="line">    register_cmap(name=<span class="string">&#x27;swirly&#x27;</span>, cmap=swirly_cmap)：此时cmap参数必须是mpl.colors.Colormap实例。</span><br><span class="line">                                                    name默认为该Colormap实例的.name属性。</span><br><span class="line">    register_cmap(name=<span class="string">&#x27;choppy&#x27;</span>, data=choppydata, lut=<span class="number">128</span>)：</span><br><span class="line">                    此时这三个参数传递给mpl.colors.LinearSegementedColormap初始化函数。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">配色方案都在 plt.cm 命名空间（name）里面，如下:</span></span><br><span class="line"><span class="string">&#x27;Perceptually Uniform Sequential&#x27;:[&#x27;viridis&#x27;, &#x27;inferno&#x27;, &#x27;plasma&#x27;, &#x27;magma&#x27;]</span></span><br><span class="line"><span class="string">  &#x27;Sequential&#x27;:[&#x27;Blues&#x27;, &#x27;BuGn&#x27;, &#x27;BuPu&#x27;,&#x27;GnBu&#x27;, &#x27;Greens&#x27;, &#x27;Greys&#x27;, &#x27;Oranges&#x27;, &#x27;OrRd&#x27;,</span></span><br><span class="line"><span class="string">  &#x27;PuBu&#x27;, &#x27;PuBuGn&#x27;, &#x27;PuRd&#x27;, &#x27;Purples&#x27;, &#x27;RdPu&#x27;,&#x27;Reds&#x27;, &#x27;YlGn&#x27;, &#x27;YlGnBu&#x27;, </span></span><br><span class="line"><span class="string">  &#x27;YlOrBr&#x27;, &#x27;YlOrRd&#x27;]</span></span><br><span class="line"><span class="string">  &#x27;Sequential (2)&#x27;:[&#x27;afmhot&#x27;, &#x27;autumn&#x27;, &#x27;bone&#x27;, &#x27;cool&#x27;,&#x27;copper&#x27;, &#x27;gist_heat&#x27;, &#x27;gray&#x27;, </span></span><br><span class="line"><span class="string">  &#x27;hot&#x27;,&#x27;pink&#x27;, &#x27;spring&#x27;, &#x27;summer&#x27;, &#x27;winter&#x27;] </span></span><br><span class="line"><span class="string">  &#x27;Diverging&#x27;:[&#x27;BrBG&#x27;, &#x27;bwr&#x27;, &#x27;coolwarm&#x27;, &#x27;PiYG&#x27;, &#x27;PRGn&#x27;, &#x27;PuOr&#x27;,</span></span><br><span class="line"><span class="string">  &#x27;RdBu&#x27;, &#x27;RdGy&#x27;, &#x27;RdYlBu&#x27;, &#x27;RdYlGn&#x27;, &#x27;Spectral&#x27;,&#x27;seismic&#x27;] </span></span><br><span class="line"><span class="string">  &#x27;Qualitative&#x27;:[&#x27;Accent&#x27;, &#x27;Dark2&#x27;, &#x27;Paired&#x27;, &#x27;Pastel1&#x27;, &#x27;Pastel2&#x27;,</span></span><br><span class="line"><span class="string">  &#x27;Set1&#x27;, &#x27;Set2&#x27;, &#x27;Set3&#x27;] </span></span><br><span class="line"><span class="string">  &#x27;Miscellaneous&#x27;:[&#x27;gist_earth&#x27;, &#x27;terrain&#x27;, &#x27;ocean&#x27;, &#x27;gist_stern&#x27;,&#x27;brg&#x27;,</span></span><br><span class="line"><span class="string">  &#x27;CMRmap&#x27;, &#x27;cubehelix&#x27;,&#x27;gnuplot&#x27;, &#x27;gnuplot2&#x27;,   </span></span><br><span class="line"><span class="string">  &#x27;gist_ncar&#x27;,&#x27;nipy_spectral&#x27;, &#x27;jet&#x27;, &#x27;rainbow&#x27;,</span></span><br><span class="line"><span class="string">  &#x27;gist_rainbow&#x27;, &#x27;hsv&#x27;, &#x27;flag&#x27;, &#x27;prism&#x27;] </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">可使用 plt.cm.&lt;TAB&gt; 查看这些配色方案。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br>可以使用cm.get_cmap(‘winter’)来使用，也可以直接用cm.winter来使用。</p>
<p>很多函数中有 cmap 参数，就是使用的调色盘。<br><strong>2、配色方案</strong><br>一般情况下，你只需要重点关注三种不同的配色方案：<br>（1）顺序配色方案：由一组连续的颜色构成的配色方案（例如 binary 或 viridis）。<br>（2）互逆配色方案：通常由两种互补的颜色构成，表示正反两种含义（例如 RdBu 或 PuOr）。<br>（3）定性配色方案：随机顺序的一组颜色（例如 rainbow 或 jet）</p>
<p>jet 是一种定性配色方案，曾是 Matplotlib 2.0 之前所有版本的默认配色方案。把它作为默认配色方案实在不是个好主意，因为定性配色方案在对定性数据进行可视化时的选择空间非常有限。随着图形亮度的提高，经常会出现颜色无法区分的问题。</p>
<p>更好的配色方案是 viridis，已经成为 Matplotlib 2.0 的默认配色方案。它采用了精心设计的亮度渐变方式，这样不仅便于视觉观察，而且转换成灰度图后也更清晰。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># jet 转换为黑白的灰度图看看具体的颜色</span></span><br><span class="line"><span class="keyword">from</span> matplotlib.colors <span class="keyword">import</span> LinearSegmentedColormap</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">grayscale_cmap</span>(<span class="params">cmap</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;为配色方案显示灰度图&quot;&quot;&quot;</span></span><br><span class="line">    cmap = plt.cm.get_cmap(cmap)</span><br><span class="line">    colors = cmap(np.arange(cmap.N))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将RGBA色转换为不同亮度的灰度值</span></span><br><span class="line">    <span class="comment"># 参考链接http://alienryderflex.com/hsp.html</span></span><br><span class="line">    RGB_weight = [<span class="number">0.299</span>, <span class="number">0.587</span>, <span class="number">0.114</span>]</span><br><span class="line">    luminance = np.sqrt(np.dot(colors[:, :<span class="number">3</span>] ** <span class="number">2</span>, RGB_weight))</span><br><span class="line">    colors[:, :<span class="number">3</span>] = luminance[:, np.newaxis]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> LinearSegmentedColormap.from_list(cmap.name + <span class="string">&quot;_gray&quot;</span>, colors, cmap.N)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view_colormap</span>(<span class="params">cmap</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;用等价的灰度图表示配色方案&quot;&quot;&quot;</span></span><br><span class="line">    cmap = plt.cm.get_cmap(cmap)</span><br><span class="line">    colors = cmap(np.arange(cmap.N))</span><br><span class="line"></span><br><span class="line">    cmap = grayscale_cmap(cmap)</span><br><span class="line">    grayscale = cmap(np.arange(cmap.N))</span><br><span class="line"></span><br><span class="line">    fig, ax = plt.subplots(<span class="number">2</span>, figsize=(<span class="number">6</span>, <span class="number">2</span>), subplot_kw=<span class="built_in">dict</span>(xticks=[], yticks=[]))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 每个配色方案都有2个图：色彩图、灰度图</span></span><br><span class="line">    ax[<span class="number">0</span>].imshow([colors], extent=[<span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">    ax[<span class="number">1</span>].imshow([grayscale], extent=[<span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># jet 黑白</span></span><br><span class="line">view_colormap(<span class="string">&#x27;jet&#x27;</span>)</span><br><span class="line"><span class="comment"># viridis</span></span><br><span class="line">view_colormap(<span class="string">&#x27;viridis&#x27;</span>)</span><br><span class="line"><span class="comment"># cubehelix 彩虹色</span></span><br><span class="line">view_colormap(<span class="string">&#x27;cubehelix&#x27;</span>)</span><br><span class="line"><span class="comment"># 要用两种颜色表示正反两种含义时，可以使用 RdBu 双色配色方案，红色-蓝色（Red-Blue简称）</span></span><br><span class="line">view_colormap(<span class="string">&#x27;RdBu&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/24/gD14zfP3vbuY8ds.jpg" alt=""></p>
<p><strong>3、颜色条刻度等设置</strong><br>Matplotlib 提供了丰富的颜色条配置功能。由于可以将颜色条本身仅看作是一个 plt.Axes实例，因此所有关于坐标轴和刻度值的格式配置技巧都可以派上用场。<br>例如，我们可以缩短颜色取值的上下限，对于超出上下限的数据，通过 extend 参数用三角箭头表示比上限大的数或者比下限小的数。比如你想展示一张噪点图：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为图形像素设置1%噪点</span></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">1000</span>)</span><br><span class="line">I = np.sin(x) * np.cos(x[:, np.newaxis])</span><br><span class="line">speckles = (np.random.random(I.shape) &lt; <span class="number">0.01</span>)</span><br><span class="line">I[speckles] = np.random.normal(<span class="number">0</span>, <span class="number">3</span>, np.count_nonzero(speckles))</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">3.5</span>))</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">plt.imshow(I, cmap=<span class="string">&#x27;RdBu&#x27;</span>)</span><br><span class="line">plt.colorbar()</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">plt.imshow(I, cmap=<span class="string">&#x27;RdBu&#x27;</span>)</span><br><span class="line">plt.colorbar(extend=<span class="string">&#x27;both&#x27;</span>)</span><br><span class="line">plt.clim(<span class="number">-1</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/24/OJdV6aQhq7iGgKl.jpg" alt=""><br>左边那幅图是用默认的颜色条刻度限制实现的效果，噪点的范围完全覆盖了我们感兴趣的数据。而右边的图形设置了颜色条的刻度上下限，并在上下限之外增加了扩展功能，这样的数据可视化图形显然更有效果。</p>
<p><strong>4、离散型颜色条</strong><br>虽然颜色条默认都是连续的，但有时你可能也需要表示离散数据。最简单的做法就是使用<code>plt.cm.get_cmap()</code>函数，将适当的配色方案的名称以及需要的区间数量传进去即可。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.imshow(I, cmap=plt.cm.get_cmap(<span class="string">&#x27;Blues&#x27;</span>, <span class="number">6</span>))</span><br><span class="line">plt.colorbar()</span><br><span class="line">plt.clim(<span class="number">-1</span>, <span class="number">1</span>) <span class="comment"># 设置颜色区间</span></span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/24/odkw4xtLuQbl9hK.jpg" alt="离散颜色条.jpg"></p>
<h2 id="点的形状"><a href="#点的形状" class="headerlink" title="点的形状"></a>点的形状</h2><p>参考<span class="exturl" data-url="aHR0cHM6Ly9tYXRwbG90bGliLm9yZy9zdGFibGUvYXBpL21hcmtlcnNfYXBpLmh0bWw=">matplotlib.markers<i class="fa fa-external-link-alt"></i></span>。<br><img src="https://i.loli.net/2021/05/24/4WHxe6LDfpvOzEu.png" alt="marker形状.jpg"></p>
<h2 id="子图布局"><a href="#子图布局" class="headerlink" title="子图布局"></a>子图布局</h2><p><code>pyplot.subplot2grid()</code>：创建网格布局。你只需要提供网格形状以及SubPlot位置即可，如：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.subplot2grid((<span class="number">2</span>,<span class="number">2</span>),(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line"><span class="comment"># 它等价于ax=pyplot.subplot(2,2,1)。其中subplot2grid()的位置坐标从0开始。</span></span><br></pre></td></tr></table></figure><br><code>subplot2grid()</code>支持SubPlot横跨或者纵跨多个单元格。colspan关键字参数指定纵向的跨度；rowspanguan尖子参数指定横向的跨度。<br><strong>1、单个子图</strong><br><code>Figure.add_subplot(*args,**kwargs)</code>/<code>pyplot.subplot(*args,**kwargs)</code>方法做一个子图布局，它返回的是Axes实例。SubPlot类是Axes类的子类。因此SubPlot对象也是Axes对象。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">matplotlib.pyplot.subplot(nrows,ncols,plot_number)：创建子图</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">nrows和ncols将图表划分成nrows*ncols大小的网格区域，每一个区域都能存放一个子图；</span></span><br><span class="line"><span class="string">plot_number子图位置。从1开始，从左到右，从上到下，最大值为nrows*ncols。</span></span><br><span class="line"><span class="string">如果nrows、ncols、plot_number都是个位数，则你可以指定一个三位数来简化函数调用plt.subplot(integer)：</span></span><br><span class="line"><span class="string">    其中百分位代表nrows，十分位代表ncols，各位代表plot_number。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其他参数：</span></span><br><span class="line"><span class="string">axisbg：指定subplot的背景色</span></span><br><span class="line"><span class="string">polar：指定subplot是否是极坐标。默认为False</span></span><br><span class="line"><span class="string">projection：指定坐标方式。值可以为：</span></span><br><span class="line"><span class="string">            &#x27;aitoff&#x27;、&#x27;hammer&#x27;、&#x27;lambert&#x27;、&#x27;mollweide&#x27;、</span></span><br><span class="line"><span class="string">            &#x27;polar&#x27;、 &#x27;rectilinear&#x27;。当projection=&#x27;polar&#x27;等价于ploar=True</span></span><br><span class="line"><span class="string">sharex关键字参数：指定subplot与其他Axes(由该参数值指定）共享xaxis attribute</span></span><br><span class="line"><span class="string">sharey关键字参数：指定subplot是否与其他Axes(由该参数值指定）共享yaxis attribute</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># subplot，下图左</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>):</span><br><span class="line">    plt.subplot(<span class="number">2</span>, <span class="number">3</span>, i)</span><br><span class="line">    plt.text(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="built_in">str</span>((<span class="number">2</span>, <span class="number">3</span>, i)), fontsize=<span class="number">18</span>, ha=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># subplots_adjust 调整位置和间距，下图右</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">fig.subplots_adjust(hspace=<span class="number">0.4</span>, wspace=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>):</span><br><span class="line">    ax = fig.add_subplot(<span class="number">2</span>, <span class="number">3</span>, i)</span><br><span class="line">    ax.text(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="built_in">str</span>((<span class="number">2</span>, <span class="number">3</span>, i)), fontsize=<span class="number">18</span>, ha=<span class="string">&#x27;center&#x27;</span>)</span><br></pre></td></tr></table></figure><br><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img src="https://i.loli.net/2021/05/24/kf7Dix3pEBbK4lj.jpg" alt=""></div><div class="group-picture-column"><img src="https://i.loli.net/2021/05/24/SowXgFQlE1di23M.jpg" alt=""></div></div></div></p>
<p><strong>2、多个子图</strong><br>可以通过<code>pyplot.subplots()</code>函数一次性的创建多个SubPlot。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">matplotlib.pyplot.subplots(*args,**kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">nrows：行数，默认为1</span></span><br><span class="line"><span class="string">ncols：列数，默认为1</span></span><br><span class="line"><span class="string">sharex：</span></span><br><span class="line"><span class="string">        如果为True，则所有SubPlot的X axis被共享。此时只有最后一行的X轴可见。</span></span><br><span class="line"><span class="string">        如果为False，则SubPlot的X axis不共享，每一个SbuPlot的X轴可见。</span></span><br><span class="line"><span class="string">        如果为字符串all，则等效于True</span></span><br><span class="line"><span class="string">        如果为字符串none，则当小于False</span></span><br><span class="line"><span class="string">        如果为字符串row，则每一行的SubPlot共享一个X轴（与False等效）</span></span><br><span class="line"><span class="string">        如果为字符串col，则每一列的SubPlot共享一个X轴（与True等效）</span></span><br><span class="line"><span class="string">sharey：</span></span><br><span class="line"><span class="string">        如果为True，则所有SubPlot的Y axis被共享。此时只有第一列的Y轴可见。</span></span><br><span class="line"><span class="string">        如果为False，则SubPlot的Y axis不共享，每一个SbuPlot的Y轴可见。</span></span><br><span class="line"><span class="string">        如果为字符串all，则等效于True</span></span><br><span class="line"><span class="string">        如果为字符串none，则当小于False</span></span><br><span class="line"><span class="string">        如果为字符串row，则每一行的SubPlot共享一个Y轴（与True等效）</span></span><br><span class="line"><span class="string">        如果为字符串col，则每一列的SubPlot共享一个Y轴（与False等效）</span></span><br><span class="line"><span class="string">squeeze：</span></span><br><span class="line"><span class="string">        如果为True：</span></span><br><span class="line"><span class="string">                    如果只创建了一个SubPlot，则返回一个变量（创建的SubPlot对象)</span></span><br><span class="line"><span class="string">                    如果创建了N*1或者1*N个SubPlot，则返回一个1维向量</span></span><br><span class="line"><span class="string">                    如果创建了N*M个SubPlot（其中N&gt;1,M&gt;1），则返回一个2维向量</span></span><br><span class="line"><span class="string">                    如果为False则始终返回一个2维向量</span></span><br><span class="line"><span class="string">        如果为False则始终返回一个2维向量</span></span><br><span class="line"><span class="string">subplot_kw：一个字典参数，用于传递给Axes.add_subplot()来创建SubPlot</span></span><br><span class="line"><span class="string">gridspec_kw：一个字典参数，用于传递给GridSpec构造函数来创建SubPlot存放的网格</span></span><br><span class="line"><span class="string">fig_kw：一个字典参数，用于传递给pyplot.figure()函数。所有前述未能识别的感激案子参数都会传到这里。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其返回值为figure,ax。其中figure是一个Figure对象；ax取决于squeeze参数。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个 2×3 网格子图，每行的3个子图使用相同的y轴坐标，每列的2个子图使用相同的x轴坐标</span></span><br><span class="line"><span class="comment"># 设置 sharex 与 sharey 参数之后，我们就可以自动去掉网格内部子图的标签，让图形看起来更整洁</span></span><br><span class="line">fig, ax = plt.subplots(<span class="number">2</span>, <span class="number">3</span>, sharex=<span class="string">&#x27;col&#x27;</span>, sharey=<span class="string">&#x27;row&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 坐标轴存放在一个NumPy数组中，按照[row, col]取值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        ax[i, j].text(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="built_in">str</span>((i, j)), fontsize=<span class="number">18</span>, ha=<span class="string">&#x27;center&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/24/ngr1q8p6bUwlRTH.jpg" alt="subplots.jpg"></p>
<p><strong>3、不规则子图</strong><br>实现不规则的多行多列子图网格，<code>plt.GridSpec()</code>是最好的工具。<code>plt.GridSpec()</code>对象本身不能直接创建一个图形，它只是<code>plt.subplot()</code>命令可以识别的简易接口。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一个带行列间距的2×3网格</span></span><br><span class="line">grid = plt.GridSpec(<span class="number">2</span>, <span class="number">3</span>, wspace=<span class="number">0.4</span>, hspace=<span class="number">0.3</span>)</span><br><span class="line"><span class="comment"># 类似 Python 切片的语法设置子图的位置和扩展尺寸</span></span><br><span class="line">plt.subplot(grid[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">plt.subplot(grid[<span class="number">0</span>, <span class="number">1</span>:])</span><br><span class="line">plt.subplot(grid[<span class="number">1</span>, :<span class="number">2</span>])</span><br><span class="line">plt.subplot(grid[<span class="number">1</span>, <span class="number">2</span>])</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/24/3XnAv6cjaQxEdiZ.jpg" alt=""></p>
<p>这种灵活的网格排列方式用途十分广泛，我经常会用它来创建多轴频次直方图：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一些正态分布数据</span></span><br><span class="line">mean = [<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">cov = [[<span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>]]</span><br><span class="line">x, y = np.random.multivariate_normal(mean, cov, <span class="number">3000</span>).T</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置坐标轴和网格配置方式</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">6</span>, <span class="number">6</span>))</span><br><span class="line">grid = plt.GridSpec(<span class="number">4</span>, <span class="number">4</span>, hspace=<span class="number">0.2</span>, wspace=<span class="number">0.2</span>)</span><br><span class="line">main_ax = fig.add_subplot(grid[:<span class="number">-1</span>, <span class="number">1</span>:])</span><br><span class="line">y_hist = fig.add_subplot(grid[:<span class="number">-1</span>, <span class="number">0</span>], xticklabels=[], sharey=main_ax)</span><br><span class="line">x_hist = fig.add_subplot(grid[<span class="number">-1</span>, <span class="number">1</span>:], yticklabels=[], sharex=main_ax)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主坐标轴画散点图</span></span><br><span class="line">main_ax.plot(x, y, <span class="string">&#x27;ok&#x27;</span>, markersize=<span class="number">3</span>, alpha=<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 次坐标轴画频次直方图</span></span><br><span class="line">x_hist.hist(x, <span class="number">40</span>, histtype=<span class="string">&#x27;stepfilled&#x27;</span>, orientation=<span class="string">&#x27;vertical&#x27;</span>, color=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">x_hist.invert_yaxis()</span><br><span class="line"></span><br><span class="line">y_hist.hist(y, <span class="number">40</span>, histtype=<span class="string">&#x27;stepfilled&#x27;</span>, orientation=<span class="string">&#x27;horizontal&#x27;</span>, color=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">y_hist.invert_xaxis()</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/24/bGk2wdTjIY14KyP.jpg" alt=""></p>
<h2 id="坐标变换"><a href="#坐标变换" class="headerlink" title="坐标变换"></a>坐标变换</h2><p>matplotlib中有四个坐标系：<br>（1）data坐标系：坐标转换对象为ax.transData。它是用户级坐标系，由xlim和ylim控制。<br>（2）Axes坐标系：坐标转换对象为ax.transAxes。它是Axes的坐标系，(0,0)为Axes的左下角，(1,1)为Axes的右上角。<br>（3）Figure坐标系：坐标转换对象为fig.transFigure。它是Figure的坐标系，(0,0)为Figure的左下角，(1,1)为Figure的右上角。<br>（4）display坐标系：它没有坐标转换对象。它显示的是display的像素坐标系，(0,0)为display左下角、(width,height)为display右上角。</p>
<p>前面三个坐标系的坐标转换对象有方法执行坐标转换，这些方法接受输入并产生输出：<strong>输入为本坐标系内的坐标点，输出为display坐标系中的坐标</strong>。（因此display坐标系没有坐标转换对象）。当然他们也有相关方法将来自于display坐标系中的坐标转换回本坐标系内的坐标。</p>
<p>一共有三种预定义的坐标变换方式：<br>（1）ax.transData：以数据为基准的坐标变换。改变了坐标轴上下限，那么只有transData坐标会受影响。<br>（2）ax.transAxes：以坐标轴为基准的坐标变换（以坐标轴维度为单位）。<br>（3）fig.transFigure：以图形为基准的坐标变换（以图形维度为单位）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots(facecolor=<span class="string">&#x27;lightgray&#x27;</span>)</span><br><span class="line">ax.axis([<span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">10</span>])</span><br><span class="line"><span class="comment"># 在Artist的构造函数中传入 transform 关键字参数（其值为坐标转换对象），就能够切换坐标系</span></span><br><span class="line"><span class="comment"># 虽然transform=ax.transData是默认值，但还是设置一下</span></span><br><span class="line">ax.text(<span class="number">1</span>, <span class="number">5</span>, <span class="string">&quot;. Data: (1, 5)&quot;</span>, transform=ax.transData)</span><br><span class="line"><span class="comment"># 将Text放置于Axes坐标系中的(0.5,0.1)位置处</span></span><br><span class="line">ax.text(<span class="number">0.5</span>, <span class="number">0.1</span>, <span class="string">&quot;. Axes: (0.5, 0.1)&quot;</span>, transform=ax.transAxes)</span><br><span class="line">ax.text(<span class="number">0.2</span>, <span class="number">0.2</span>, <span class="string">&quot;. Figure: (0.2, 0.2)&quot;</span>, transform=fig.transFigure)</span><br><span class="line">plt.grid()</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/05/24/u8ACsBVSK7DeZjG.jpg" alt=""><br>transData坐标用x轴与y轴的标签作为数据坐标。<br>transAxes坐标以坐标轴（图中白色矩形）左下角的位置为原点，按坐标轴尺寸的比例呈现坐标。<br>transFigure坐标与之类似，不过是以图形（图中灰色矩形）左下角的位置为原点，按图形尺寸的比例呈现坐标。</p>
<p>通常不建议直接使用display坐标系。因为它固定了绝对坐标，导致resize图表时你必须重新定位坐标。所以必须监听resize事件，非常麻烦。<br><strong>1、 用户的 data 坐标系</strong><br>当调用<code>ax.set_xlimit(x_min,x_max)</code>以及<code>ax.set_ylimit(y_min,y_max)</code>时，即建立起了用户data坐标系。左下角坐标为<code>(x_min,y_min)</code>，右上角坐标为<code>(x_max,y_max)</code>。<br>有时候你可能并没有显式调用<code>.set_xlimit()</code>以及<code>.set_ylimit()</code>。其实matplotlib会隐式调用它们来设置坐标轴的数据范围。</p>
<p>可以调用ax.transData返回data坐标系的坐标转换对象。<br>对该坐标转换对象调用<code>.transform(point)</code>方法会返回point在display坐标系下的坐标。其中point是点在data坐标系下的坐标(x,y)。你也可以给<code>.transform()</code>方法一次传入多个点的坐标，此时输出也是对应于display坐标系下的一系列坐标。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>)</span><br><span class="line">ax.set_xlim(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line">ax.set_ylim(<span class="number">-1</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># type(ax.transData)</span></span><br><span class="line">ax.transData.transform((<span class="number">5</span>, <span class="number">0</span>))</span><br></pre></td></tr></table></figure><br>可以对ax.trandData返回的坐标转换对象调用<code>.inverted()</code>方法。该方法返回的是一个坐标逆转换对象。对该坐标逆转换对象调用<code>.transform(point)</code>方法会返回point在data坐标系下的坐标。其中point是点在display坐标系下的坐标(x,y)。你也可以给<code>.transform()</code>方法一次传入多个点的坐标，此时输出也是对应于data坐标系下的一系列坐标。</p>
<p>当你调用了<code>ax.set_xlim()</code>或者<code>ax.set_ylim()</code>时，坐标转换对象会实时更新。</p>
<p><strong>2、Axes 坐标系</strong><br>在Axes坐标系中，(0,0)位于Axes的左下角，(1,1)位于Axes的右上角，(0.5,0.5)位于Axes的中心。当然你可以引用位于这之外的点，如(-0.1,1.1)。</p>
<p>通常如果你需要在Axes中放置一些文字说明，那么一般都是采用Axes坐标系来定位。这样无论图形怎么缩放，这些Text都能位于正确的位置。</p>
<p>你也可以在Axes中通过Axes坐标系添加一些Patch，但是通常建议在data坐标系下添加。因为你在Axes中添加的图表当图表缩放时可能会出现问题。</p>
<p><strong>3、混合坐标系</strong><br>有时候你需要混合data坐标系和Axes坐标系。通过<code>matplotlib.transforms.blended_transform_factory(ax.transData, ax.transAxes)</code>能够返回一个混合坐标系，该坐标系中：x坐标为data坐标系，y坐标为Axes坐标系。因此该坐标系中(1,1)表示的是data坐标系中x=1但是y位于最上方的点。</p>
<p>有两个函数返回特定的混合坐标系：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">matplotlib.axes.Axes.get_xaxis_transform():</span><br><span class="line"><span class="comment"># 等价于matplotlib.transforms.blended_transform_factory(ax.transData, ax.transAxes)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x坐标为data坐标系，y坐标为Axes坐标系。常用于绘制x轴的label、tick、gridline。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">matplotlib.axes.Axes.get_yaxis_transform():</span><br><span class="line"><span class="comment"># 等价于matplotlib.transforms.blended_transform_factory(ax.transAxes,ax.transData)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x坐标为Axes坐标系，y坐标为data坐标系。常用于绘制y轴的label、tick、gridline。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br><strong>4、其他坐标系</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面2个方法，可以设置x轴/y轴是否对数坐标</span></span><br><span class="line">Axes.set_xscale(value,**kwargs)</span><br><span class="line">Axes.set_yscale(value,**kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">其中value可以为:</span></span><br><span class="line"><span class="string">    linear：线性</span></span><br><span class="line"><span class="string">    log：对数。其中basex|basey关键字指定对数的基</span></span><br><span class="line"><span class="string">    logit：以2为底的对数</span></span><br><span class="line"><span class="string">    symlog：对数，其中basex|basey关键字指定对数的基</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 你也可以通过下面2个方法，来设置对数坐标。一定要先添加数据后设置对数坐标。</span></span><br><span class="line">matplotlib.pyplot.xscale()</span><br><span class="line">matplotlib.pyplot.yscale()</span><br></pre></td></tr></table></figure><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面2个方法，可以创建一个极坐标的Axes。</span></span><br><span class="line"><span class="comment"># Figure.add_subplot(...)也是同样的设置</span></span><br><span class="line">Figure.add_axes((left,bottom,width,height),projection=<span class="string">&#x27;polar&#x27;</span>)</span><br><span class="line">Figure.add_axes((left,bottom,width,height), polar=<span class="literal">True</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">projection: 不仅可以设置极坐标，还可以设置自定义坐标（它将坐标统一为映射关系）。</span></span><br><span class="line"><span class="string">polar: 为了兼容旧代码，新代码推荐用projection关键字</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="箭头注释"><a href="#箭头注释" class="headerlink" title="箭头注释"></a>箭头注释</h2><p>虽然有一个<code>plt.arrow()</code>函数可以实现这个功能，但是我不推荐使用它，因为它创建出的箭头是 SVG 向量图对象，会随着图形分辨率的变化而改变，最终的结果可能完全不是用户想要的。我要推荐的是<code>plt.annotate()</code>函数。这个函数既可以创建文字，也可以创建箭头，而且它创建的箭头能够进行非常灵活的配置。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">20</span>, <span class="number">1000</span>)</span><br><span class="line">ax.plot(x, np.cos(x))</span><br><span class="line">ax.axis(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line">ax.annotate(<span class="string">&#x27;local maximum&#x27;</span>, xy=(<span class="number">6.28</span>, <span class="number">1</span>), xytext=(<span class="number">10</span>, <span class="number">4</span>), arrowprops=<span class="built_in">dict</span>(facecolor=<span class="string">&#x27;black&#x27;</span>, shrink=<span class="number">0.05</span>))</span><br><span class="line">ax.annotate(<span class="string">&#x27;local minimum&#x27;</span>, xy=(<span class="number">5</span> * np.pi, <span class="number">-1</span>), xytext=(<span class="number">2</span>, <span class="number">-6</span>), arrowprops=<span class="built_in">dict</span>(arrowstyle=<span class="string">&quot;-&gt;&quot;</span>,</span><br><span class="line">             connectionstyle=<span class="string">&quot;angle3,angleA=0,angleB=-90&quot;</span>))</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/Q6W3yDgvTPrEOV7.jpg" alt="箭头注释.jpg"></p>
<h2 id="自定义坐标轴刻度"><a href="#自定义坐标轴刻度" class="headerlink" title="自定义坐标轴刻度"></a>自定义坐标轴刻度</h2><p>虽然 Matplotlib 默认的坐标轴定位器（locator）与格式生成器（formatter）可以满足大部分需求，但是并非对每一幅图都合适。通过其他的定位器和格式器，可以将坐标轴刻度调整为你需要的位置与格式。</p>
<p>常用的定位器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NullLocator         无刻度</span><br><span class="line">FixedLocator        刻度位置固定</span><br><span class="line">IndexLocator        用索引作为定位器（如 x &#x3D; range(len(y)) ）</span><br><span class="line">LinearLocator       从 min 到 max 均匀分布刻度</span><br><span class="line">LogLocator          从 min 到 max 按对数分布刻度</span><br><span class="line">MultipleLocator     刻度和范围都是基数（base）的倍数</span><br><span class="line">MaxNLocator         为最大刻度找到最优位置</span><br><span class="line">AutoLocator        （默认）以 MaxNLocator 进行简单配置</span><br><span class="line">AutoMinorLocator    次要刻度的定位器</span><br></pre></td></tr></table></figure><br>常用的和格式器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NullFormatter         刻度上无标签</span><br><span class="line">IndexFormatter        将一组标签设置为字符串</span><br><span class="line">FixedFormatter        手动为刻度设置标签</span><br><span class="line">FuncFormatter         用自定义函数设置标签</span><br><span class="line">FormatStrFormatter    为每个刻度值设置字符串格式</span><br><span class="line">ScalarFormatter       （默认）为标量值设置标签</span><br><span class="line">LogFormatter          对数坐标轴的默认格式生成器</span><br></pre></td></tr></table></figure></p>
<p>figure 对象，它其实就是一个盛放图形元素（子对象）的容器，例如每个 figure 都会包含一个或多个 axes 对象，每个 axes 对象又会包含其他表示图形内容的对象。坐标轴刻度线也不例外，每个 axes 都有 xaxis 和 yaxis 属性，每个属性同样包含构成坐标轴的线条、刻度和标签的全部属性。</p>
<p>每一个坐标轴都有<strong>主要</strong>刻度线与<strong>次要</strong>刻度线。<br>在Matplotlib中，默认的刻度是由locator类控制，其中子类MultipleLocator和FormatStrFormatter负责位置和标签。</p>
<p>使用MultipleLocator自定义刻度位置，通过<code>set_xxx_locator()</code>设置：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> MultipleLocator, FormatStrFormatter</span><br><span class="line">plt.figure(figsize=(<span class="number">7</span>,<span class="number">6</span>),dpi=<span class="number">100</span>)</span><br><span class="line">ax = plt.gca()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置x，y轴上下限</span></span><br><span class="line">ax.set_xlim(<span class="number">0</span>,<span class="number">5</span>)</span><br><span class="line">ax.set_ylim(<span class="number">0</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置x，y轴的主刻度器</span></span><br><span class="line"><span class="comment"># 隐藏刻度：plt.NullLocator()</span></span><br><span class="line">ax.xaxis.set_major_locator(MultipleLocator(<span class="number">1</span>))</span><br><span class="line">ax.yaxis.set_major_locator(MultipleLocator(<span class="number">1</span>))</span><br><span class="line"><span class="comment"># 设置x，y轴次刻度器</span></span><br><span class="line">ax.xaxis.set_minor_locator(MultipleLocator(<span class="number">0.25</span>))</span><br><span class="line">ax.yaxis.set_minor_locator(MultipleLocator(<span class="number">0.25</span>))</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/tyD9weG5VZh2RmP.jpg" alt=""></p>
<p>通过FormatStrFormatter自定义刻度标签，通过<code>set_xxx_formatter()</code>设置：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置x轴主刻度标签格式</span></span><br><span class="line"><span class="comment"># 隐藏标签：plt.NullFormatter() </span></span><br><span class="line">ax.xaxis.set_major_formatter(plt.NullFormatter()) <span class="comment"># 主刻度隐藏，避免和次刻度标签重复显示</span></span><br><span class="line"><span class="comment"># 设置x，y轴次刻度标签格式</span></span><br><span class="line">ax.xaxis.set_minor_formatter(FormatStrFormatter(<span class="string">&#x27;%0.1f&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主次刻度线，标签长度</span></span><br><span class="line">ax.tick_params(which=<span class="string">&#x27;major&#x27;</span>,length=<span class="number">8</span>,labelsize=<span class="number">10</span>)</span><br><span class="line">ax.tick_params(which=<span class="string">&#x27;minor&#x27;</span>,length=<span class="number">4</span>)</span><br></pre></td></tr></table></figure><br>必要时，可以用<code>plt.NullFormatter()</code>隐藏刻度。<br>为了显示效果，用<code>tick_params()</code>设置了刻度长度和标签大小。<br><img src="https://i.loli.net/2021/05/25/7PHlOintrv6KfGI.jpg" alt=""></p>
<p>还可以用<code>set_major_locator(plt.MaxNLocator(3))</code>设置刻度显示数量（这里是3），Matplotlib 会自动为刻度安排恰当的位置。<br>还可以用<code>set_major_formatter(plt.FuncFormatter(format_func))</code>自定义标签格式。比如正弦余弦曲线刻度用$\pi$效果更改好：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 画正弦曲线和余弦曲线</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">3</span> * np.pi, <span class="number">1000</span>)</span><br><span class="line">ax.plot(x, np.sin(x), lw=<span class="number">3</span>, label=<span class="string">&#x27;Sine&#x27;</span>)</span><br><span class="line">ax.plot(x, np.cos(x), lw=<span class="number">3</span>, label=<span class="string">&#x27;Cosine&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置网格、图例和坐标轴上下限</span></span><br><span class="line">ax.grid(<span class="literal">True</span>)</span><br><span class="line">ax.legend(frameon=<span class="literal">False</span>)</span><br><span class="line">ax.axis(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line">ax.set_xlim(<span class="number">0</span>, <span class="number">3</span> * np.pi)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_func</span>(<span class="params">value, tick_number</span>):</span></span><br><span class="line">    <span class="comment"># 找到π/2的倍数刻度</span></span><br><span class="line">    N = <span class="built_in">int</span>(np.<span class="built_in">round</span>(<span class="number">2</span> * value / np.pi))</span><br><span class="line">    <span class="keyword">if</span> N == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;0&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> N == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">r&quot;$\pi/2$&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> N == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">r&quot;$\pi$&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> N % <span class="number">2</span> &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">r&quot;$&#123;0&#125;\pi/2$&quot;</span>.<span class="built_in">format</span>(N)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">r&quot;$&#123;0&#125;\pi$&quot;</span>.<span class="built_in">format</span>(N // <span class="number">2</span>)</span><br><span class="line">ax.xaxis.set_major_formatter(plt.FuncFormatter(format_func))</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/styFqfZB8VRTdKW.jpg" alt=""></p>
<h2 id="3D绘图"><a href="#3D绘图" class="headerlink" title="3D绘图"></a>3D绘图</h2><p>3D绘图与2D绘图的调用方法几乎相同，除了增加一个 <code>projection=&#39;3d&#39;</code> 的关键字参数，<strong>使用projection参数，必须导入mplot3d模块</strong>。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits <span class="keyword">import</span> mplot3d</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment"># 旧式写法</span></span><br><span class="line">ax = plt.axes(projection=<span class="string">&#x27;3d&#x27;</span>) </span><br><span class="line"><span class="comment"># 新式写法</span></span><br><span class="line">ax = Axes3D(fig) </span><br></pre></td></tr></table></figure><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Axes3D.plot(xs, ys, *args, **kwargs): 绘制直线。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xs,ys：点的 x,y坐标</span></span><br><span class="line"><span class="string">zs：点的z坐标。该值可以是一个标量（表示对所有点都取同一个值）；也可以是个数组或列表，表示每个点一个值</span></span><br><span class="line"><span class="string">zdir：指定那个是z轴。其值可以是&#x27;x&#x27;或者&#x27;y&#x27;或者&#x27;z&#x27;</span></span><br><span class="line"><span class="string">剩下的关键字参数与Axes.plot()相同</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">Axes3D.scatter(xs, ys, zs=<span class="number">0</span>, zdir=’z’, s=<span class="number">20</span>, c=’b’, </span><br><span class="line">                depthshade=<span class="literal">True</span>, *args, **kwargs)：绘制散点图。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xs,ys：点的 x,y坐标</span></span><br><span class="line"><span class="string">zs：点的z坐标。该值可以是一个标量（表示对所有点都取同一个值）；也可以是个数组或列表，表示每个点一个值</span></span><br><span class="line"><span class="string">zdir：指定那个是z轴。其值可以是&#x27;x&#x27;或者&#x27;y&#x27;或者&#x27;z&#x27;</span></span><br><span class="line"><span class="string">s：散点的大小（单位为 point^2).该值可以是一个标量（表示对所有点都取同一个值）；也可以是个数组或列表，表示每个点一个值</span></span><br><span class="line"><span class="string">c：散点的颜色。你可以将它设为一个颜色字符串，表示所有的点都是一个颜色。或者是个 cmap，指定颜色图</span></span><br><span class="line"><span class="string">depthshade：一个布尔值。如果为True，则通过对marker设置阴影来展示层次关系</span></span><br><span class="line"><span class="string">剩下的关键字参数与Axes.scatter()相同</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">Axes3D.plot_wireframe(X, Y, Z, *args, **kwargs): 绘制线框。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">X,Y：点的 x,y坐标</span></span><br><span class="line"><span class="string">Z：点的z坐标。该值可以是一个标量（表示对所有点都取同一个值）；也可以是个数组或列表，表示每个点一个值</span></span><br><span class="line"><span class="string">rstride：行的步长</span></span><br><span class="line"><span class="string">cstride：列的步长</span></span><br><span class="line"><span class="string">剩下的关键字传递给LineCollection</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br><strong>1、三维点图和线图</strong><br>最基本的三维图是由<code>(x , y , z )</code>三维坐标点构成的线图与散点图。与二维图类似，可以用 <code>ax.plot3D</code> 与 <code>ax.scatter3D</code> 函数来创建它们。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib notebook</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment"># 创建三维坐标轴</span></span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># 三维线的数据</span></span><br><span class="line">zline = np.linspace(<span class="number">0</span>, <span class="number">15</span>, <span class="number">1000</span>)</span><br><span class="line">xline = np.sin(zline)</span><br><span class="line">yline = np.cos(zline)</span><br><span class="line">ax.plot3D(xline, yline, zline, <span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line"><span class="comment"># 三维散点的数据</span></span><br><span class="line">zdata = <span class="number">15</span> * np.random.random(<span class="number">100</span>)</span><br><span class="line">xdata = np.sin(zdata) + <span class="number">0.1</span> * np.random.randn(<span class="number">100</span>)</span><br><span class="line">ydata = np.cos(zdata) + <span class="number">0.1</span> * np.random.randn(<span class="number">100</span>)</span><br><span class="line">ax.scatter3D(xdata, ydata, zdata, c=zdata, cmap=<span class="string">&#x27;Greens&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/6FqUkXK1TSMtRaH.jpg" alt="三维点图和线图.jpg"><br>默认情况下，散点会自动改变透明度，以在平面上呈现出立体感。有时在静态图形上观察三维效果很费劲，通过交互视图就可以让所有数据点呈现出极佳的视觉效果。<br><strong>2、三维等高线图</strong><br>与二维 <code>ax.contour()</code> 图形一样，<code>ax.contour3D()</code>要求所有数据都是二维网格数据的形式，并且由函数计算 z 轴数值。<br>用三维正弦函数画的三维等高线图：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib notebook</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment"># 创建三维坐标轴</span></span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># 三维线的数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> np.sin(np.sqrt(x ** <span class="number">2</span> + y ** <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">-6</span>, <span class="number">6</span>, <span class="number">30</span>)</span><br><span class="line">y = np.linspace(<span class="number">-6</span>, <span class="number">6</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">X, Y = np.meshgrid(x, y)</span><br><span class="line">Z = f(X, Y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 三维等高线图</span></span><br><span class="line">ax.contour3D(X, Y, Z, <span class="number">50</span>, cmap=<span class="string">&#x27;binary&#x27;</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">&#x27;z&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/k3TDlJqXHmtAdhf.jpg" alt="三维等高线图.jpg"></p>
<p><code>iew_init</code> 可以调整观察角度与方位角，比如把俯仰角调整为 60 度（这里的 60 度是 x-y 平面的旋转角度），方位角调整为 35 度（就是绕 z 轴顺时针旋转 35 度）：<code>ax.view_init(60, 35)</code>。<br><strong>3、线框图和曲面图</strong><br>它们都是将网格数据映射成三维曲面，比如线框图：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib notebook</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment"># 创建三维坐标轴</span></span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># 三维线的数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> np.sin(np.sqrt(x ** <span class="number">2</span> + y ** <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">-6</span>, <span class="number">6</span>, <span class="number">30</span>)</span><br><span class="line">y = np.linspace(<span class="number">-6</span>, <span class="number">6</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">X, Y = np.meshgrid(x, y)</span><br><span class="line">Z = f(X, Y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 线框图</span></span><br><span class="line">ax.plot_wireframe(X, Y, Z, color=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;wireframe&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/d6NL94mRnUhCWuP.jpg" alt="三维线框图.jpg"><br>曲面图与线框图类似，只不过线框图的每个面都是由多边形构成的。只要增加一个配色方案来填充这些多边形，就可以让读者感受到可视化图形表面的拓扑结构了：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib notebook</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment"># 创建三维坐标轴</span></span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># 三维线的数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> np.sin(np.sqrt(x ** <span class="number">2</span> + y ** <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">-6</span>, <span class="number">6</span>, <span class="number">30</span>)</span><br><span class="line">y = np.linspace(<span class="number">-6</span>, <span class="number">6</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">X, Y = np.meshgrid(x, y)</span><br><span class="line">Z = f(X, Y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 线框图</span></span><br><span class="line">ax.plot_surface(X, Y, Z, rstride=<span class="number">1</span>, cstride=<span class="number">1</span>, cmap=<span class="string">&#x27;viridis&#x27;</span>, edgecolor=<span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;surface&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/y4Q5rl8pV3UIWBm.jpg" alt="三维曲面图.jpg"></p>
<p>需要注意的是，画曲面图需要二维数据，但可以不是直角坐标系（也可以用极坐标）。<br>下面示例，创建了一个局部的极坐标网格，当我们把它画成 surface3D 图形时，可以获得一种使用了切片的可视化效果。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib notebook</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment"># 创建三维坐标轴</span></span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># 三维线的数据</span></span><br><span class="line">r = np.linspace(<span class="number">0</span>, <span class="number">6</span>, <span class="number">20</span>)</span><br><span class="line">theta = np.linspace(<span class="number">-0.9</span> * np.pi, <span class="number">0.8</span> * np.pi, <span class="number">40</span>)</span><br><span class="line"><span class="comment"># 极坐标网格</span></span><br><span class="line">r, theta = np.meshgrid(r, theta)</span><br><span class="line"></span><br><span class="line">X = r * np.sin(theta)</span><br><span class="line">Y = r * np.cos(theta)</span><br><span class="line">Z = f(X, Y)</span><br><span class="line"></span><br><span class="line">ax.plot_surface(X, Y, Z, rstride=<span class="number">1</span>, cstride=<span class="number">1</span>,cmap=<span class="string">&#x27;viridis&#x27;</span>, edgecolor=<span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;surface-polar&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/zYx1yXmSIWNktVw.jpg" alt="曲面图-极坐标.jpg"></p>
<p><strong>4、曲面三角剖分</strong><br>曲面图数据不是均匀且完整的，如何绘图呢？可以使用三角剖分图形：</p>
<p>先绘制一个散点图，看看数据分布：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib notebook</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment"># 创建三维坐标轴</span></span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># 三维线的数据</span></span><br><span class="line">theta = <span class="number">2</span> * np.pi * np.random.random(<span class="number">1000</span>)</span><br><span class="line">r = <span class="number">6</span> * np.random.random(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">x = np.ravel(r * np.sin(theta))</span><br><span class="line">y = np.ravel(r * np.cos(theta))</span><br><span class="line">z = f(x, y)</span><br><span class="line"></span><br><span class="line">ax.scatter(x, y, z, c=z, cmap=<span class="string">&#x27;viridis&#x27;</span>, linewidth=<span class="number">0.5</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;surface-scatter&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/23Nn8UQfxMpgrFK.jpg" alt="三维曲面散点图.jpg"></p>
<p>还有许多地方需要修补，这些工作可以由 <code>ax.plot_trisurf()</code> 函数帮助我们完成。它首先找到一组所有点都连接起来的三角形，然后用这些三角形创建曲面：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ax.plot_trisurf(x, y, z, cmap=<span class="string">&#x27;viridis&#x27;</span>, edgecolor=<span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;surface-trisurf&#x27;</span>)</span><br><span class="line">fig</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/K2OpVmW5Cs8ay4v.jpg" alt="三维曲面图三角切面.jpg"><br>虽然结果肯定没有之前用均匀网格画的图完美，但是这种三角剖分方法很灵活。</p>
<h2 id="其他技巧"><a href="#其他技巧" class="headerlink" title="其他技巧"></a>其他技巧</h2><p><strong>1、设置中文</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为了支持中文，在开头设置：</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]  <span class="comment">#matplotlib 中文字体</span></span><br></pre></td></tr></table></figure></p>
<p><strong>2、共享坐标轴</strong><br>当你通过<code>pyplot.subplot()</code>、<code>pyplot.axes()</code>函数或者<code>Figure.add_subplot()</code>、<code>Figure.add_axes()</code>方法创建一个Axes时，你可以通过sharex关键字参数传入另一个Axes表示共享X轴；或者通过sharey关键字参数传入另一个Axes表示共享Y轴。共享轴线时，当你缩放某个Axes时，另一个Axes也跟着缩放。</p>
<p><strong>3、创建多个subplot</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 旧式风格</span></span><br><span class="line">fig=plt.figure()</span><br><span class="line">ax1=fig.add_subplot(<span class="number">221</span>)</span><br><span class="line">ax2=fig.add_subplot(<span class="number">222</span>,sharex=ax1,sharey=ax1)</span><br><span class="line">ax3=fig.add_subplot(<span class="number">223</span>,sharex=ax1,sharey=ax1)</span><br><span class="line">ax4=fig.add_subplot(<span class="number">224</span>,sharex=ax1,sharey=ax1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新式风格的代码</span></span><br><span class="line">fig,((ax1,ax2),(ax3,ax4))=plt.subplots(<span class="number">2</span>,<span class="number">2</span>,sharex=<span class="literal">True</span>,sharey=<span class="literal">True</span>)</span><br><span class="line">ax1.plot(...)</span><br><span class="line">ax2.plot(...)</span><br><span class="line"><span class="comment"># 也可以直接用，不解包</span></span><br><span class="line">fig,axs=plt.subplots(<span class="number">2</span>,<span class="number">2</span>,sharex=<span class="literal">True</span>,sharey=<span class="literal">True</span>)</span><br><span class="line">ax1=axs[<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">ax2=axs[<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">ax3=axs[<span class="number">1</span>,<span class="number">0</span>]</span><br><span class="line">ax4=axs[<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 返回的axs是一个nrows*ncols的array，支持numpy的索引。</span></span><br></pre></td></tr></table></figure></p>
<p><strong>4、调整日期显示</strong><br>当x轴为时间日期时，有可能间隔太密集导致显示都叠加在一起。此时可以用<code>matplotlib.figure.Figure.autofmt_xdate()</code>函数来自动调整X轴日期的显式。</p>
<p>你也可以调整X轴的显示格式。当X轴为时间时，其显示由Axes.fmt_xdata属性来提供。该属性是一个函数对象或者函数，接受一个日期参数，返回该日期的显示字符串。<br>matplotlib已经提供了许多date formatter，你可以直接使用<code>ax.fmt_xdata=matplotlib.dates.DateFormatter(&#39;%Y-%m-%d&#39;)</code>。</p>
<p><strong>5、放置text box</strong><br>当你在Axes中放置text box时，你最好将它放置在axes coordinates下，这样当你调整X轴或者Y轴时，它能够自动调整位置。</p>
<p>你也可以使用Text的.bbox属性来让这个Text始终放在某个Patch中。其中.bbox是个字典，它存放的是该Patch实例的属性。</p>
<p><strong>6、Latex文字</strong><br>要想在文本中使用Latex，你需要使用<code>&#39;$...$&#39;</code>这种字符串（即使用<code>&#39;$&#39;</code>作为界定符）。通常建议使用raw字符串，即<code>r&#39;$...$&#39;</code>的格式，因为原生字符串不会转义’\’，从而使得大量的Latex词法能够正确解析。</p>
<p><strong>7、平移坐标轴：</strong><br>Axes.spines是个字典，它存放了四个键，分别为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Axes.spines[&#39;left],</span><br><span class="line">Axes.spines[&#39;right],</span><br><span class="line">Axes.spines[&#39;top],</span><br><span class="line">Axes.spines[&#39;bottom] </span><br></pre></td></tr></table></figure><br>他们都是一个matplotlib.spines.Spine对象，该对象继承自matplotlib.patches.Patch对象，主要是设置图形边界的边框。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Spine.set_color(<span class="string">&#x27;none&#x27;</span>)：不显示这条边线</span><br><span class="line">Spine.set_position((position))：将边线移动到指定坐标。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">position是一个二元元组，指定了 (position type,amount)，position type可以是：</span></span><br><span class="line"><span class="string">        outward：在绘图区域之外放置边线，离开绘图区域的距离由 amount指定（负值则在会去区域内绘制）</span></span><br><span class="line"><span class="string">        axes：在 Axes coordinate内放置边线（从 0.0 到 1.0 ）</span></span><br><span class="line"><span class="string">        data：在 data coordinate 内放置边线</span></span><br><span class="line"><span class="string">你也可以指定position为 ： &#x27;center&#x27;，等价于 (&#x27;axes&#x27;,0.5)；或者 &#x27;zero&#x27;，等价于 (&#x27;data&#x27;,0.0)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p><strong>8、清除</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过pyplot来清除绘图</span></span><br><span class="line">pyplot.cla()：清除current axis。非当前axis不受影响</span><br><span class="line">pyplot.clf()：清除current figure。但是它不关闭window</span><br><span class="line">pyplot.close()：关闭window</span><br><span class="line"><span class="comment"># 通过面向对象的方法清除绘图</span></span><br><span class="line">Figure.clf()：清除该Figure对象的所有内容。</span><br></pre></td></tr></table></figure><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 清除X坐标和Y坐标：</span></span><br><span class="line">Axes.set_xticks(())</span><br><span class="line">Axes.set_yticks(())</span><br><span class="line">Axes.set_axis_off() <span class="comment">#清除 tick 和边框</span></span><br></pre></td></tr></table></figure></p>
<h1 id="Matplotlib的主要API"><a href="#Matplotlib的主要API" class="headerlink" title="Matplotlib的主要API"></a>Matplotlib的主要API</h1><p>参考Matplotlib的<span class="exturl" data-url="aHR0cHM6Ly9tYXRwbG90bGliLm9yZy9zdGFibGUvYXBpL2luZGV4Lmh0bWwjdXNhZ2UtcGF0dGVybnM=">Modules<i class="fa fa-external-link-alt"></i></span>。</p>
<p>写这个主要是从上层了解Matplotlib绘图时使用的类和方法，其中Axes类全面列出了使用的绘图方法和参数详解。之后会分类使用这些方法。</p>
<h2 id="Artist"><a href="#Artist" class="headerlink" title="Artist"></a>Artist</h2><p>我们之前讲了Matplotlib的三层结构，那谁使用它们呢？就是Artist（艺术家）。</p>
<p>matplotlib的三个API：<br>（1）matplotlib.backend_bases.FigureCanvas：代表了一个绘图区，在这个绘图区上图表被绘制。<br>（2）matplotlib.backend_bases.Renderer：代表了渲染器，它知道如何在绘图区上绘图。<br>（2）matplotlib.artist.Artist：代表了图表组件，它知道如何利用渲染器在绘图区上绘图。<br>我们经常使用的是与matplotlib.artist.Artist类，它是高层次的绘图控制。</p>
<p>matplotlib中有两种Artist：<br>（1）primitive：代表了我们在绘图区域上绘制的基础的绘图组件，比如Line2D，Rectangle，Text 以及AxesImage等等。<br>（2）container：代表了放置primitive的那些绘图组件。比如Axis、Axes以及Figure。对应容器层。</p>
<div class="note info"><p><strong>matplotlib的标准使用流程为：</strong><br>（1）创建一个Figure实例对象fig。<br>（2）使用fig实例创建一个或者多个Axes实例，或者创建一个或者多个Subplot实例。<br>（3）使用Axes实例的方法来创建primitive。</p>
</div>
<p>每个在图形中出现的元素都是Artist。其属性有：<br>（1）Figure.patch属性：一个Rectangle，代表了图表的矩形框，它的大小就是图表的大小， 并且可以通过它设置图表的背景色和透明度。<br>（2）Axes.patch属性：一个Rectangle，代表了绘图坐标轴内部的矩形框（白底黑边）， 通过它可以设置Axes的颜色、透明度等。</p>
<p>所有的Artist有下列属性：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.alpha：透明度。值为0--1之间的浮点数</span><br><span class="line">.animated：一个布尔值，表示是否用于加速动画绘制</span><br><span class="line">.axes：返回这个Artist所属的axes，可能为None</span><br><span class="line">.clip_box：用于剪切Artist的bounding box</span><br><span class="line">.clip_on：是否开启clip</span><br><span class="line">.clip_path：Artist沿着该path执行clip</span><br><span class="line">.contains：一个picking function用于测试Artist是否包含pick point</span><br><span class="line">.figure：该Artist所属的Figure，可能为None</span><br><span class="line">.gid：该Artist的id字符串</span><br><span class="line">.label：一个text label</span><br><span class="line">.picker:一个python object用于控制object picking</span><br><span class="line">.transform：转换矩阵</span><br><span class="line">.url：一个url string，代表本Artist</span><br><span class="line">.visible：布尔值，控制Artist是否绘制</span><br><span class="line">.zorder：决定了Artist的绘制顺序。zorder越小就越底层，则越优先绘制。</span><br></pre></td></tr></table></figure><br>这些属性可以通过旧式的实例对象方法，setter和getter函数访问和设置。如figure对象：<code>fig.get_alpha()</code>，<code>fig.set_alpha(0.5)</code>、<code>fig.set(alpha=0.5,zorder=2)</code>（一次设置多个属性）。</p>
<p>或者使用<code>plt.getp(o,&quot;alpha&quot;)</code>来获取属性（一次只能返回一个属性），如果指定属性名，则返回对象的该属性值；如果不指定属性名，则返回对象的所有的属性和值。使用<code>plt.setp(o,alpha=0.5,zorder=2)</code>来设置属性（一次可以设置多个属性）。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取fig所有属性</span></span><br><span class="line"><span class="comment"># 下面两种方式等价</span></span><br><span class="line">mpl.artist.getp(fig)</span><br><span class="line">plt.getp(fig)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">agg_filter = None</span></span><br><span class="line"><span class="string">alpha = None</span></span><br><span class="line"><span class="string">animated = False</span></span><br><span class="line"><span class="string">axes = [&lt;matplotlib.axes._subplots.AxesSubplot object at ...</span></span><br><span class="line"><span class="string">children = [&lt;matplotlib.patches.Rectangle object at 0x0000019...</span></span><br><span class="line"><span class="string">clip_box = None</span></span><br><span class="line"><span class="string">clip_on = True</span></span><br><span class="line"><span class="string">clip_path = None</span></span><br><span class="line"><span class="string">constrained_layout = False</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Figure"><a href="#Figure" class="headerlink" title="Figure"></a>Figure</h2><p>matplotlib.figure.Figure是最顶层的container Artist，它包含了图表中的所有元素。它的属性有：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Figure.patch：Figure的背景矩形</span><br><span class="line">Figure.axes：持有的一个Axes实例的列表（包括Subplot)</span><br><span class="line">Figure.images：持有的一个FigureImages patch列表</span><br><span class="line">Figure.lines：持有一个Line2D实例的列表（很少使用）</span><br><span class="line">Figure.legends：持有的一个Figure Legend实例列表（不同于Axes.legends)</span><br><span class="line">Figure.patches：持有的一个Figure pathes实例列表（很少使用)</span><br><span class="line">Figure.texts：持有的Figure Text实例列表</span><br><span class="line">Figure.figsize：图像的尺寸，(w,h)，以英寸为单位</span><br><span class="line">Figure.dpi：图像分辨率</span><br><span class="line">Figure.facecolor：背景色</span><br><span class="line">Figure.edgecolor：edge color</span><br><span class="line">Figure.linewidth：edge linewidth</span><br><span class="line">Figure.frameon：如果为False，则不绘制图像</span><br><span class="line">Figure.subplotpars：一个SubplotParams实例</span><br><span class="line">Figure.tight_layout：如果为False，则使用subplotpars；否则使用tight_layout()调整subplot parameters</span><br></pre></td></tr></table></figure><br>当你执行<code>Figure.add_subplot()</code>或者<code>Figure.add_axes()</code>时，这些新建的Axes都被添加到Figure.axes列表中。</p>
<p>由于Figure维持了当前的axes，因此不要手动的从Figure.axes列表中添加删除元素，而是要通过<code>Figure.add_subplot()</code>、<code>Figure.add_axes()</code>来添加元素，通过<code>Figure.delaxes()</code>来删除元素。但是你可以迭代或者访问Figure.axes中的Axes实例，然后修改这个实例的属性。</p>
<p>可以通过<code>Figure.gca()</code>获取当前的axes，通过<code>Figure.sca()</code>设置当前的axes。</p>
<p>Figure也有它自己的text、line、patch、image。可通过add primitive（原始组件）语句直接添加。但是注意Figure默认的坐标系是以像素为单位，可能需要转换成figure坐标系：(0,0)表示左下点，(1,1)表示右上点。</p>
<p>创建Figure的方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">matplotlib.pyplot.figure(num=<span class="literal">None</span>, figsize=<span class="literal">None</span>, dpi=<span class="literal">None</span>, facecolor=<span class="literal">None</span>,</span><br><span class="line">    edgecolor=None, frameon=True, FigureClass=&lt;class &#x27;matplotlib.figure.Figure&#x27;&gt;, **kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">num：一个整数或者字符串。</span></span><br><span class="line"><span class="string">    若未提供，则创建一个新的figure。</span></span><br><span class="line"><span class="string">    如果给出了一个整数，而且某个现有的figure对象的number属性刚好等于这个整数：</span></span><br><span class="line"><span class="string">        则激活该figure并且返回该figure；否则创建一个新的figure</span></span><br><span class="line"><span class="string">    如果是个字符串，则创建一个新的figure，并且将window title设置为该字符串。</span></span><br><span class="line"><span class="string">figsize：一对整数的元组。给出了英寸为单位的高度和宽度。默认由rc的figure.figsize给出</span></span><br><span class="line"><span class="string">dpi：一个整数，给出figure的分辨率。默认由rc的figure.dpi给出</span></span><br><span class="line"><span class="string">facecolor：背景色。若未提供，则由rc的figure.facecolor给出</span></span><br><span class="line"><span class="string">edgecolor：border color。若未提供，则由rc的figure.edgecolor给出</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br>Figure的一些方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line">add_axes(*args, **kwargs)：创建一个坐标轴。</span><br><span class="line">如果已经存在同样位置同样参数的一个Axes，则返回该Axes，并将其设为current Axes。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">rect:一个元组，代表了(left,bottom,width,height)，它是第一个位置参数</span></span><br><span class="line"><span class="string">axisbg：一个color，背景色</span></span><br><span class="line"><span class="string">frameon：布尔值，是否display frame</span></span><br><span class="line"><span class="string">sharex：另一个Axes对象，与该Axes共享 xaxis</span></span><br><span class="line"><span class="string">sharey：另一个Axes对象，与该Axes共享 yaxis</span></span><br><span class="line"><span class="string">projection：坐标系类型。projection=&#x27;polar&#x27;也等价于polar=True</span></span><br><span class="line"><span class="string">aspect：一个数值，指定x和y轴每个单位的尺寸比例。也可以设定为字符串&#x27;equal&#x27;/&#x27;auto&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">如果你想在同样的一个rect创建两个Axes，那么你需要设置label参数。不同的Axes通过不同的label鉴别。</span></span><br><span class="line"><span class="string">如果你使用了`fig.delaxes()`从Figure中移除了ax，那么你可以通过`fig.add_exes(ax)`来将其放回。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">sca(a)：设置a为current axes并返回它。</span><br><span class="line">gca(**kwargs)：返回current axes。如果不存在则创建一个。</span><br><span class="line">delaxes(a)：从figure中移除axes。</span><br><span class="line"></span><br><span class="line">autofmt_xdate(bottom=<span class="number">0.2</span>, rotation=<span class="number">30</span>, ha=<span class="string">&#x27;right&#x27;</span>)：用于设置Date ticklabel的位置。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">bottom：设置距离subplot底部的位置。</span></span><br><span class="line"><span class="string">rotation：设置了xtick label的旋转角度。</span></span><br><span class="line"><span class="string">ha：设置xtick label的对其方式。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">该函数主要用于当xtick为日期，可能会重叠，因此可以旋转一个角度。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">suptitle(t, **kwargs):设置图像标题。t为标题字符串。关键字参数就是Text对象的参数：</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x：在图形坐标系中，标题的横坐标（范围 0～1）</span></span><br><span class="line"><span class="string">y：在图形坐标系中，标题的纵坐标（范围 0～1）</span></span><br><span class="line"><span class="string">horizontalalignment：标题水平对齐方式，默认为&#x27;center&#x27;</span></span><br><span class="line"><span class="string">verticalalignment：标题垂直对齐方式，默认为&#x27;top&#x27;</span></span><br><span class="line"><span class="string">fontsize：字体大小</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">text(x, y, s, *args, **kwargs)：添加文本。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x：在图形坐标系中，标题的横坐标（范围 0～1）</span></span><br><span class="line"><span class="string">y：在图形坐标系中，标题的纵坐标（范围 0～1）</span></span><br><span class="line"><span class="string">s：文本字符串</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">tight_layout(renderer=<span class="literal">None</span>, pad=<span class="number">1.08</span>, h_pad=<span class="literal">None</span>, w_pad=<span class="literal">None</span>, rect=<span class="literal">None</span>)：调整subplot的间距。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">pad：设定subplot和figure edge之间的距离。单位为font-size</span></span><br><span class="line"><span class="string">h_pad/w_pad：subplot之间的高距/宽距。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 子图，除了下面方法，还有plt.subplot()、plt.subplots()</span></span><br><span class="line">add_subplot(*args,**kwargs)：创建一个subplot。</span><br><span class="line">如果已经存在同样位置同样参数的一个subplot，则返回该subplot，并将其设为current Axes。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">nrows：行数</span></span><br><span class="line"><span class="string">nclos：列数，每个单元格是一个sub-axes。</span></span><br><span class="line"><span class="string">plot_number：子图的序列，从1开始，从左到右，从上到下顺序排列。最大为nrows*ncols。</span></span><br><span class="line"><span class="string">            当nrows,ncols,plot_number这三个数字都是个位数时，可以使用一个三位数代替，每位代表一个数。</span></span><br><span class="line"><span class="string">projection：坐标系类型。projection=&#x27;polar&#x27;也等价于polar=True</span></span><br><span class="line"><span class="string">axisbg：一个color，背景色</span></span><br><span class="line"><span class="string">frameon：布尔值，是否display frame</span></span><br><span class="line"><span class="string">sharex：另一个Axes对象，与该Axes共享 xaxis</span></span><br><span class="line"><span class="string">sharey：另一个Axes对象，与该Axes共享 yaxis</span></span><br><span class="line"><span class="string">projection：坐标系类型。projection=&#x27;polar&#x27;也等价于polar=True</span></span><br><span class="line"><span class="string">aspect：一个数值，指定x和y轴每个单位的尺寸比例。也可以设定为字符串&#x27;equal&#x27;/&#x27;auto&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">%matplotlib inline</span></span><br><span class="line"><span class="string">import matplotlib.pyplot as plt</span></span><br><span class="line"><span class="string">plt.style.use(&#x27;seaborn-white&#x27;)</span></span><br><span class="line"><span class="string">import numpy as np</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(1, 7):</span></span><br><span class="line"><span class="string">    plt.subplot(2, 3, i)</span></span><br><span class="line"><span class="string">    plt.text(0.5, 0.5, str((2, 3, i)), fontsize=18, ha=&#x27;center&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">subplots_adjust(left=<span class="literal">None</span>, bottom=<span class="literal">None</span>, right=<span class="literal">None</span>, top=<span class="literal">None</span>, wspace=<span class="literal">None</span>, hspace=<span class="literal">None</span>)：调整子图之间的间隔和位置。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">hspace 与 wspace 参数设置与图形高度与宽度一致的子图间距，数值以子图的尺寸为单位</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string"># 在本例中，间距是子图宽度与高度的40%</span></span><br><span class="line"><span class="string">fig = plt.figure()</span></span><br><span class="line"><span class="string">fig.subplots_adjust(hspace=0.4, wspace=0.4)</span></span><br><span class="line"><span class="string">for i in range(1, 7):</span></span><br><span class="line"><span class="string">    ax = fig.add_subplot(2, 3, i)</span></span><br><span class="line"><span class="string">    ax.text(0.5, 0.5, str((2, 3, i)), fontsize=18, ha=&#x27;center&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">colorbar(mappable, cax=<span class="literal">None</span>, ax=<span class="literal">None</span>, use_gridspec=<span class="literal">True</span>, **kw)：为mappable创建一个colorbar。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mapple：一个ScalarMapple实例。它可以是Image/ContourSet等等。</span></span><br><span class="line"><span class="string">cax：指定在哪个axes中绘制colorbar。也可以是None</span></span><br><span class="line"><span class="string">ax：如果cax为None，则一个或多个父轴将从中窃取用于新颜色条轴的空间。如果设置了cax，则此设置无效。</span></span><br><span class="line"><span class="string">use_gridspec：如果cax为None，则将创建一个新的cax作为Axes的实例。</span></span><br><span class="line"><span class="string">              如果ax是Subplot的实例，并且use_gridspec为True，则使用gridspec模块将cax创建为Subplot的实例。</span></span><br><span class="line"><span class="string">ticks: 一个序列，离散颜色分箱。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">plt.clim(min,max)：设置颜色条上下限。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">legend(handles, labels, *args, **kwargs)：创建图例。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">handles：是一个Lin2D/Patch等实例的一个序列</span></span><br><span class="line"><span class="string">labels：是个字符串序列，用于给上述实例添加图例说明</span></span><br><span class="line"><span class="string">loc：指定图例的位置。可以是字符串&#x27;best&#x27;/&#x27;upper right&#x27;/&#x27;upper left&#x27;</span></span><br><span class="line"><span class="string">    /&#x27;lower left&#x27;/&#x27;lower right&#x27;/&#x27;right&#x27;/&#x27;center left&#x27;/&#x27;center right&#x27;</span></span><br><span class="line"><span class="string">    /&#x27;lower center&#x27;/&#x27;upper center&#x27;/&#x27;center&#x27;。你也可以指定坐标(x,y)，其中(0,0)是左下角，(1,1)是右上角</span></span><br><span class="line"><span class="string">numpoint/scatterpoints：图例上每个图例线的点数</span></span><br><span class="line"><span class="string">fancybox：如果为True，图例的边框采用圆角矩形</span></span><br><span class="line"><span class="string">shadow：如果为True，图例添加背影</span></span><br><span class="line"><span class="string">ncol：列数</span></span><br><span class="line"><span class="string">title：图例的标题</span></span><br><span class="line"><span class="string">framealpha：一个浮点数，从0到 1，图例的透明度</span></span><br><span class="line"><span class="string">frameon：一个布尔值，如果为True，则绘制图例的背景框。否则不绘制。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">savefig(fname, dpi=<span class="literal">None</span>, facecolor=<span class="string">&#x27;w&#x27;</span>, edgecolor=<span class="string">&#x27;w&#x27;</span>,orientation=<span class="string">&#x27;portrait&#x27;</span>, </span><br><span class="line">        papertype=<span class="literal">None</span>, <span class="built_in">format</span>=<span class="literal">None</span>, transparent=<span class="literal">False</span>, bbox_inches=<span class="literal">None</span>, pad_inches=<span class="number">0.1</span>,frameon=<span class="literal">None</span>)：保存图像。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">fname：带路径的文件名。</span></span><br><span class="line"><span class="string">dpi：保存的分辨率。</span></span><br><span class="line"><span class="string">facecolor/edgecolor：figure rectangle的背景色和边线颜色</span></span><br><span class="line"><span class="string">orientation：可以为&#x27;landscape&#x27; | &#x27;portrait&#x27;</span></span><br><span class="line"><span class="string">format：图片格式。可以为&#x27;png&#x27;/&#x27;pdf&#x27;/&#x27;svg&#x27;/&#x27;eps&#x27;...</span></span><br><span class="line"><span class="string">transparent：如果为True，设置figure和axes背景透明（除非你设置了facecolor/edgecolor）</span></span><br><span class="line"><span class="string">frameon：如果为False，则图形背景透明</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 显示图像</span></span><br><span class="line">show(warn=<span class="literal">True</span>)：显示图像。如果warn=<span class="literal">True</span>，则开启警报。</span><br><span class="line"><span class="comment"># 获取/设置属性</span></span><br><span class="line">get_dpi()/get_edgecolor()/get_facecolor()...：获取对应的属性值。</span><br><span class="line">get_children()：获取figure中包含的artists。</span><br><span class="line">get_size_inches()：返回fig的当前尺寸（单位为英寸。<span class="number">1</span><span class="keyword">in</span>=<span class="number">2.54</span>cm）</span><br><span class="line"></span><br><span class="line">set_dpi()/set_edgecolor()...：设置相关属性。</span><br><span class="line"><span class="comment"># 清除fig</span></span><br><span class="line">clear()：清除一个figure。</span><br><span class="line">clf(keep_observers=<span class="literal">False</span>)：清除一个figure。如果keep_observers=<span class="literal">True</span>，则gui仍然会跟踪figure中的axes。</span><br></pre></td></tr></table></figure></p>
<h2 id="Axes"><a href="#Axes" class="headerlink" title="Axes"></a>Axes</h2><p>Axes类是matplotlib的核心，大多数时间都是在与它打交道。Axes代表了绘图区。大量的用于绘图的Artist存放在它内部，并且它有许多辅助方法来创建和添加Artist给它自己，而且它也有许多赋值方法来访问和修改这些Artist。</p>
<p>它有许多方法用于绘图，如<code>.plot()</code>、<code>.text()</code>、<code>.hist()</code>、<code>.imshow()</code>等方法用于创建大多数常见的primitive(如Line2D，Rectangle，Text，Image等等）。这些方法会创建primitive Artist实例，并且添加这些实例到对应的container上去，然后必要的时候会绘制这些图形。</p>
<p>例如，Subplot就是一个特殊的Axes，其实例是位于网格中某个区域的Subplot实例。其实你也可以在任意区域创建Axes，通过<code>Figure.add_axes([left,bottom,width,height])</code>来创建一个任意区域的Axes，其中left,bottom,width,height都是<code>[0,1]</code>之间的浮点数，他们代表了相对于Figure的坐标。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib notebook <span class="comment"># 使用交互式能显示整体Figure和Axes</span></span><br><span class="line"></span><br><span class="line">fig = plt.figure() <span class="comment"># 创建图形</span></span><br><span class="line">ax = fig.add_axes([<span class="number">0.15</span>,<span class="number">0.1</span>,<span class="number">0.7</span>,<span class="number">0.3</span>]) <span class="comment"># 绘图区坐标</span></span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">0.0</span>,<span class="number">1.0</span>,<span class="number">0.01</span>)</span><br><span class="line">ax.plot(x, np.sin(<span class="number">2</span>*np.pi*x))</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/21/vHaJ7ncBWPmtf31.jpg" alt=""><br>Axes包含了一个<code>.patch</code>属性，对于笛卡尔坐标系而言，它是一个Rectangle；对于极坐标而言，它是一个Circle。这个<code>.patch</code>属性决定了plotting region的形状、背景和边框。</p>
<p>当调用<code>Axes.plot()</code>方法时，该方法会创建一个matplotlib.lines.Line2D实例，然后会利用传给<code>.plot()</code>的关键字参数来更新该Line2D的属性，然后将这个Line2D添加到Axes.lines列表中。该方法返回的刚创建的Line2D列表，因为你可以传递多个<code>(x,y)</code>值从而创建多个Line2D。同理，当调用<code>Axes.hist()</code>方法时，类似于<code>.plot()</code>方法，不过它会添加patches到Axes.patches列表。<br><div class="note info"><p>不应该直接对Axes.lines和Axes.patches列表操作来添加图表。因为当你通过.plot()和.hist()等方法添加图表时，matplotlib会做许多工作而不仅仅是添加绘图组件到Axes.lines或者Axes.patches列表中。你可以使用Axes的辅助方法.add_line()和.add_patch()方法来添加。</p>
</div></p>
<p>下面是Axes用于创建primitive Artist以及添加他们到相应的container中的方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ax.annotate()：创建text annotation（Annotate对象），然后添加到ax.texts列表中。</span><br><span class="line">ax.bar()：创建bar chart（Rectangle对象），然后添加到ax.patches列表中。</span><br><span class="line">ax.errorbar()：创建error bar plot（Line2D对象和Rectangle对象），然后添加到ax.lines列表中和ax.patches列表中。</span><br><span class="line">ax.fill()：创建shared area（Polygon对象），然后添加到ax.patches列表中</span><br><span class="line">ax.hist()：创建histogram（Rectangle对象），然后添加到ax.patches列表中。</span><br><span class="line">ax.imshow()：创建image data（AxesImage对象），然后添加到ax.images列表中。</span><br><span class="line">ax.legend()：创建axes legends（Legend对象），然后添加到ax.legends列表中。</span><br><span class="line">ax.plot()：创建xy plot（Line2D对象），然后添加到ax.lines列表中。</span><br><span class="line">ax.scatter()：创建scatter charts（PolygonCollection对象），然后添加到ax.collections列表中。</span><br><span class="line">ax.text()：创建text（Text对象），然后添加到ax.texts列表中。</span><br></pre></td></tr></table></figure><br>另外Axes还包含两个最重要的Artist container：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ax.xaxis：XAxis对象的实例，用于处理x轴tick以及label的绘制</span><br><span class="line">ax.yaxis：YAxis对象的实例，用于处理y轴tick以及label的绘制</span><br></pre></td></tr></table></figure><br>Axes包含了许多辅助方法来访问和修改XAxis和YAxis，这些辅助方法其实内部调用的是XAxis和YAxis的方法。因此通常情况下不需要直接调用XAxis和YAxis的方法。只需要知道更改x轴和y轴的tick和label的方法，都是对XAxis和YAxis的操作的。</p>
<p>Axes 的一些方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br></pre></td><td class="code"><pre><span class="line">cla()/clear()：清除Axes</span><br><span class="line">remove()：从figure中移除本axes。除非重绘figure，否则看不出来效果。</span><br><span class="line"></span><br><span class="line">acorr(x, **kwargs)：绘制序列x的自相关。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x：一个标量序列。对x执行自相关</span></span><br><span class="line"><span class="string">normed：一个布尔值，如果为True，则对数据正则化处理</span></span><br><span class="line"><span class="string">maxlags：一个整数，默认为10.它给出了要展示多少个lag。如果为None，则使用所有的2*len(x)-1个</span></span><br><span class="line"><span class="string">其他kwargs：控制了Line2D的属性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">返回：(lags,c,lin,b)</span></span><br><span class="line"><span class="string">lags：是一个长度为2*maxlags+的lag vector</span></span><br><span class="line"><span class="string">c：是长度为2*maxlags+的自相关向量</span></span><br><span class="line"><span class="string">line：是一个Line2D实例</span></span><br><span class="line"><span class="string">b：是x-axis</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">add_artist(a)：添加a（一个Artist对象）到axes上</span><br><span class="line">add_collection(collection, autolim=<span class="literal">True</span>)：添加Collection实例到axes上</span><br><span class="line">add_container(container)：添加Container实例到axes上</span><br><span class="line">add_image(image)：添加Image实例到axes上</span><br><span class="line">add_line(line)：添加Line2D实例到axes上</span><br><span class="line">add_patch(p)：添加Patch实例到axes上</span><br><span class="line">add_table(tab)：添加Table实例到axes上</span><br><span class="line"></span><br><span class="line">annotate(*args, **kwargs)：对坐标点(x,y)绘制注解。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">s：注解字符串</span></span><br><span class="line"><span class="string">xy：一个长度为2的序列，给出了坐标点的(x,y)坐标</span></span><br><span class="line"><span class="string">xytext：一个长度为2的序列，给出了注解字符串的(x,y)坐标</span></span><br><span class="line"><span class="string">xycoords：给出了坐标点的(x,y)所对应的坐标系。可以为&#x27;figure points&#x27;、 &#x27;figure pixels&#x27;、&#x27;figure fraction&#x27;、</span></span><br><span class="line"><span class="string">        &#x27;axes points&#x27;、 &#x27;axes pixels&#x27;、&#x27;axes fraction&#x27;、&#x27;data&#x27;。</span></span><br><span class="line"><span class="string">         figure表示Figure坐标系，axes表示Axes坐标系，data表示被注解的点所在的数据坐标系。</span></span><br><span class="line"><span class="string">         points表示单位为点（分辨率的点）；pixels表示单位为像素，fraction表示：(0,0) 为左下角，(1,1) 为右上角</span></span><br><span class="line"><span class="string">textcoords：给出了注解字符串的(x,y)所对应的坐标系。可以为xycoords允许的值之外，还可以为：</span></span><br><span class="line"><span class="string">        &#x27;offset points&#x27;：偏移被注解的坐标点的距离为 (x,y)个点（分辨率的点）</span></span><br><span class="line"><span class="string">        &#x27;offset pixels&#x27;：偏移被注解的坐标点的距离为 (x,y)个像素</span></span><br><span class="line"><span class="string">arrowprops：一个字典，给出了箭头的类型。</span></span><br><span class="line"><span class="string">        若字典不包含arrowstyle，则可以使用下面的键： width/headwidth/headlength/shrink以及其他的FancyArrowPatch的属性。</span></span><br><span class="line"><span class="string">        如果字典包含了arrowstyle，则上面的这些键将被屏蔽。arrowstyle的值可以为：</span></span><br><span class="line"><span class="string">            &#x27;-&#x27;、&#x27;-&gt;&#x27;、&#x27;-[&#x27;、&#x27;|-|&#x27;、&#x27;-|&gt;&#x27;、&#x27;&lt;-&#x27;、&#x27;&lt;-&gt;&#x27;、</span></span><br><span class="line"><span class="string">            &#x27;&lt;|-&#x27;、&#x27;&lt;|-|&gt;&#x27;、&#x27;fancy&#x27;、&#x27;simple&#x27;、&#x27;wedge&#x27;</span></span><br><span class="line"><span class="string">annotation_clip：一个布尔值。如果为True，则超出axes的部分将会不可见</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">autoscale_view(tight=<span class="literal">None</span>, scalex=<span class="literal">True</span>, scaley=<span class="literal">True</span>)：自动调整坐标轴的范围。</span><br><span class="line">                                                      如果你不想自动调整x轴，则scalex=<span class="literal">False</span>即可。y轴类似。</span><br><span class="line">arrow(x, y, dx, dy, **kwargs)：绘制箭头。箭头起点为 (x,y)，终点为 (x+dx,y+dy)。你也可以使用annotate()来模拟本方法。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x,y：箭头起点坐标（data坐标系）</span></span><br><span class="line"><span class="string">dxx,dy：箭头终点坐标为 (x+dx,y+dy)（data坐标系）</span></span><br><span class="line"><span class="string">width：箭头宽度</span></span><br><span class="line"><span class="string">length_includes_head:：如果为True，则箭头的头部也算在箭头长度内</span></span><br><span class="line"><span class="string">head_width：箭头的头部宽度</span></span><br><span class="line"><span class="string">head_length：箭头的头部长度 </span></span><br><span class="line"><span class="string">shape：可以为&#x27;full&#x27;/&#x27;left&#x27;/&#x27;right&#x27;。确定是绘制左半边/右半边还是全部画出</span></span><br><span class="line"><span class="string">其他参数控制了Patch的属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">axhline(y=<span class="number">0</span>, xmin=<span class="number">0</span>, xmax=<span class="number">1</span>, **kwargs)：绘制水平线。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">y：一个标量，默认为 0.给出了水平的 y坐标（采用data坐标系）</span></span><br><span class="line"><span class="string">xmin：一个标量，默认为 0。给出了水平线的起始横坐标。最大为 1（表示最右侧）（使用Axes坐标系）</span></span><br><span class="line"><span class="string">xmax：一个标量，默认为 1。 给出了水平线的终点横坐标。最小为 0 （表示最左侧）（使用Axes坐标系）</span></span><br><span class="line"><span class="string">其他关键字参数控制Line2D的属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">axhspan(ymin, ymax, xmin=<span class="number">0</span>, xmax=<span class="number">1</span>, **kwargs)：绘制水平区域。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ymin/ymax：给出了水平区域的y坐标的下界和上界，采用data坐标系</span></span><br><span class="line"><span class="string">xmin/xmax：给出了水平区域的左侧和右侧的位置。采用Axes坐标系，最小为0，最大为 1</span></span><br><span class="line"><span class="string">其他关键字参数控制Line2D的属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">axis(*v, **kwargs)：设置axis属性，它返回的是(xmin,xmax,ymin,ymax)。data坐标系下每个轴的最小值、最大值。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">v： Axis data limits set from a float list。也可以是字符串：</span></span><br><span class="line"><span class="string">    &#x27;on&#x27;：切换新轴线，有标签</span></span><br><span class="line"><span class="string">    &#x27;off&#x27;：切换新轴线，无标签</span></span><br><span class="line"><span class="string">    &#x27;equal&#x27;：根据设置的限制，平等缩放</span></span><br><span class="line"><span class="string">    &#x27;tight&#x27;：限制允许内，显示所有数据</span></span><br><span class="line"><span class="string">    &#x27;auto&#x27;：自动缩放</span></span><br><span class="line"><span class="string">xmin/ymin/ymax/ymax：待设置的轴的最小/最大值</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">axvline(x=<span class="number">0</span>, ymin=<span class="number">0</span>, ymax=<span class="number">1</span>, **kwargs)：绘制垂直线。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x：一个标量，默认为 0.给出了垂直线的 x坐标（采用data坐标系）</span></span><br><span class="line"><span class="string">ymin：一个标量，默认为 0。给出了垂直线的起始纵坐标。最大为 1（表示最上侧）（使用Axes坐标系）</span></span><br><span class="line"><span class="string">ymax：一个标量，默认为 1。 给出了垂直线的终点纵坐标。最小为 0 （表示最下侧）（使用Axes坐标系）</span></span><br><span class="line"><span class="string">其他关键字参数控制Line2D的属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">axvspan(xmin, xmax, ymin=<span class="number">0</span>, ymax=<span class="number">1</span>, **kwargs)：绘制垂直区域。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xmin/xmax：给出了垂直区域的x坐标的左侧和右侧，采用data坐标系</span></span><br><span class="line"><span class="string">ymin/ymax：给出了垂直区域的上侧和下侧的位置。采用Axes坐标系，最小为0，最大为 1</span></span><br><span class="line"><span class="string">其他关键字参数控制Line2D的属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">clabel(CS, *args, **kwargs)：为等高线添加label。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">CS：由contour函数返回的ContourSet，代表一组等高线</span></span><br><span class="line"><span class="string">fontsize：label的字体大小，或者给出字符串&#x27;smaller&#x27;/&#x27;x-large&#x27;</span></span><br><span class="line"><span class="string">colors：如果为None，则使用对应的等高线的颜色。</span></span><br><span class="line"><span class="string">        如果为一个字符串指定的颜色，则所有的等高线label使用该颜色。</span></span><br><span class="line"><span class="string">        如果为一组颜色，则不同的等高线的label按顺序使用其中的不同的颜色。</span></span><br><span class="line"><span class="string">inline：一个布尔值。如果为True，则移除label覆盖的底层的等高线（嵌入式）；否则就全部绘制（重叠式）</span></span><br><span class="line"><span class="string">inline_spacing:一个浮点数，单位为像素点。它控制了label距离等高线的距离</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">findobj(match=<span class="literal">None</span>, include_self=<span class="literal">True</span>)：筛选出合适的artist对象，返回一个列表。他会递归的向下搜寻</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">match指定过滤器：</span></span><br><span class="line"><span class="string">    如果为None，则它选出axes包含的所有artist</span></span><br><span class="line"><span class="string">    如果为一个函数，则函数接受一个artist参数，返回布尔值。所有返回True的artist被选中</span></span><br><span class="line"><span class="string">    如果是一个类，则返回属于该类的artist</span></span><br><span class="line"><span class="string">include_self：如果为True，则也检查自己</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">get_xx函数：返回对应的属性值。</span><br><span class="line">    get_alpha()/get_anchor()/get_animated()...</span><br><span class="line"></span><br><span class="line">grid(b=<span class="literal">None</span>, which=<span class="string">&#x27;major&#x27;</span>, axis=<span class="string">&#x27;both&#x27;</span>, **kwargs)：开启关闭网格。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b：布尔值，指定你想开启(True)还是关闭网格</span></span><br><span class="line"><span class="string">which：可以为&#x27;major&#x27;/&#x27;minor&#x27;/&#x27;both&#x27;，指定你想开启哪个级别的网格</span></span><br><span class="line"><span class="string">axis：可以为&#x27;x&#x27;/&#x27;y&#x27;/&#x27;both&#x27;，指定你想在那个轴上开启网格</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其他的关键字参数设定了网格的线条类型。如color/linestype/linewidth</span></span><br><span class="line"><span class="string">还有一种简单用法，就是axes.grid()，此时表示：如果网格开启，则关闭。如果网格关闭，则开启。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">locator_params(axis=<span class="string">&#x27;both&#x27;</span>, tight=<span class="literal">None</span>, **kwargs)：控制tick locator</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">axis：一个字符串，指定控制那个轴。可以为&#x27;x&#x27;/&#x27;y&#x27;/&#x27;both&#x27;。</span></span><br><span class="line"><span class="string">tight：一个布尔值。它传递给autoscale_view()</span></span><br><span class="line"><span class="string">其他关键字参数传递给set_params()方法</span></span><br><span class="line"><span class="string">如果你想调整主轴上的刻度线的数量，可以使用ax.locator_params(tight=True,nbins=4)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">loglog(*args, **kwargs)：绘制line，但是将x轴和y轴都调整为对数坐标</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x：数据的x坐标</span></span><br><span class="line"><span class="string">y：数据的y坐标</span></span><br><span class="line"><span class="string">basex/basey：一个大于 1 的标量，控制对数的底数</span></span><br><span class="line"><span class="string">subsx/subsy：一个序列，给出了x/y轴的子刻度的位置（数据坐标系）。默认为None，此时子刻度是自动划分的</span></span><br><span class="line"><span class="string">nonposx/nonposy：</span></span><br><span class="line"><span class="string">               如果为&#x27;mask&#x27;，则x/y的负数或者零将被视作无效的数；</span></span><br><span class="line"><span class="string">               如果为&#x27;clip&#x27;，则x/y的负数或者零将被视作一个非常小的正数（因为对数的自变量要大于零）</span></span><br><span class="line"><span class="string">剩下的参数将被作为Line2D的属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">margins(*args, **kw)：设置Axes的margin。</span><br><span class="line">                      你可以通过ax.margins()获取当前的margin。</span><br><span class="line">                      你也可以通过ax.margins(x=xmargin,y=ymargin)来设置margin。这两个参数的值是 <span class="number">0</span>～<span class="number">1</span></span><br><span class="line"></span><br><span class="line">minorticks_off()：关闭次刻度线。minorticks_on()：打开次刻度线。</span><br><span class="line"></span><br><span class="line">pcolor(*args, **kwargs)：绘制一个pseudocolor plot，返回一个Collection实例。</span><br><span class="line">                         对于大型数组，它很慢，此时推荐使用pcolormesh()。常用的方式为：</span><br><span class="line">pcolor(C,*kwargs)，此时C为一个二维数组。也可以指定pcolor(X,Y,C,*kwargs)。</span><br><span class="line">    X/Y/C都是二维数组，并且X和Y的尺寸比C大。它将在四个点决定的矩形中填充颜色:</span><br><span class="line">        C[i,j]： (X[i, j], Y[i, j])，(X[i, j+<span class="number">1</span>], Y[i, j+<span class="number">1</span>])， </span><br><span class="line">        (X[i+<span class="number">1</span>, j], Y[i+<span class="number">1</span>, j])，(X[i+<span class="number">1</span>, j+<span class="number">1</span>], Y[i+<span class="number">1</span>, j+<span class="number">1</span>])。X/Y也可以是一维的，但是首先会进行广播法则。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">cmap：一个Colormap实例。如果为None，则使用rc的设置</span></span><br><span class="line"><span class="string">edgecolors：None或者&#x27;none&#x27;或者一个颜色或者一个颜色序列。用于设定边的颜色</span></span><br><span class="line"><span class="string">其他参数设置PopyCollection属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">pcolorfast(*args, **kwargs)：用法和pcolor相同，它是一个实验性质的，提供了一个更快的实现。</span><br><span class="line"></span><br><span class="line">pcolormesh(*args, **kwargs)：作用和pcolor相同。</span><br><span class="line">                             但是它是另一个实现方式，并且返回不同的对象，它返回的是QuadMesh对象。</span><br><span class="line">                             它的速度更快。其参数和用法与pcolor相同。</span><br><span class="line"></span><br><span class="line">edgecolors：除了pcolor的edgecolors之外，还多了一个<span class="string">&#x27;face&#x27;</span>，表示使用与四边形背景色相同的颜色。</span><br><span class="line"></span><br><span class="line">ax.xaxis.set_major_locator(MonthLocator())：设置x轴的主刻度的locator。常见的一些DateLocator有：</span><br><span class="line">                                            MinuteLocator、HourLocator、DayLocator、 WeekdayLocator、</span><br><span class="line">                                           MonthLocator、YearLocator、AutoDateLocator </span><br><span class="line">ax.xaxis.set_major_formatter(DateFormatter(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>))：设置x轴的主刻度的formatter。</span><br><span class="line"></span><br><span class="line">properties()：返回一个字典，该字典中包含了axes中的所有属性的键值对。</span><br><span class="line"></span><br><span class="line">table(**kwargs)：添加一个表格，返回一个table.Table实例。调用方式为：</span><br><span class="line">    table(cellText=<span class="literal">None</span>, cellColours=<span class="literal">None</span>,</span><br><span class="line">        cellLoc=<span class="string">&#x27;right&#x27;</span>, colWidths=<span class="literal">None</span>,</span><br><span class="line">        rowLabels=<span class="literal">None</span>, rowColours=<span class="literal">None</span>, rowLoc=<span class="string">&#x27;left&#x27;</span>,</span><br><span class="line">        colLabels=<span class="literal">None</span>, colColours=<span class="literal">None</span>, colLoc=<span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">        loc=<span class="string">&#x27;bottom&#x27;</span>, bbox=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">text(x, y, s, fontdict=<span class="literal">None</span>, withdash=<span class="literal">False</span>, **kwargs)：添加文本，返回一个Text实例。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">s：一个字符串，被添加的文本</span></span><br><span class="line"><span class="string">x/y：一个标量，文本被添加的坐标</span></span><br><span class="line"><span class="string">fontdict：一个字典，给出了字体属性。</span></span><br><span class="line"><span class="string">withdash：一个布尔值。如果为True，则创建一个TextWithDash实例而不是Text实例。</span></span><br><span class="line"><span class="string">其他参数用于控制Text属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">tick_params(axis=<span class="string">&#x27;both&#x27;</span>, **kwargs)：控制tick和tick label。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">axis：一个字符串，指定要控制那个轴。可以为&#x27;x&#x27;/&#x27;y&#x27;/&#x27;both&#x27;</span></span><br><span class="line"><span class="string">reset：一个布尔值。如果为True，那么在进行处理其他关键字参数之前，先恢复默认值。默认为False</span></span><br><span class="line"><span class="string">which：一个字符串，指定控制主刻度还是次刻度。可以为&#x27;major&#x27;/&#x27;minor&#x27;/&#x27;both&#x27;</span></span><br><span class="line"><span class="string">direction：一个字符串，控制将刻度放置在axes里面还是外面。可以为&#x27;in&#x27;/&#x27;out&#x27;/&#x27;inout&#x27;</span></span><br><span class="line"><span class="string">length：一个标量值。给出了每个刻度线的长度（就是那个小竖线），单位为像素点</span></span><br><span class="line"><span class="string">width：一个标量值。给出了每个刻度线的宽度（就是那个小竖线），单位为像素点</span></span><br><span class="line"><span class="string">color：给出刻度线的颜色</span></span><br><span class="line"><span class="string">pad：一个标量值，给出了刻度线和刻度label之间的距离，单位为像素点</span></span><br><span class="line"><span class="string">labelsize：一个标量值，给出了刻度label的字体大小。可以为数值，单位为像素点。也可以为字符串，如large&#x27;</span></span><br><span class="line"><span class="string">labelcolor：给出了刻度label的颜色</span></span><br><span class="line"><span class="string">colors：同时调整刻度线的颜色和刻度label的颜色</span></span><br><span class="line"><span class="string">bottom/top/left/right：一个布尔值或者字符串&#x27;on&#x27;/&#x27;off&#x27;。控制是否绘制对应位置的刻度线</span></span><br><span class="line"><span class="string">labelbottom/labeltop/labelleft/labelright：一个布尔值或者字符串&#x27;on&#x27;/&#x27;off&#x27;。控制是否绘制对应位置的刻度label</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">vlines(x, ymin, ymax, colors=<span class="string">&#x27;k&#x27;</span>, linestyles=<span class="string">&#x27;solid&#x27;</span>, label=<span class="string">&#x27;&#x27;</span>, **kwargs)：绘制一群垂直线。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x：标量或者一维数组，给出了垂线的位置</span></span><br><span class="line"><span class="string">ymin/ymax：给出了垂线的起始和终止位置。如果是个标量，则所有垂线共享该值</span></span><br><span class="line"><span class="string">colors：给出垂线的颜色</span></span><br><span class="line"><span class="string">linestyles：给出了垂线的线型</span></span><br><span class="line"><span class="string">label：一个字符串</span></span><br><span class="line"><span class="string">其他关键字参数设置LineCollection参数</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">hlines(y, xmin, xmax, colors=<span class="string">&#x27;k&#x27;</span>, linestyles=<span class="string">&#x27;solid&#x27;</span>, label=<span class="string">&#x27;&#x27;</span>, **kwargs)：</span><br><span class="line">从xmin到xmax绘制一系列的水平线。这些水平线的纵坐标由y提供。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">y：水平线的纵坐标。如果为标量，则为一条水平；如果为序列，则为一系列水平线。数据坐标系</span></span><br><span class="line"><span class="string">xmin/xmax：水平线的起点和终点的横坐标。如果是个标量，则所有的水平线公用。如果是序列，则每个水平线设置一个。数据坐标系</span></span><br><span class="line"><span class="string">linestyles：指定线型。</span></span><br><span class="line"><span class="string">            可以为一个字符串（所有水平线公用），或者字符串序列（每个水平线一个）。</span></span><br><span class="line"><span class="string">            线型在&#x27;solid&#x27; | &#x27;dashed&#x27; | &#x27;dashdot&#x27; | &#x27;dotted&#x27;四者之一</span></span><br><span class="line"><span class="string">colors：指定颜色。可以为一个颜色（所有水平线公用），或者颜色序列（每个水平线一个）。</span></span><br><span class="line"><span class="string">label：一个字符串，指定标签。</span></span><br><span class="line"><span class="string">其他关键字参数设置LineCollection属性。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">quiver(*args, **kw)：创建一个二维的场向量。常见的调用方式有：</span><br><span class="line">    quiver(U,V,**kw)、 quiver(U,V,C,**kw)、quiver(X,Y,U,V,C,**kw)</span><br><span class="line">    quiver(X,Y,U,V,C,**kw)</span><br><span class="line">    其中U/V为向量的x轴分量和y轴分量。X/Y为绘制向量的起点坐标。C用于指定每个箭头的颜色。</span><br><span class="line">    如果为指定X/Y，则默认每个向量的起点从每个单元格生成。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">units：一个字符串，指定箭头的单位。除了箭头的长度以外，其他的度量都是以该单位为准。可以为：</span></span><br><span class="line"><span class="string">    &#x27;width&#x27;/&#x27;height&#x27;：以axes的宽度/高度为单位</span></span><br><span class="line"><span class="string">    &#x27;dots&#x27;/&#x27;inches&#x27;：以像素点/英寸为单位</span></span><br><span class="line"><span class="string">    &#x27;x&#x27;/&#x27;y&#x27;/&#x27;xy&#x27;：以数据坐标系下的X/Y为单位，而xy&#x27;表示数据坐标系下的单位矩形的对角线为单位。</span></span><br><span class="line"><span class="string">angles：指定向量的角度。正方形可能因为X/Y轴缩放尺度不同而显示为长方形。</span></span><br><span class="line"><span class="string">        可以为&#x27;uv&#x27;，表示只采用U,V的值计算；可以为&#x27;xy&#x27;，表示角度计算时考虑X轴与Y轴的缩放尺度。</span></span><br><span class="line"><span class="string">scale：一个浮点数，决定缩放比例。它和scale_units决定了箭头的全长。</span></span><br><span class="line"><span class="string">       假如向量的长度计算得到为 10，那么假如scale为 2， 而scale_units为dots，那么该向量的长度为5像素点。</span></span><br><span class="line"><span class="string">scale_units：一个字符串，指定缩放比例的单位。可以为&#x27;width&#x27;/&#x27;height&#x27;/&#x27;dots&#x27;/&#x27;inches&#x27;/&#x27;x&#x27;/&#x27;y&#x27;/&#x27;xy&#x27;</span></span><br><span class="line"><span class="string">width:一个标量，指定箭头的宽度，单位由units参数指定</span></span><br><span class="line"><span class="string">headwitdh:一个标量，指定箭头的头部的宽度，单位由units参数指定</span></span><br><span class="line"><span class="string">headlength:一个标量，指定箭头的头部的长度，单位由units参数指定</span></span><br><span class="line"><span class="string">headaxislength:一个标量，指定的是箭头的头部的左半边小三角与箭杆的相交的长度。单位由units参数指定</span></span><br><span class="line"><span class="string">minshaft:一个标量，Length below which arrow scales, in units of head length. 。不要设置成小于1，否则图形很难看</span></span><br><span class="line"><span class="string">minlength:一个标量，指定所有箭头的最短长度（单位由units参数指定）。如果有的箭头长度小于它，则绘制成一个点。</span></span><br><span class="line"><span class="string">pivot:一个字符串，控制了箭头旋转的中心。可以为&#x27;tail&#x27;/&#x27;mid&#x27;/&#x27;middle&#x27;/&#x27;tip&#x27;。tip表示箭头的尖尖。</span></span><br><span class="line"><span class="string">color:给出了箭头的颜色。如果给出了C参数，则该参数被忽略。</span></span><br><span class="line"><span class="string">其他参数控制了PolyCollection的属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">quiverkey(*args, **kw)：给quiver设置key。常用的调用方式为：quiverkey(Q,X,Y,U,label,**kw)。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Q：一个Quiver实例，由quiver()返回</span></span><br><span class="line"><span class="string">X/Y：key放置的位置，都是标量</span></span><br><span class="line"><span class="string">U：key的长度，都是标量</span></span><br><span class="line"><span class="string">label：一个字符串，指定了标记。</span></span><br><span class="line"><span class="string">coordinates：一个字符串，指定了X/Y的坐标系。</span></span><br><span class="line"><span class="string">    &#x27;axes&#x27;：axes坐标系，(0，0)为axes的左下角，(1,1)为axes的右上角。</span></span><br><span class="line"><span class="string">    &#x27;figure&#x27;：figure坐标系，(0，0)为figure的左下角，(1,1)为figure的右上角。</span></span><br><span class="line"><span class="string">    &#x27;data&#x27;：data坐标系</span></span><br><span class="line"><span class="string">    &#x27;inches&#x27;：为figure坐标系，但是以像素点为基准。(0,0)为左下角</span></span><br><span class="line"><span class="string">color：重写了Q的color</span></span><br><span class="line"><span class="string">labelpos：放置标记的位置，可以为&#x27;N&#x27;/&#x27;S&#x27;/&#x27;E&#x27;/&#x27;W&#x27;</span></span><br><span class="line"><span class="string">labelsep：给出了标记和箭头的距离，单位为英寸</span></span><br><span class="line"><span class="string">labelcolor：给出了标记的颜色</span></span><br><span class="line"><span class="string">fontproperties：一个字典或者FontProperties实例，设置了标记的字体。</span></span><br><span class="line"><span class="string">其他的关键字参数用于重写quiver的一些属性。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">semilogx(*args, **kwargs)：它类似plot()，只是将x轴设置为对数坐标。除了多了下面的参数外，其他设置与plot()一样。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">basex：一个大于 1 的标量，用于设置对数的底数</span></span><br><span class="line"><span class="string">subx：一个序列或者None。用于设置x轴的主要刻度值。默认采用自动设定</span></span><br><span class="line"><span class="string">nonposx：如果为&#x27;mask&#x27;，则x的负数或者零将被视作无效的数；</span></span><br><span class="line"><span class="string">         如果为&#x27;clip&#x27;，则x的负数或者零将被视作一个非常小的正数（因为对数的自变量要大于零）</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">semilogy(*args, **kwargs)：它类似plot()，只是将y轴设置为对数坐标。除了多了下面的参数外，其他设置与plot()一样。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">basey：一个大于 1 的标量，用于设置对数的底数</span></span><br><span class="line"><span class="string">suby：一个序列或者None。用于设置y轴的主要刻度值。默认采用自动设定</span></span><br><span class="line"><span class="string">nonposy：如果为&#x27;mask&#x27;，则y的负数或者零将被视作无效的数；</span></span><br><span class="line"><span class="string">         如果为&#x27;clip&#x27;，则y的负数或者零将被视作一个非常小的正数（因为对数的自变量要大于零）</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">spy(Z, precision=<span class="number">0</span>, marker=<span class="literal">None</span>, markersize=<span class="literal">None</span>, aspect=<span class="string">&#x27;equal&#x27;</span>, origin=<span class="string">&#x27;upper&#x27;</span>, **kwargs)：绘制矩阵中的非零值。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Z：待绘制的二维矩阵，它和precision决定了绘制区域。坐标点(i,j)对应于Z[j,i]，即列对应于x轴。</span></span><br><span class="line"><span class="string">precision：只有Z中的那些大于precision的值才被绘制</span></span><br><span class="line"><span class="string">marker：用它来表示Z中的非零值</span></span><br><span class="line"><span class="string">markersize：marker的大小。</span></span><br><span class="line"><span class="string">aspect：高宽比</span></span><br><span class="line"><span class="string">origin：参考imshow的origin</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">stem(*args, **kwargs)：绘制stem图。其调用方式为：</span><br><span class="line">  stem(y, linefmt=<span class="string">&#x27;b-&#x27;</span>, markerfmt=<span class="string">&#x27;bo&#x27;</span>, basefmt=<span class="string">&#x27;r-&#x27;</span>)</span><br><span class="line">  stem(x, y, linefmt=<span class="string">&#x27;b-&#x27;</span>, markerfmt=<span class="string">&#x27;bo&#x27;</span>, basefmt=<span class="string">&#x27;r-&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">linefmt：决定了垂线的格式。</span></span><br><span class="line"><span class="string">markerfmt：决定了每个`fmt`的格式。</span></span><br><span class="line"><span class="string">x：决定了每条垂线的位置（如果未提供，则为`[0,1,...len(y)-1]`）。</span></span><br><span class="line"><span class="string">y：序列决定了每条垂线的高度。</span></span><br><span class="line"><span class="string">basefmt：决定了位于`y=0`这条基准直线的格式。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">step(x, y, *args, **kwargs)：绘制阶梯图。调用方式为step(x, y, *args, **kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x/y：都是一维序列，并且假设x为单调递增的（如果不满足，也不报错）</span></span><br><span class="line"><span class="string">where：指定分步类型。可以为&#x27;pre&#x27;/&#x27;post&#x27;/&#x27;mid&#x27;</span></span><br><span class="line"><span class="string">其他参数与plot()相同</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">streamplot(x, y, u, v, density=<span class="number">1</span>, linewidth=<span class="literal">None</span>, color=<span class="literal">None</span>, cmap=<span class="literal">None</span>, </span><br><span class="line">           norm=<span class="literal">None</span>, arrowsize=<span class="number">1</span>, arrowstyle=<span class="string">&#x27;-|&gt;&#x27;</span>, minlength=<span class="number">0.1</span>, </span><br><span class="line">           transform=<span class="literal">None</span>, zorder=<span class="number">1</span>, start_points=<span class="literal">None</span>)：绘制向量场流线。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x/y：一维数组，给出了网格的坐标</span></span><br><span class="line"><span class="string">u/v：二维数组，给出了每个网格的向量。其行数等于y的长度，列数等于x的长度</span></span><br><span class="line"><span class="string">density：一个浮点数或者浮点数的二元元组。控制了绘制向量场的密度。</span></span><br><span class="line"><span class="string">linewidth：标量或者二维数组，给出了每个向量箭头的线宽</span></span><br><span class="line"><span class="string">color：标量或者二维数组，给出了每个向量箭头的颜色</span></span><br><span class="line"><span class="string">cmap：一个Colormap实例。当color是一个二维数组时，它配合使用，给出了每个向量箭头的颜色</span></span><br><span class="line"><span class="string">norm：一个Normalize实例。当color是一个二维数组时，它配合使用，将颜色亮度调整为0~1</span></span><br><span class="line"><span class="string">arrowsize：一个浮点数，给出了箭头缩放比例</span></span><br><span class="line"><span class="string">arrowstyle：一个字符串，给出了箭头的类型。</span></span><br><span class="line"><span class="string">minlength：一个浮点数，限定了最小的向量长度</span></span><br><span class="line"><span class="string">start_points：它是一个N*2的数组，N流线起点的个数，给出了流线起始点的位置</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p>常用绘图方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br></pre></td><td class="code"><pre><span class="line">bar(left, height, width=<span class="number">0.8</span>, bottom=<span class="literal">None</span>, **kwargs)：绘制一个bar。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">left：一个标量或者标量的序列，bar的左侧的x坐标，采用data坐标系</span></span><br><span class="line"><span class="string">height：一个标量或者标量的序列，bar的高度，采用data坐标系</span></span><br><span class="line"><span class="string">width：一个标量或者标量的序列，bar的宽度，默认为 0.8，采用data坐标系</span></span><br><span class="line"><span class="string">bottom：一个标量或者标量的序列，bar的底部的y坐标，默认为 0，采用data坐标系</span></span><br><span class="line"><span class="string">color：一个标量或者标量的序列，bar的背景色</span></span><br><span class="line"><span class="string">edgecolor：一个标量或者标量的序列，bar的边色颜色</span></span><br><span class="line"><span class="string">linewidth：一个标量或者标量的序列，bar的边的线宽</span></span><br><span class="line"><span class="string">tick_label：一个字符串或者字符串的序列，给出了bar的label</span></span><br><span class="line"><span class="string">xerr：一个标量或者标量的序列，用于设置bar的errorbar。（水平方向的小横线）</span></span><br><span class="line"><span class="string">yerr：一个标量或者标量的序列，用于设置bar的errorbar（垂直方向的小横线）</span></span><br><span class="line"><span class="string">ecolor：一个标量或者标量的序列，用于设置errorbar。</span></span><br><span class="line"><span class="string">capsize：一个标量，用于设置errorbar。小横线头部的一个小短线</span></span><br><span class="line"><span class="string">error_kw：一个字典，用于设置errorbar。如ecolor/capsize关键字</span></span><br><span class="line"><span class="string">align：一个字符串，设定bar的对齐方式。可以为&#x27;edge&#x27;/&#x27;center&#x27;。柱子的左边跟x=left线对齐，还是柱子的中线跟x=left线对齐。</span></span><br><span class="line"><span class="string">orientation：一个字符串，指定bar的方向。可以为&#x27;vertical&#x27;/&#x27;horizontal&#x27;。它决定了errbar和label放置的位置。</span></span><br><span class="line"><span class="string">log：一个布尔值，如果为True，则设置axis为对数坐标</span></span><br><span class="line"><span class="string">返回matplotlib.container.BarContainer。</span></span><br><span class="line"><span class="string">可以一次添加多个bar，此时就是上述的“标量的序列”。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">barh(bottom, width, height=<span class="number">0.8</span>, left=<span class="literal">None</span>, **kwargs)：绘制水平的bar</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">bottom：一个标量或者标量的序列，bar的底部的y坐标，默认为 0，采用data坐标系</span></span><br><span class="line"><span class="string">width：一个标量或者标量的序列，bar的宽度，默认为 0.8，采用data坐标系</span></span><br><span class="line"><span class="string">height：一个标量或者标量的序列，bar的高度，采用data坐标系</span></span><br><span class="line"><span class="string">left：一个标量或者标量的序列，bar的左侧的x坐标，采用data坐标系</span></span><br><span class="line"><span class="string">其他参数参考 bar方法</span></span><br><span class="line"><span class="string">它就是bar(orientation=&#x27;horizontal&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">errorbar(x, y, yerr=<span class="literal">None</span>, xerr=<span class="literal">None</span>, fmt=<span class="string">&#x27;&#x27;</span>, ecolor=<span class="literal">None</span>, elinewidth=<span class="literal">None</span>, capsize=<span class="literal">None</span>, </span><br><span class="line">        barsabove=<span class="literal">False</span>, lolims=<span class="literal">False</span>, uplims=<span class="literal">False</span>, xlolims=<span class="literal">False</span>, xuplims=<span class="literal">False</span>, errorevery=<span class="number">1</span>, </span><br><span class="line">        capthick=<span class="literal">None</span>, **kwargs)：绘制errorbar，返回(plotline, caplines, barlinecols)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x：一个序列，指定x坐标</span></span><br><span class="line"><span class="string">y:一个序列，指定y坐标。即： y=f(x)</span></span><br><span class="line"><span class="string">yerr：指定y的error。</span></span><br><span class="line"><span class="string">      如果为标量，则每个点都是相同的error；</span></span><br><span class="line"><span class="string">      如果为一维向量，则依次给出了每个点的error。</span></span><br><span class="line"><span class="string">      如果是个二维向量，则依次给出了每个点的上error和下error</span></span><br><span class="line"><span class="string">xerr：指定x的error。</span></span><br><span class="line"><span class="string">      如果为标量，则每个点都是相同的error；</span></span><br><span class="line"><span class="string">      如果为一维向量，则依次给出了每个点的error。</span></span><br><span class="line"><span class="string">      如果是个二维向量，则依次给出了每个点的左error和右error</span></span><br><span class="line"><span class="string">fmt：可以为空字符串，或者&#x27;none&#x27;或者其他的plot format string。如果是&#x27;none&#x27;则只有errorbars能够被绘制</span></span><br><span class="line"><span class="string">color：点(x, y)的颜色，比如color=black&#x27;&#x27;</span></span><br><span class="line"><span class="string">ecolor：指定了errorbar的颜色，比如ecolor=&#x27;lightgray&#x27;</span></span><br><span class="line"><span class="string">elinewidth：指定了errorbar的线宽</span></span><br><span class="line"><span class="string">capsize：指定了errorbar头部的小横线的宽度</span></span><br><span class="line"><span class="string">errorevery：一个整数。如果为 4， 则每隔 4个点才绘制一个errorbar</span></span><br><span class="line"><span class="string">其他的关键字参数都是用于指定marker的类型。</span></span><br><span class="line"><span class="string">     如： `marker=&#x27;s&#x27;,mfc=&#x27;red&#x27;, mec=&#x27;green&#x27;, ms=20, mew=4。</span></span><br><span class="line"><span class="string">     他们是markderfacecolor,markeredgecolor,markdersize,markderedgewidth的缩写。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">errorbar是配合散点图使用，分析离散变量的误差性。</span></span><br><span class="line"><span class="string">我的经验是，让误差线的颜色比数据点的颜色浅一点，效果会非常好，尤其在点密集的图形中。</span></span><br><span class="line"><span class="string">比如，plt.errorbar(x, y, yerr=dy, fmt=&#x27;o&#x27;, color=&#x27;black&#x27;,ecolor=&#x27;lightgray&#x27;, elinewidth=3, capsize=0)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">eventplot(positions, orientation=<span class="string">&#x27;horizontal&#x27;</span>, lineoffsets=<span class="number">1</span>, linelengths=<span class="number">1</span>, </span><br><span class="line">          linewidths=<span class="literal">None</span>, colors=<span class="literal">None</span>, linestyles=<span class="string">&#x27;solid&#x27;</span>, **kwargs) ：绘制时间线。</span><br><span class="line">          时间线就是在指定位置上并排的一系列线段。返回 matplotlib.collections.EventCollection的一个列表</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">positions：一个一维或者二维的数组。每一行代表了一组直线</span></span><br><span class="line"><span class="string">orientation：可以为&#x27;horizonal&#x27;|&#x27;vertical&#x27;，代表了摆放时间线的方式。</span></span><br><span class="line"><span class="string">             如果是水平走向的，则垂直摆放直线；如果是垂直走向的，则水平放置直线</span></span><br><span class="line"><span class="string">lineoffsets：一个浮点数或者浮点数的序列，指定了时间线中轴距离y=0的偏离值</span></span><br><span class="line"><span class="string">linelengths：一个浮点数或者浮点数的序列，指定了线的长度</span></span><br><span class="line"><span class="string">linewidths：一个浮点数或者浮点数的序列，指定了线的宽度</span></span><br><span class="line"><span class="string">colors：一个颜色或者一组颜色，指定了线的颜色。颜色可以为颜色字符串，或者一个RGB元组。</span></span><br><span class="line"><span class="string">linestyles：一个线型或者一组线型，指定了线型。线型在&#x27;solid&#x27; | &#x27;dashed&#x27; | &#x27;dashdot&#x27; | &#x27;dotted&#x27;四者之一</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">如果positions是一个一维数组，表示绘制一组时间线。</span></span><br><span class="line"><span class="string">    那么lineoffsets/linelengths/linewidths/colors/linestyles都是标量值，指定该组时间线的格式。</span></span><br><span class="line"><span class="string">    如果positions是一个二维数组则，有多少行，就有多少组时间线。</span></span><br><span class="line"><span class="string">        制定时间线格式的这些参数都是序列，序列长度就是positions的行数。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">fill(*args, **kwargs)：绘制多边形。返回一个Patch列表，plot()支持的颜色字符在这里也被支持。其常用的方式为：</span><br><span class="line">    fill(x,y,<span class="string">&#x27;b&#x27;</span>)：绘制一个多边形。其中x为多边形的边上的点的x坐标；y为多边形的边上的点的y坐标。<span class="string">&#x27;b&#x27;</span>为多边形的填充颜色。</span><br><span class="line">    fill(x1,y1,<span class="string">&#x27;b&#x27;</span>,x2,y2,<span class="string">&#x27;r&#x27;</span>)：绘制多个多边形。这里指定多个x,y,color就可以。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">closed：一个布尔值，确定是否封闭多边形（即多一条从起点到终点的边）。默认为True。</span></span><br><span class="line"><span class="string">剩下的关键字参数用于控制Polygon的属性。如</span></span><br><span class="line"><span class="string">    hatch：一个字符串，指定填充方式，如[&#x27;/&#x27; | &#x27;\&#x27; | &#x27;|&#x27; | &#x27;-&#x27; | &#x27;+&#x27; | &#x27;x&#x27; | &#x27;o&#x27; | &#x27;O&#x27; | &#x27;.&#x27; | &#x27;*&#x27;]</span></span><br><span class="line"><span class="string">    label：一个字符串，指定标签</span></span><br><span class="line"><span class="string">    fill：一个布尔值，决定是否填充</span></span><br><span class="line"><span class="string">    facecolor/edgecolor/color：颜色</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">fill_between(x, y1, y2=<span class="number">0</span>, where=<span class="literal">None</span>, interpolate=<span class="literal">False</span>, step=<span class="literal">None</span>, **kwargs)：绘制填充区域。</span><br><span class="line">它填充两个曲线之间的部分。它返回一个PolyCollection对象。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x：一个序列，指定x坐标</span></span><br><span class="line"><span class="string">y1：第一条曲线的纵坐标。如果为标量，说明该曲线为水平线。相当于y轴的连续误差线（下限）。</span></span><br><span class="line"><span class="string">y2：第二条曲线的纵坐标。如果为标量，说明该曲线为水平线。相当于y轴的连续误差线（上限）。</span></span><br><span class="line"><span class="string">where：指定填充哪里。</span></span><br><span class="line"><span class="string">       如果为None，则填充两条曲线之间的所有区域，这是默认值。</span></span><br><span class="line"><span class="string">       如果非None，则他是一个一维布尔数组，长度与x相同。只有为True对应的x处才被填充。</span></span><br><span class="line"><span class="string">interpolate：一个布尔值。如果True，则进行插值计算来寻找两个曲线的交点。如果为False，则不进行插值。</span></span><br><span class="line"><span class="string">step：可以为&#x27;pre&#x27;/&#x27;post&#x27;/&#x27;mid&#x27;或者None，设定填充区域的边界的形状。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">我的经验是，可以画连续变量误差区间。结合plot绘制连续误差线的上界和下界曲线，并且用颜色填充区间。</span></span><br><span class="line"><span class="string">比如：plt.fill_between(xfit, yfit-dyfit, yfit+dyfit, color=&#x27;gray&#x27;, alpha=&#x27;0.2&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">fill_betweenx(y, x1, x2=<span class="number">0</span>, where=<span class="literal">None</span>, step=<span class="literal">None</span>, **kwargs)：绘制填充区域。</span><br><span class="line">该区域是以y为自变量，x为函数的两条曲线合围而成。它返回一个PolyCollection对象。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">y：一个序列，为纵坐标</span></span><br><span class="line"><span class="string">x1：第一个曲线的x坐标。它是一个反函数，即以y为自变量。相当于x轴的连续误差线（下限）。</span></span><br><span class="line"><span class="string">x2：第二个曲线的y坐标。它也是一个反函数。相当于x轴的连续误差线（上限）。</span></span><br><span class="line"><span class="string">where：指定填充哪里。</span></span><br><span class="line"><span class="string">       如果为None，则填充两条曲线之间的所有区域，这是默认值。</span></span><br><span class="line"><span class="string">       如果非None，则他是一个一维布尔数组，长度与y相同。只有为True对应的y处才被填充。</span></span><br><span class="line"><span class="string">step：可以为&#x27;pre&#x27;/&#x27;post&#x27;/&#x27;mid&#x27;或者None，设定填充区域的边界的形状。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">通常建议提供一个alpha参数，用于设定填充的透明度。</span></span><br><span class="line"><span class="string">如果同一个区域被多个fill_between()填充，那么设定alpha之后会让每一层都能显示出来。</span></span><br><span class="line"><span class="string">fill_between沿着x轴填充；fill_betweenx沿着y轴填充</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">hist(x, bins=<span class="number">10</span>, <span class="built_in">range</span>=<span class="literal">None</span>, normed=<span class="literal">False</span>, weights=<span class="literal">None</span>, cumulative=<span class="literal">False</span>, </span><br><span class="line">    bottom=<span class="literal">None</span>, histtype=<span class="string">&#x27;bar&#x27;</span>, align=<span class="string">&#x27;mid&#x27;</span>, orientation=<span class="string">&#x27;vertical&#x27;</span>, </span><br><span class="line">    rwidth=<span class="literal">None</span>, log=<span class="literal">False</span>, color=<span class="literal">None</span>, label=<span class="literal">None</span>, stacked=<span class="literal">False</span>, **kwargs) ：绘制频次直方图。 其返回值为：</span><br><span class="line">    如果绘制一个直方图，那么就是元组 (n, bins, patches)，n为频数/频率；bins为直方图的各个分界点；patches为每个直方图</span><br><span class="line">    如果绘制多个直方图，那么就是元组 ([n0, n1, ...], bins, [patches0, patches1,...])</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x:一个序列或者一维数组，给定了直方图的数据</span></span><br><span class="line"><span class="string">bins：一个整数。返回了bins+1个分界点，将竖着划分成等分的bins份。</span></span><br><span class="line"><span class="string">      你可以传递一个序列，指定分界点，此时可以实现非等分的划分。</span></span><br><span class="line"><span class="string">range：一个元组，给出了数据的上界和下界，在这之外的数据不被考虑。默认就是(x.min(),x.max())</span></span><br><span class="line"><span class="string">normed：布尔值，如果为True，则返回的是数据出现的频率；否则返回的是数据出现的频数</span></span><br><span class="line"><span class="string">weights：长度与x相同的序列，给出了每个数据的权重</span></span><br><span class="line"><span class="string">cumulative  ：布尔值。如果为True，则计算的是累积频率/频数</span></span><br><span class="line"><span class="string">bottom：一个整数或者整数序列或者None，指定了直方图底部的纵坐标。默认为 0</span></span><br><span class="line"><span class="string">histtype：直方图的类型。可以为&#x27;bar&#x27;/&#x27;barstacked&#x27;/&#x27;step&#x27;/&#x27;stepfilled&#x27;</span></span><br><span class="line"><span class="string">align：直方图每个小矩形的对齐方式。可以为&#x27;left&#x27;/&#x27;mid&#x27;/right&#x27;</span></span><br><span class="line"><span class="string">orientation：调整方向。可以为&#x27;horizontal&#x27;/&#x27;vertical&#x27;。如果为水平则，使用barh，同时bottom参数设定的是左侧的横坐标值</span></span><br><span class="line"><span class="string">rwidth：一个标量值，设定了直方图每个矩形的相对于默认值的宽度。如果直方图类型为 step/stepfilled，则忽略该参数。</span></span><br><span class="line"><span class="string">log：布尔值。如果为True：则x轴使用对数坐标</span></span><br><span class="line"><span class="string">color：颜色或者颜色序列，用于给直方图指定颜色</span></span><br><span class="line"><span class="string">label：字符串或者字符串序列。给直方图指定标签</span></span><br><span class="line"><span class="string">stacked：一个布尔值。如果为True，则多个直方图会叠加在一起。</span></span><br><span class="line"><span class="string">其他参数设置了Patch的属性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">我的经验是，对不同分布特征的样本进行对比时，histtype=‘stepfilled&#x27;和alpha配合效果很好。</span></span><br><span class="line"><span class="string">如果只是分段区间，显示区间数量，不显示图，使用np.histogram(data,bins)更好。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">hist2d(x, y, bins=<span class="number">10</span>, <span class="built_in">range</span>=<span class="literal">None</span>, normed=<span class="literal">False</span>, </span><br><span class="line">        weights=<span class="literal">None</span>, cmin=<span class="literal">None</span>, cmax=<span class="literal">None</span>, **kwargs)：</span><br><span class="line">        将二维数组按照二维区间进行切分，绘制二维频次直方图。</span><br><span class="line">        其返回值为元组 (counts, xedges, yedges, Image) </span><br><span class="line">        二维频次直方图由与坐标轴的方块分割而成的，用于同一个地方有很多点的情况。  </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x:一个序列或者一维数组，给定了x坐标序列</span></span><br><span class="line"><span class="string">y:一个序列或者一维数组，给定了y坐标序列</span></span><br><span class="line"><span class="string">bins：</span></span><br><span class="line"><span class="string">    如果为整数，则给出了两个维度上的区间数量</span></span><br><span class="line"><span class="string">    如果为int,int序列，则分别给出了x区间数量和y区间数量</span></span><br><span class="line"><span class="string">    如果给定了一个一维数组，则给出了 x_edges=y_edges=bins</span></span><br><span class="line"><span class="string">    如果为定了array,array，则分别给出了x_edges,y_edges</span></span><br><span class="line"><span class="string">range：一个(2,2)的数组，给出了数据的上界和下界，在这之外的数据不被考虑。默认就是(x.min(),x.max())</span></span><br><span class="line"><span class="string">normed：布尔值，如果为True，则返回的是数据出现的频率；否则返回的是数据出现的频数</span></span><br><span class="line"><span class="string">weights：长度与x相同的序列，给出了每个数据的权重</span></span><br><span class="line"><span class="string">cmin：一个标量值。那些count值小于cmin的单元不被显示。同时返回的结果中，这些单元返回nan</span></span><br><span class="line"><span class="string">cmax：一个标量值。那些count值大于cmax的单元不被显示。同时返回的结果中，这些单元返回nan</span></span><br><span class="line"><span class="string">其他参数设置了pcolorfast()属性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">如果只是分段区间，显示区间数量，不显示图，使用np.histogram2ds(x, y, bins)更好。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">hexbin(x, y, C=<span class="literal">None</span>, gridsize=<span class="number">100</span>, bins=<span class="literal">None</span>, xscale=<span class="string">&#x27;linear&#x27;</span>, yscale=<span class="string">&#x27;linear&#x27;</span>, </span><br><span class="line">    extent=<span class="literal">None</span>, cmap=<span class="literal">None</span>, norm=<span class="literal">None</span>, vmin=<span class="literal">None</span>, vmax=<span class="literal">None</span>, alpha=<span class="literal">None</span>, </span><br><span class="line">    linewidths=<span class="literal">None</span>, edgecolors=<span class="string">&#x27;none&#x27;</span>, reduce_C_function=&lt;function mean&gt;, </span><br><span class="line">    mincnt=<span class="literal">None</span>, marginals=<span class="literal">False</span>, **kwargs)：</span><br><span class="line">    同hist2d，绘制二维频次直方图。不同的是六边形面元划分。返回一个PolyCollection对象。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x/y：一维数组，它们形状相同。它们给出了绘制六边形面元的点。</span></span><br><span class="line"><span class="string">C：如果非None，则它给出了坐标(x[i],y[i])的count value。它和x长度相同，也是一维数组</span></span><br><span class="line"><span class="string">   x/y/C也可能是masked array，此时只有unmasked的点才被绘制</span></span><br><span class="line"><span class="string">reduce_C_function：将坐标(x[i],y[i])的count value进行归并。</span></span><br><span class="line"><span class="string">                   因为同一个坐标可能被设定了多个count value。而每个点根据其count value来染色</span></span><br><span class="line"><span class="string">gridsize：一个整数。它调整了六边形面元x方向的尺寸，y方向的尺寸自动选取。</span></span><br><span class="line"><span class="string">         你也可以设定它为一个元组，同时调整x/y方向的尺寸。</span></span><br><span class="line"><span class="string">         它实际上给出的是x轴可以放置的面元数量，因此该数值越大，六边形面元尺寸越小。</span></span><br><span class="line"><span class="string">bins：</span></span><br><span class="line"><span class="string">    如果为None，则每个六边形面元的颜色值直接对应了它的count value</span></span><br><span class="line"><span class="string">    如果为&#x27;log&#x27;，则每个六边形面元的颜色值对应了它的count value+1的对数值</span></span><br><span class="line"><span class="string">    如果为一个整数，将counts划分为指定数量的箱，并相应地为六边形上色</span></span><br><span class="line"><span class="string">    如果为一个整数序列，则使用箱边界的下限值</span></span><br><span class="line"><span class="string">xscale：可以为&#x27;linear&#x27;/&#x27;log&#x27;，设置了x轴是线性还是对数</span></span><br><span class="line"><span class="string">scale：可以为&#x27;linear&#x27;/&#x27;log&#x27;，设置了y轴是线性还是对数</span></span><br><span class="line"><span class="string">mincnt：一个整数或者None。它指定显示这一类的面元：面元包含的坐标点的数量超过mincnt。</span></span><br><span class="line"><span class="string">        对于面元包含坐标点数量少于mincnt的，不显示。</span></span><br><span class="line"><span class="string">marginals：一个布尔值。如果为True，则沿着坐标轴绘制密度条。</span></span><br><span class="line"><span class="string">extent：一个元组(left, right, bottom, top)，等价于同时使用了set_xlim(left,right)+set_ylim(bottom,top)。</span></span><br><span class="line"><span class="string">剩下的参数设定颜色和面元的属性。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">contour(*args, **kwargs)：绘制等高线。它返回一个QuadContourSet对象 最常用的四种方式：</span><br><span class="line">    contour(Z)：其中Z为二维数组。数据坐标系下的坐标点(i,j)对应了Z[j,i]（x轴对应列，y轴对应行）。</span><br><span class="line">                该方法随机挑选一些等高线绘制。</span><br><span class="line">    contour(X,Y,Z)：其中 X/Y/Z均为二维数组，且形状相同。对应位置的横坐标由X提供，纵坐标由Y提供，值由Z提供。</span><br><span class="line">                    X和Y也可以同时是一维数组，且<span class="built_in">len</span>(X)是Z的列数，<span class="built_in">len</span>(Y)是Z的行数。</span><br><span class="line">                    该方法随机挑选一些等高线绘制。</span><br><span class="line">    contour(Z,N)/contour(X,Y,Z,N)：N为一个整数，表示绘制N条等高线。该方法随机挑选N条等高线绘制。</span><br><span class="line">    contour(Z,V)/contour(X,Y,Z,V)：V为一个递增的序列，表示绘制那些值位于V中的等高线</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">colors：如果为None，则由cmap给出。如果是一个字符串，这所有的等高线由字符串指定的颜色给出。</span></span><br><span class="line"><span class="string">        如果是一个序列，该序列中每个都代表了一个颜色，则等高线的颜色依次由该序列给出。</span></span><br><span class="line"><span class="string">cmap：一个Colormap对象。如果为None，则默认的Colormap将被使用</span></span><br><span class="line"><span class="string">levels：一个序列（升序排列）。指定了要绘制等高线值位于levels的等高线。</span></span><br><span class="line"><span class="string">origin：可以为&#x27;upper&#x27;/&#x27;lower&#x27;。图片的第一个像素X[0,0]放置在坐标原点。默认是左上。</span></span><br><span class="line"><span class="string">        &#x27;upper&#x27;：横坐标向右，纵坐标向下</span></span><br><span class="line"><span class="string">        &#x27;lower&#x27;：横坐标向右，纵坐标向上</span></span><br><span class="line"><span class="string">extent：它是一个元组(x0,x1,y0,y1)。如果给出了(X,Y)，则该参数无效。如果未给出(X,Y)：</span></span><br><span class="line"><span class="string">        如果origin非None，则它给出了外边界， Z[0,0]位于图形中间</span></span><br><span class="line"><span class="string">        如果origin为None，则(x0,y0)对应Z[0,0]；(x1,y1)对应Z[-1.-1]，</span></span><br><span class="line"><span class="string">            等价于同时使用了set_xlim(left,right) + set_ylim(bottom,top)</span></span><br><span class="line"><span class="string">antialiased：一个布尔值，用于开启/关闭反走样</span></span><br><span class="line"><span class="string">linewidths：如果为None，则使用默认值。如果为一个整数，则所有的等高线都是用该线宽。</span></span><br><span class="line"><span class="string">            如果为一个整数序列，则等高线依次使用它指定的线宽。只有contour适用</span></span><br><span class="line"><span class="string">linestyles：如果为None，则使用默认的实线。你也可以指定为&#x27;solid&#x27;/&#x27;dashed&#x27;/&#x27;dashdot&#x27;/&#x27;dotted&#x27;。</span></span><br><span class="line"><span class="string">            你可以指定搜有的等高线使用一种线型，也可以使用一个线型序列。只有contour适用</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">所有使用cmap调色盘的，都可以plt.colorbar()显示颜色条。</span></span><br><span class="line"><span class="string">我的经验是，contour方法等高线图单一，可以进一步使用contourf方法在等高线间进行颜色填充，区分度更高。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">contourf(*args, **kwargs)：它绘制的是带填充的等高线。其参数和用法基本和contour相同。它返回一个QuadContourSet对象。</span><br><span class="line">    contourf(Z,V)：</span><br><span class="line">    contourf(X,Y,Z,V)：</span><br><span class="line">    V是递增的序列，指定了等高线的值。该方法会填充V中相邻两个等高线之间的区域。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">hatches：它指定了填充区域的填充类型（如以小斜线填充）。</span></span><br><span class="line"><span class="string">         如果为None，则无任何hatch。它典型值为hatches=[&#x27;.&#x27;, &#x27;/&#x27;, &#x27;\&#x27;, None, &#x27;\\&#x27;, &#x27;*&#x27;,&#x27;-&#x27;,]</span></span><br><span class="line"><span class="string">contourf填充的是半开半闭区间(z1,z2]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">我的经验是，contourf进一步提高了等高线图的显示效果，但区分度强，看上去像是一块块斑渍，可用imshow渲染成渐变图。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">imshow(X, cmap=<span class="literal">None</span>, norm=<span class="literal">None</span>, aspect=<span class="literal">None</span>, interpolation=<span class="literal">None</span>, </span><br><span class="line">        alpha=<span class="literal">None</span>, vmin=<span class="literal">None</span>, vmax=<span class="literal">None</span>, origin=<span class="literal">None</span>, extent=<span class="literal">None</span>, </span><br><span class="line">        shape=<span class="literal">None</span>, filternorm=<span class="number">1</span>, filterrad=<span class="number">4.0</span>, imlim=<span class="literal">None</span>, </span><br><span class="line">        resample=<span class="literal">None</span>, url=<span class="literal">None</span>, **kwargs)：绘制色彩图片。返回一个AxesImage对象</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">X：包含了图片的数据。其形状可以为：</span></span><br><span class="line"><span class="string">   (n,m)（灰度图），类型为float</span></span><br><span class="line"><span class="string">   (n,m,3)（RGB图），类型为float（此时每个元素的值都在 0 和 1.0 之间），或者unit8</span></span><br><span class="line"><span class="string">   (n,m,4)（RGBA图），类型为float（此时每个元素的值都在 0 和 1.0 之间），或者unit8</span></span><br><span class="line"><span class="string">cmap：一个Colormap实例。默认由rc的image.cmap指定。如果X是RGB/RGBA，则忽略该参数</span></span><br><span class="line"><span class="string">aspect：一个字符串，指定图片的缩放。可以为：</span></span><br><span class="line"><span class="string">        &#x27;auto&#x27;：缩放图片的宽高比，是的它匹配axes</span></span><br><span class="line"><span class="string">        &#x27;equal&#x27;：当extent参数为None时，修改axes的宽高比，使得它匹配图片；</span></span><br><span class="line"><span class="string">                 如果extent参数不是None，则修改axes的宽高比来匹配extent</span></span><br><span class="line"><span class="string">        None：默认由rc的image.aspect指定</span></span><br><span class="line"><span class="string">interpolation：一个字符串，指定插值方式。</span></span><br><span class="line"><span class="string">              可以为&#x27;none&#x27;, &#x27;nearest&#x27;, &#x27;bilinear&#x27;, &#x27;bicubic&#x27;, &#x27;spline16&#x27;, &#x27;spline36&#x27;, &#x27;hanning&#x27;, </span></span><br><span class="line"><span class="string">              &#x27;hamming&#x27;, &#x27;hermite&#x27;, &#x27;kaiser&#x27;, &#x27;quadric&#x27;, &#x27;catrom&#x27;, &#x27;gaussian&#x27;,</span></span><br><span class="line"><span class="string">              &#x27;bessel&#x27;, &#x27;mitchell&#x27;, &#x27;sinc&#x27;, &#x27;lanczos&#x27;</span></span><br><span class="line"><span class="string">norm：一个Normalize实例，用于将图片亮度正则化到 0~1。如果为None，则采用normalize.norm</span></span><br><span class="line"><span class="string">vmin/vmax：用于辅助norm进行正则化。如果你传入了一个norm实例，则该参数忽略</span></span><br><span class="line"><span class="string">alpha：浮点数，指定透明度</span></span><br><span class="line"><span class="string">origin：&#x27;upper&#x27;/&#x27;lower&#x27;。图片的第一个像素X[0,0]放置在坐标原点，默认左上角。</span></span><br><span class="line"><span class="string">        &#x27;upper&#x27;：横坐标向右，纵坐标向下</span></span><br><span class="line"><span class="string">        &#x27;lower&#x27;：横坐标向右，纵坐标向上。正常方向，建议用此参数。</span></span><br><span class="line"><span class="string">extent：一个元组(left, right, bottom, top)，等价于set_xlim(left,right)+set_ylim(bottom,top)</span></span><br><span class="line"><span class="string">shape：一个元组(column,rows)，用于rar buffer image</span></span><br><span class="line"><span class="string">filternorm/filterrad：用于过滤</span></span><br><span class="line"><span class="string">其他参数用于调整 Artist属性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">我的经验是：</span></span><br><span class="line"><span class="string">imshow不支持x轴、y轴设置网格，而是通过extent设置图形坐标范围。</span></span><br><span class="line"><span class="string">imshow会自动调整坐标轴的精度以适应数据显示。可通过plt.axis(aspect=&#x27;image&#x27;)来设置x轴与y轴的单位。</span></span><br><span class="line"><span class="string">等高线图+色彩图，使用alpha设置透明度，用plt.clabel()函数与另一幅坐标轴相同、带数据标签的等高线图叠放在一起，效果更好:</span></span><br><span class="line"><span class="string">    contours = plt.contour(X, Y, Z, 3, colors=&#x27;black&#x27;)</span></span><br><span class="line"><span class="string">    plt.clabel(contours, inline=True, fontsize=8) # 叠放</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    plt.imshow(Z, extent=[0, 5, 0, 5], origin=&#x27;lower&#x27;,cmap=&#x27;RdGy&#x27;, alpha=0.5)</span></span><br><span class="line"><span class="string">    plt.colorbar()</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">matshow(Z, **kwargs)：将一个矩阵绘制成图片。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Z：一个形状为(n,m)的数组</span></span><br><span class="line"><span class="string">其他参数见imshow</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">Legend(*args, **kwargs)：创建图例。</span><br><span class="line">ax.legend((line1,line2),(<span class="string">&#x27;label1&#x27;</span>,<span class="string">&#x27;label2&#x27;</span>))：</span><br><span class="line">    输入lines列表，lines标签名列表。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">loc：指定了图例的位置。可以为整数、字符串：</span></span><br><span class="line"><span class="string">     对应于整数的0~10。也可以指定坐标(x,y)，其中(0,0)是左下角，(1,1)是右上角</span></span><br><span class="line"><span class="string">     &#x27;best&#x27;/&#x27;upper right&#x27;/&#x27;upper left&#x27;</span></span><br><span class="line"><span class="string">     /&#x27;lower left&#x27;/&#x27;lower right&#x27;/&#x27;right&#x27;/&#x27;center left&#x27;/</span></span><br><span class="line"><span class="string">     &#x27;center right&#x27;/&#x27;lower center&#x27;/&#x27;upper center&#x27;/&#x27;center&#x27;，</span></span><br><span class="line"><span class="string">ncol：一个整数，指定图例中有几列，默认为 1列</span></span><br><span class="line"><span class="string">prop：一个字典，或者FontProperties实例，可以指定图例中的字体属性。</span></span><br><span class="line"><span class="string">fontsize：控制字体大小，可以为整数、浮点数（指定字体绝对大小），或者字符串:</span></span><br><span class="line"><span class="string">         &#x27;xx-small&#x27;, &#x27;x-small&#x27;, &#x27;small&#x27;, &#x27;medium&#x27;, &#x27;large&#x27;, &#x27;x-large&#x27;, &#x27;xx-large&#x27;</span></span><br><span class="line"><span class="string">numpoint/scatterpoints：图例上每个图例线的点数</span></span><br><span class="line"><span class="string">fancybox：如果为True，图例的边框采用圆角矩形</span></span><br><span class="line"><span class="string">framealpha：一个浮点数，从0到1，外边框的透明度</span></span><br><span class="line"><span class="string">frameon：如果为True，则绘制图例的背景框。否则不绘制</span></span><br><span class="line"><span class="string">shadow：如果为True，图例添加背影</span></span><br><span class="line"><span class="string">ncol：标签列数</span></span><br><span class="line"><span class="string">title：图例的标题</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">图例显示：</span></span><br><span class="line"><span class="string">（1）plt.plot(x, y)返回lines实例列表，然后直接调用ax.legend()即可。</span></span><br><span class="line"><span class="string">（2）单个创建line，然后调用line.set_label()，然后调用ax.legend()。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">默认会不显示无标签的line。</span></span><br><span class="line"><span class="string">如果你想显示部分line，那么只需把想显示的line添加标签即可。</span></span><br><span class="line"><span class="string">如果你想显示全部line + 显示部分图例，那么需绘制两幅图：</span></span><br><span class="line"><span class="string">    第一幅不添加标签（显示全部line）；</span></span><br><span class="line"><span class="string">    第二幅line数据为空，图例数据（比如图形大小,颜色等）添加标签。</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">import pandas as pd</span></span><br><span class="line"><span class="string">cities = pd.read_csv(&#x27;data/california_cities.csv&#x27;)</span></span><br><span class="line"><span class="string"># 提取感兴趣的数据</span></span><br><span class="line"><span class="string">lat, lon = cities[&#x27;latd&#x27;], cities[&#x27;longd&#x27;]</span></span><br><span class="line"><span class="string">population, area = cities[&#x27;population_total&#x27;], cities[&#x27;area_total_km2&#x27;]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 用不同尺寸和颜色的散点图表示数据，但是不带标签</span></span><br><span class="line"><span class="string">plt.scatter(lon, lat, label=None, c=np.log10(population), cmap=&#x27;viridis&#x27;,</span></span><br><span class="line"><span class="string">            s=area, linewidth=0, alpha=0.5)</span></span><br><span class="line"><span class="string">plt.axis(aspect=&#x27;equal&#x27;)</span></span><br><span class="line"><span class="string">plt.xlabel(&#x27;longitude&#x27;)</span></span><br><span class="line"><span class="string">plt.ylabel(&#x27;latitude&#x27;)</span></span><br><span class="line"><span class="string">plt.colorbar(label=&#x27;log$_&#123;10&#125;$(population)&#x27;)</span></span><br><span class="line"><span class="string">plt.clim(3, 7)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 下面创建一个图例：</span></span><br><span class="line"><span class="string"># 画一些带标签和尺寸的空列表，尺寸代表面积</span></span><br><span class="line"><span class="string">for area in [100, 300, 500]:</span></span><br><span class="line"><span class="string">    plt.scatter([], [], c=&#x27;k&#x27;, alpha=0.3, s=area, label=str(area) + &#x27; km$^2$&#x27;)</span></span><br><span class="line"><span class="string">plt.legend(scatterpoints=1, frameon=False, labelspacing=1, title=&#x27;City Area&#x27;)</span></span><br><span class="line"><span class="string">plt.title(&#x27;California Cities: Area and Population&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">如果你想显示多个图例，可以通过Legend()创建一个新的legend artist，然后用底层的ax.add_artist()方法在图上添加第二个图例:</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">fig, ax = plt.subplots()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">lines = []</span></span><br><span class="line"><span class="string">styles = [&#x27;-&#x27;, &#x27;--&#x27;, &#x27;-.&#x27;, &#x27;:&#x27;]</span></span><br><span class="line"><span class="string">x = np.linspace(0, 10, 1000)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(4):</span></span><br><span class="line"><span class="string">    lines += ax.plot(x, np.sin(x - i * np.pi / 2), styles[i], color=&#x27;black&#x27;)</span></span><br><span class="line"><span class="string">ax.axis(&#x27;equal&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 设置第一个图例要显示的线条和标签</span></span><br><span class="line"><span class="string">ax.legend(lines[:2], [&#x27;line A&#x27;, &#x27;line B&#x27;], loc=&#x27;upper right&#x27;, frameon=False)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 创建第二个图例，通过add_artist方法添加到图上</span></span><br><span class="line"><span class="string">from matplotlib.legend import Legend</span></span><br><span class="line"><span class="string">leg = Legend(ax, lines[2:], [&#x27;line C&#x27;, &#x27;line D&#x27;], loc=&#x27;lower right&#x27;, frameon=False)</span></span><br><span class="line"><span class="string">ax.add_artist(leg)</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">pie(x, explode=<span class="literal">None</span>, labels=<span class="literal">None</span>, colors=<span class="literal">None</span>, autopct=<span class="literal">None</span>, pctdistance=<span class="number">0.6</span>, </span><br><span class="line">    shadow=<span class="literal">False</span>, labeldistance=<span class="number">1.1</span>, startangle=<span class="literal">None</span>, radius=<span class="literal">None</span>, counterclock=<span class="literal">True</span>,</span><br><span class="line">    wedgeprops=<span class="literal">None</span>, textprops=<span class="literal">None</span>, center=(<span class="number">0</span>, <span class="number">0</span>), frame=<span class="literal">False</span>)：绘制饼状图。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x：数据序列。每一块饼的权重为x/sum(x)；如果sum(x)&lt;=1，则x已经代表了每一块饼的权重，</span></span><br><span class="line"><span class="string">             此时并不会除以sum(x)。饼状图从x轴开始，逆时针绘制。</span></span><br><span class="line"><span class="string">explode：如果不是None，则它给出了每个饼的径向偏移量。该偏移量表示：径向偏移除以半径。</span></span><br><span class="line"><span class="string">colors：给出了每一块饼的颜色。可以为None或者颜色序列</span></span><br><span class="line"><span class="string">labels：给出了每个饼的字符串标签。可以为None或者字符串序列</span></span><br><span class="line"><span class="string">autopct：它可以为一个字符串，可以指定每个饼的数值标签，但是该字符串是 fmt%pct，</span></span><br><span class="line"><span class="string">         通过pct参数格式化，pct为饼的比重（自动提供）。也可以是一个可调用对象。</span></span><br><span class="line"><span class="string">pctdistance：若autopct为None，则忽略之。否则就是数值标签的径向距离，它是个相对距离，相对于半径。</span></span><br><span class="line"><span class="string">labeldistance：控制了饼的字符串标签的径向距离，它是个相对距离，相对于半径。</span></span><br><span class="line"><span class="string">shadow：一个布尔值，如果为True，则绘制带阴影的饼状图</span></span><br><span class="line"><span class="string">startangle：如果不是None，则它可控制了第一块饼与x轴的夹角</span></span><br><span class="line"><span class="string">radius：一个标量，控制了饼状图的半径。如果为None，则默认为 1</span></span><br><span class="line"><span class="string">counterclock：一个布尔值。如果为True，则为逆时针方向；否则为顺时针排列</span></span><br><span class="line"><span class="string">wedgeprops：一个字典，控制了每一块饼的某些属性，如线型</span></span><br><span class="line"><span class="string">textprops：一个字典，控制了饼的文字的一些属性</span></span><br><span class="line"><span class="string">center：一个二元的元组，指定了饼状图的中心</span></span><br><span class="line"><span class="string">frame：一个布尔值，控制是否绘制axes frame（也就是背后的数轴）。发现版本1.5.3中，开启它是个Bug，图形混乱。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">为了显示好看，建议使用ax.set_aspect(1)将Axes的长宽比设置为 1， 此时的饼状图是个圆形（否则为椭圆）。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">plot(*args, **kwargs)：绘制line或者marker。他返回line的列表。</span><br><span class="line">    plot(x,y)：最简单的用法，其中x为数据点的横坐标，y为数据点的纵坐标。</span><br><span class="line">               此时采用默认的线型和颜色。如果x/y为二维数组，那么每一行作为一组line来绘制。</span><br><span class="line">    plot(x,y,<span class="string">&#x27;bo&#x27;</span>)：可设置线型和颜色。<span class="string">&#x27;b&#x27;</span>代表颜色为蓝色，<span class="string">&#x27;o&#x27;</span>代表使用小圆圈标记数据点。<span class="string">&#x27;bo&#x27;</span>称作plot <span class="built_in">format</span> string</span><br><span class="line">    plot(y)：可省略x。此时隐含着x等于[<span class="number">0</span>,<span class="number">1</span>,...<span class="built_in">len</span>(y<span class="number">-1</span>)]</span><br><span class="line">    plot(x1,y1,<span class="string">&#x27;b+&#x27;</span>,x2,y2,<span class="string">&#x27;b-&#x27;</span>,x3,y3,<span class="string">&#x27;bo&#x27;</span>)：可一次绘制多条线</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">linestyle:&#x27;-&#x27;或者&#x27;solid&#x27;：表示实线</span></span><br><span class="line"><span class="string">          &#x27;--&#x27;或者dashed：表示虚线</span></span><br><span class="line"><span class="string">          &#x27;-.&#x27;或者dash_dot：表示点划线</span></span><br><span class="line"><span class="string">          &#x27;:&#x27;或者&#x27;dotted&#x27;：表示点线</span></span><br><span class="line"><span class="string">marker：&#x27;.&#x27;/&#x27;,&#x27;/&#x27;o&#x27;/&#x27;v&#x27;/&#x27;^&#x27;/&#x27;&lt;&#x27;/&#x27;&gt;&#x27;/&#x27;1&#x27;/&#x27;2&#x27;/&#x27;3&#x27;/&#x27;4&#x27;/</span></span><br><span class="line"><span class="string">        &#x27;s&#x27;/&#x27;p&#x27;/&#x27;*&#x27;/&#x27;h&#x27;/&#x27;H&#x27;/&#x27;+&#x27;/&#x27;x&#x27;/&#x27;D&#x27;/&#x27;d&#x27;/&#x27;|&#x27;/&#x27;_&#x27;</span></span><br><span class="line"><span class="string">color：&#x27;b&#x27;/&#x27;g&#x27;/&#x27;r&#x27;/&#x27;c&#x27;/&#x27;m&#x27;/&#x27;y&#x27;/&#x27;k&#x27;/&#x27;w&#x27;；</span></span><br><span class="line"><span class="string">        全名：&#x27;red&#x27;；</span></span><br><span class="line"><span class="string">        十六进制字符串：&#x27;#00ff00；</span></span><br><span class="line"><span class="string">        一个RGB/RGBA元组：(0,1,0)/(0,1,0,1)。</span></span><br><span class="line"><span class="string">默认情况下，不同的线采用不同的线型，它由rc的axes.prop_cycle参数控制，并且是循环使用。</span></span><br><span class="line"><span class="string">如果一个plot绘制了多条线，则其参数对所有的线起作用。这些关键字全部用于设定Line2D的属性。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">plot_date(x, y, fmt=<span class="string">&#x27;o&#x27;</span>, tz=<span class="literal">None</span>, xdate=<span class="literal">True</span>, ydate=<span class="literal">False</span>, **kwargs)：绘制日期相关的数据。</span><br><span class="line">它类似于plot()方法，但是plot_data的x轴或者y轴可能是日期相关的数据。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x/y：待绘制的点的坐标序列。如果是日期序列，则代表了从0001-01-01 UTC以来的天数（浮点数）（它映射到整数1）。</span></span><br><span class="line"><span class="string">     日期必须大于等于 0（1代表第一天），且日期跨度大于一个月（31天）</span></span><br><span class="line"><span class="string">fmt：plot format string，如bo</span></span><br><span class="line"><span class="string">tz：指定时区。可以为时区字符串，也可以为tzinfo实例或者None</span></span><br><span class="line"><span class="string">xdate：一个布尔值。如果为True，则x轴为时间序列</span></span><br><span class="line"><span class="string">ydate：一个布尔值。如果为True，则y轴为时间序列</span></span><br><span class="line"><span class="string">其他参数用于设定Line2D的属性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">注意：plot_date()使用默认的dates.AutoDateLocator/dates.AutoDateFormatter。</span></span><br><span class="line"><span class="string">     如果你希望使用自定义的，则你需要在调用plot_date()之后调用方法来设置date ticker/date formatter</span></span><br><span class="line"><span class="string">设置时区：</span></span><br><span class="line"><span class="string">    from datetime import timezone,timedelta</span></span><br><span class="line"><span class="string">    ax.plot_date(X,Y,tz=timezone(+timedelta(hours=23)))   </span></span><br><span class="line"><span class="string">设置日期格式化和位置：</span></span><br><span class="line"><span class="string">    from matplotlib.dates import AutoDateLocator,AutoDateFormatter,DateFormatter</span></span><br><span class="line"><span class="string">    autoloc = AutoDateLocator() #默认的 formatter</span></span><br><span class="line"><span class="string">    autofmt = AutoDateFormatter() #默认的 locator</span></span><br><span class="line"><span class="string">    myfmt = DateFormatter(&#x27;%Y-%m-%d %H:%M:%S&#x27;)#自定义的formatter,使用`strftime()`的格式化方式</span></span><br><span class="line"><span class="string">    ax.xaxis.set_major_locator(autodates)       #设置时间间隔</span></span><br><span class="line"><span class="string">    ax.xaxis.set_major_formatter(myfmt)      #设置时间显示格式</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">scatter(x, y, s=<span class="number">20</span>, c=<span class="literal">None</span>, marker=<span class="string">&#x27;o&#x27;</span>, cmap=<span class="literal">None</span>, norm=<span class="literal">None</span>, vmin=<span class="literal">None</span>, vmax=<span class="literal">None</span>, </span><br><span class="line">        alpha=<span class="literal">None</span>, linewidths=<span class="literal">None</span>, verts=<span class="literal">None</span>, edgecolors=<span class="literal">None</span>, **kwargs)：</span><br><span class="line">        绘制散点图。返回一个PathCollection实例。</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x/y：数据的x坐标和y坐标，要求它们形状为(n,)</span></span><br><span class="line"><span class="string">s:指定散点的尺寸，可以为标量，也可以为一个长度为n的序列（序列配合c和cmap使用，c也必须为序列）</span></span><br><span class="line"><span class="string">c：指定散点的颜色字符。可以为一个颜色，或者颜色序列（序列配合cmap使用）</span></span><br><span class="line"><span class="string">marker：指定散点的类型，默认为&#x27;o&#x27;。可以为：</span></span><br><span class="line"><span class="string">        &#x27;.&#x27;,&#x27;,&#x27;,&#x27;o&#x27;,&#x27;v&#x27;,&#x27;^&#x27;,&#x27;&lt;&#x27;,&#x27;&gt;&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;s&#x27;,&#x27;p&#x27;,</span></span><br><span class="line"><span class="string">       &#x27;*&#x27;,&#x27;h&#x27;,&#x27;H&#x27;,&#x27;+&#x27;,&#x27;x&#x27;,&#x27;D&#x27;,&#x27;d&#x27;,&#x27;|&#x27;,&#x27;_&#x27;,&#x27;None&#x27;,None,&#x27; &#x27;,&#x27;&#x27;,&#x27;$...$&#x27;之一。</span></span><br><span class="line"><span class="string">       也可以为一个Path实例。也可以是一个元组(numsided,style,angle)：</span></span><br><span class="line"><span class="string">            numsided指定了边的数量</span></span><br><span class="line"><span class="string">            style：可以为0(正多边形）；1（星星状的符号）；2（一个*）;3（一个圆，此时numsided,angle被忽略）</span></span><br><span class="line"><span class="string">            angle：指定了散点旋转的角度（按照角度制而不是弧度制）</span></span><br><span class="line"><span class="string">cmap：设定一个colormap。可以是Colormap实例，或者它的名字。只有当c参数为一列浮点数时有效！</span></span><br><span class="line"><span class="string">norm：一个Normalize实例，用于将亮度调整到0~1</span></span><br><span class="line"><span class="string">vmin,vmax：一个标量，用于辅助默认的norm调整亮度（如果你传入了一个Normalize实例给norm，则该参数忽略）</span></span><br><span class="line"><span class="string">alpha：一个标量，设置透明度</span></span><br><span class="line"><span class="string">linewidths：一个标量或者序列，设置线宽</span></span><br><span class="line"><span class="string">edgecolors：设定边线的颜色，可以为一个颜色，或者颜色序列</span></span><br><span class="line"><span class="string">其他参数用于设定Collection参数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">我的经验是，数据密集的图形，使用plot绘制散点图效率会更高。</span></span><br><span class="line"><span class="string">因为plot的配置适用于所有点，而scatter对每个点都要渲染一遍。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">xcorr(x, y, normed=<span class="literal">True</span>, detrend=&lt;function detrend_none&gt;, </span><br><span class="line">     usevlines=<span class="literal">True</span>, maxlags=<span class="number">10</span>, **kwargs)：绘制互相关图。参数解释参考acorr()自相关函数。</span><br></pre></td></tr></table></figure></p>
<h2 id="Axis"><a href="#Axis" class="headerlink" title="Axis"></a>Axis</h2><p>matplotlib.axis.Axis实例处理tick line、grid line、tick label以及axis label的绘制，它包括坐标轴上的刻度线、刻度label、坐标网格、坐标轴标题。<br>通常你可以独立的配置y轴的左边刻度以及右边的刻度，也可以独立地配置x轴的上边刻度以及下边的刻度。刻度包括主刻度和次刻度，它们都是Tick刻度对象。</p>
<p>Axis也存储了数据用于内部的缩放以及自适应处理。它还有Locator实例和Formatter实例用于控制刻度线的位置以及刻度label。</p>
<p>每个Axis都有一个.label属性，也有主刻度列表和次刻度列表。这些tick是XTick和YTick的实例，他们存放着实际的line primitive以及text primitive来渲染刻度线以及刻度文本。</p>
<p>Axis也提供了一些辅助方法来获取刻度文本、刻度线位置等方法，更多方法请参考<span class="exturl" data-url="aHR0cHM6Ly9tYXRwbG90bGliLm9yZy9zdGFibGUvYXBpL2F4aXNfYXBpLmh0bWw/aGlnaGxpZ2h0PXhheGlzI21hdHBsb3RsaWIuYXhpcy5YQXhpcw==">axis<i class="fa fa-external-link-alt"></i></span>：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Axis.get_major_ticks()：获取主刻度列表(一个Tick对象的列表)</span><br><span class="line"></span><br><span class="line">Axis.get_minor_ticks()：获取次刻度列表(一个Tick对象的列表)</span><br><span class="line"></span><br><span class="line">Axis.get_majorticklabels()：获取主刻度label列表(一个Text对象的列表)</span><br><span class="line"></span><br><span class="line">Axis.get_majorticklines():获取主刻度线(一个Line2D对象的列表)</span><br><span class="line"></span><br><span class="line">Axis.get_ticklocs()：获取刻度线位置的列表。可通过minor=<span class="literal">True</span>|<span class="literal">False</span>控制输出minor还是major的tick location。</span><br><span class="line"></span><br><span class="line">Axis.get_ticklabels()：获取刻度label列表(一个Text实例的列表）。可通过minor=<span class="literal">True</span>|<span class="literal">False</span>控制输出minor还是major的tick label。</span><br><span class="line"></span><br><span class="line">Axis.get_ticklines()：获取刻度线列表(一个Line2D实例的列表）。可通过minor=<span class="literal">True</span>|<span class="literal">False</span>控制输出minor还是major的tick line。</span><br><span class="line"></span><br><span class="line">Axis.get_scale()：获取坐标轴的缩放属性，如<span class="string">&#x27;log&#x27;</span>或者<span class="string">&#x27;linear&#x27;</span></span><br><span class="line"></span><br><span class="line">Axis.get_view_interval():获取内部的axis view limits实例</span><br><span class="line"></span><br><span class="line">Axis.get_data_interval():获取内部的axis data limits实例</span><br><span class="line"></span><br><span class="line">Axis.get_gridlines():获取grid line的列表</span><br><span class="line"></span><br><span class="line">Axis.get_label():获取axis label(一个Text实例)</span><br><span class="line"></span><br><span class="line">Axis.get_label_text():获取axis label的字符串</span><br><span class="line"></span><br><span class="line">Axis.get_major_locator():获取major tick locator(一个matplotlib.ticker.Locator实例)</span><br><span class="line"></span><br><span class="line">Axis.get_minor_locator():获取minor tick locator(一个matplotlib.ticker.Locator实例)</span><br><span class="line"></span><br><span class="line">Axis.get_major_formatter():获取major tick formatter(一个matplotlib.ticker.Formatter实例)</span><br><span class="line"></span><br><span class="line">Axis.get_minor_formatter():获取minor tick formatter(一个matplotlib.ticker.Formatter实例)</span><br><span class="line"></span><br><span class="line">Axis.grid(b=<span class="literal">None</span>,which=<span class="string">&#x27;major&#x27;</span>,**kwargs):一个开关，用于控制major或者minor的tick的on|off</span><br><span class="line"></span><br><span class="line">Axis.cla()：清除axis</span><br><span class="line">Axis.axis_date(tz=<span class="literal">None</span>)：将x轴视作时间轴。</span><br></pre></td></tr></table></figure><br>当然，设置这些属性可通过<code>set_xxx()</code>方法，进行对应的设置。</p>
<p>获取对应实例后，可以对其做很多修改。比如获取刻度label之后，可以设置其各种属性，对刻度label旋转30度：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> axis.get_majorticklabels():</span><br><span class="line">    line.set_rotation(<span class="number">30</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="Tick"><a href="#Tick" class="headerlink" title="Tick"></a>Tick</h2><p>matplotlib.axis.Tick类是从Figure—&gt;Axes—&gt;Tick这个container体系中最末端的container。Tick容纳了tick、grid line以及tick对应的label。所有的这些都可以通过Tick的属性获取:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Tick.tick1line：一个Line2D实例</span><br><span class="line">Tick.tick2line：一个Line2D实例</span><br><span class="line">Tick.gridline：一个Line2D实例</span><br><span class="line">Tick.label1：一个Text实例</span><br><span class="line">Tick.label2：一个Text实例</span><br><span class="line">Tick.gridOn：一个布尔值，决定了是否绘制tickline</span><br><span class="line">Tick.tick1On：一个布尔值，决定了是否绘制1st tickline</span><br><span class="line">Tick.tick2On：一个布尔值，决定了是否绘制2nd tickline</span><br><span class="line">Tick.label1On：一个布尔值，决定了是否绘制1st tick label</span><br><span class="line">Tick.label2On：一个布尔值，决定了是否绘制2nd tick label</span><br></pre></td></tr></table></figure><br>y轴分为左右两个，因此<code>tick1*对应左侧的轴</code>；<code>tick2*对应右侧的轴</code>。 x轴分为上下两个，因此<code>tick1*对应下侧的轴</code>；<code>tick2*对应上侧的轴</code>。</p>
<p>Tick 方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">get_loc()：以标量的形式返回Tick的坐标</span><br><span class="line">get_pad()：返回Tick的label和刻度线之间的距离（单位为像素点）</span><br><span class="line">set_label(s)&#x2F;set_label1(s)&#x2F;set_label2(s)：设置label</span><br><span class="line">set_pad(val)：设置Tick的label和刻度线之间的距离（单位为像素点）</span><br></pre></td></tr></table></figure></p>
<h2 id="primitive"><a href="#primitive" class="headerlink" title="primitive"></a>primitive</h2><h3 id="Line2D"><a href="#Line2D" class="headerlink" title="Line2D"></a>Line2D</h3><p>matplotlib.lines.Line2D类是matplotlib中的曲线类（基类是matplotlib.artist.Artist），它可以有各种各样的颜色、类型、以及标注<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">Line2D(xdata, ydata, linewidth=<span class="literal">None</span>, linestyle=<span class="literal">None</span>,</span><br><span class="line">  color=<span class="literal">None</span>, marker=<span class="literal">None</span>, markersize=<span class="literal">None</span>, markeredgewidth</span><br><span class="line">  =<span class="literal">None</span>, markeredgecolor=<span class="literal">None</span>, markerfacecolor</span><br><span class="line">  =<span class="literal">None</span>, markerfacecoloralt=’none’, fillstyle=<span class="literal">None</span>,</span><br><span class="line">  antialiased=<span class="literal">None</span>, dash_capstyle=<span class="literal">None</span>, solid_capstyle=<span class="literal">None</span>,</span><br><span class="line">  dash_joinstyle=<span class="literal">None</span>, solid_joinstyle=<span class="literal">None</span>, pickradius=<span class="number">5</span>,</span><br><span class="line">  drawstyle=<span class="literal">None</span>, markevery=<span class="literal">None</span>, **kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">这些关键字参数都是Line2D的属性。其属性有：</span></span><br><span class="line"><span class="string">    继承自Artist基类的属性：.alpha、.animated、.axes、.clip_box、</span></span><br><span class="line"><span class="string">        .clip_on、.clip_path、.contains、 .figure、.gid、.label、</span></span><br><span class="line"><span class="string">        .picker、.transform、.url、.visible、.zorder</span></span><br><span class="line"><span class="string">    .antialiased/.aa：一个布尔值。如果为True则表示线条是抗锯齿处理的</span></span><br><span class="line"><span class="string">    .color/.c：一个matplotlib color值，表示线条的颜色，</span></span><br><span class="line"><span class="string">    .dash_capstyle：为&#x27;butt&#x27; or &#x27;round&#x27; or &#x27;projecting&#x27;，表示虚线头端类型</span></span><br><span class="line"><span class="string">    .dash_joinstyle：为&#x27;miter&#x27; or &#x27;round&#x27; or &#x27;bevel&#x27;，表示虚线连接处类型</span></span><br><span class="line"><span class="string">    .dashes：一个数值序列，表示虚线的实部、虚部的尺寸。如果为(None,None)则虚线成为实线</span></span><br><span class="line"><span class="string">    .drawstyle：为&#x27;default&#x27;or&#x27;steps&#x27;or&#x27;step-pre&#x27;or&#x27;step-mid&#x27;or&#x27;step-post&#x27;，表示曲线类型。</span></span><br><span class="line"><span class="string">                &#x27;default&#x27;：点之间以直线连接</span></span><br><span class="line"><span class="string">                &#x27;steps*&#x27;：绘制阶梯图。其中steps等价于steps-pre，是为了保持兼容旧代码</span></span><br><span class="line"><span class="string">    .fillstyle：为&#x27;full&#x27;or&#x27;left&#x27;or&#x27;right&#x27;or&#x27;bottom&#x27;or&#x27;top&#x27;or&#x27;none&#x27;表示marker的填充类型。</span></span><br><span class="line"><span class="string">                &#x27;full&#x27;：填充整个marker</span></span><br><span class="line"><span class="string">                none：不填充marker</span></span><br><span class="line"><span class="string">                其他值：表示填充一半marker</span></span><br><span class="line"><span class="string">    .linestyle/.ls：指定线型，可以为以下值：</span></span><br><span class="line"><span class="string">            &#x27;-&#x27;或者&#x27;solid&#x27;：表示实线</span></span><br><span class="line"><span class="string">            &#x27;--&#x27;或者dashed：表示虚线</span></span><br><span class="line"><span class="string">            &#x27;-.&#x27;或者dash_dot：表示点划线</span></span><br><span class="line"><span class="string">            &#x27;:&#x27;或者&#x27;dotted&#x27;：表示点线</span></span><br><span class="line"><span class="string">            &#x27;None&#x27;或者&#x27; &#x27;或者&#x27;&#x27;：表示没有线条（不画线）</span></span><br><span class="line"><span class="string">    .linewidth/.lw：为浮点值，表示线条宽度</span></span><br><span class="line"><span class="string">    .marker：可以为一系列的字符串，如&#x27;.&#x27;、&#x27;,&#x27;、&#x27;o&#x27;....,表示线条的marker</span></span><br><span class="line"><span class="string">    .markeredgecolor/.mec:可以为matplotlib color，表示marker的边的颜色</span></span><br><span class="line"><span class="string">    .markeredgewidth/.mew:可以为浮点数，表示marker边的宽度</span></span><br><span class="line"><span class="string">    .markerfacecolor/.mfc：可以为matplotlib color，表示marker的前景色</span></span><br><span class="line"><span class="string">    .markerfacecoloralt/.mfcalt：可以为matplotlib color，表示marker的可选前景色</span></span><br><span class="line"><span class="string">    .markersize/.ms：可以为浮点数，表示marker的大小</span></span><br><span class="line"><span class="string">    .markevery：指定每隔多少个点绘制一个marker，可以为以下值，其他值参考文档：</span></span><br><span class="line"><span class="string">            None：表示每个点都绘制marker</span></span><br><span class="line"><span class="string">            N：表示每隔N个点绘制marker，从0开始</span></span><br><span class="line"><span class="string">            (start,N)：表示每隔N个点绘制marker，从start开始</span></span><br><span class="line"><span class="string">            [i,j,m,n]：只有点i,j,m,n的marker绘制</span></span><br><span class="line"><span class="string">    .pickradius：浮点值，表示pick radius</span></span><br><span class="line"><span class="string">    .solid_capstyle：可以为&#x27;butt&#x27;、&#x27;round&#x27;、&#x27;projecting&#x27;，表示实线的头端类型</span></span><br><span class="line"><span class="string">    .sold_joinstyle：可以为&#x27;miter&#x27;、&#x27;round&#x27;、&#x27;bevel&#x27;，表示实线连接处的类型</span></span><br><span class="line"><span class="string">    .xdata：可以为一维的numpy.array，表示x轴数据</span></span><br><span class="line"><span class="string">    .ydata：可以为一维的numpy.array，表示y轴数据</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Text"><a href="#Text" class="headerlink" title="Text"></a>Text</h3><p>matplotlib.text.Text类是绘制文字的类（基类是matplotlib.artist.Artist）。它的构造函数为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">Text(x=<span class="number">0</span>, y=<span class="number">0</span>, text=<span class="string">&#x27;&#x27;</span>, color=<span class="literal">None</span>, verticalalignment=<span class="string">&#x27;baseline&#x27;</span>,</span><br><span class="line">  horizontalalignment=’left’, multialignment=<span class="literal">None</span>, fontproperties</span><br><span class="line">  =<span class="literal">None</span>, rotation=<span class="literal">None</span>, linespacing=<span class="literal">None</span>, rotation_</span><br><span class="line">  mode=<span class="literal">None</span>, usetex=<span class="literal">None</span>, wrap=<span class="literal">False</span>, **kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">这些关键字参数也是属性。其属性有：</span></span><br><span class="line"><span class="string">    继承自Artist基类的属性： .alpha、.animated、.axes、.clip_box、</span></span><br><span class="line"><span class="string">        .clip_on、.clip_path、.contains、.figure、.gid、</span></span><br><span class="line"><span class="string">        .label、.picker、.transform、.url、.visible、.zorder</span></span><br><span class="line"><span class="string">    .backgroundcolor：背景色，可以为任何matplotlib color</span></span><br><span class="line"><span class="string">    .bbox：文本框的边框。其值是FancyBboxPatch类的属性字典。</span></span><br><span class="line"><span class="string">    .color：字体颜色，可以为任何matplotlib color</span></span><br><span class="line"><span class="string">    .family/.name/.fontfamily/.fontname：字体的名字。</span></span><br><span class="line"><span class="string">        可以是string或者string list（表示可以为若干个名字，优先级依次递减）。</span></span><br><span class="line"><span class="string">        string必须是一个真实字体的名字，或者一个字体的class name。</span></span><br><span class="line"><span class="string">    .fontproperties/.font_properties：字体的属性。</span></span><br><span class="line"><span class="string">        值是一个matplotlib.font_manager.FontProperties实例，该实例一次性设置字体的很多属性：</span></span><br><span class="line"><span class="string">            比如字体类型、字体名字、字体大小、宽度等等。</span></span><br><span class="line"><span class="string">    .horizontalalignment/.ha：水平对齐方式，可以为&#x27;center&#x27;、&#x27;right&#x27;、&#x27;left&#x27;</span></span><br><span class="line"><span class="string">    .linespacing：为浮点数，单位为font size，表示行间距</span></span><br><span class="line"><span class="string">    .multialignment：multiline text对齐方式，可以为&#x27;left&#x27;、&#x27;right&#x27;、&#x27;center&#x27;</span></span><br><span class="line"><span class="string">    .position：为一个元组(x,y)，表示文本框的位置</span></span><br><span class="line"><span class="string">    .rotation：字体旋转角度。可以为下列值：</span></span><br><span class="line"><span class="string">        浮点数，表示角度</span></span><br><span class="line"><span class="string">        &#x27;vertical&#x27;、&#x27;horizontal&#x27;</span></span><br><span class="line"><span class="string">    .rotation_mode：旋转模式。可以为下列值：</span></span><br><span class="line"><span class="string">        &#x27;anchor&#x27;：文本首先对齐，然后根据对齐点来旋转</span></span><br><span class="line"><span class="string">        None：文本先旋转，再对齐</span></span><br><span class="line"><span class="string">    .size或者.fontsize：字体大小。可以为下列值：</span></span><br><span class="line"><span class="string">        浮点值，表示字体大小</span></span><br><span class="line"><span class="string">        &#x27;xx-small&#x27;、&#x27;x-small&#x27;、&#x27;small&#x27;、&#x27;medium&#x27;、&#x27;large&#x27;、&#x27;x-large&#x27;、&#x27;xx-large&#x27;</span></span><br><span class="line"><span class="string">    .stretch/.fontstretch：字体沿水平方向的拉伸。可以为下列值：</span></span><br><span class="line"><span class="string">        整数，在[0---1000]之间</span></span><br><span class="line"><span class="string">        &#x27;ultra-condensed&#x27;、&#x27;extra-condensed&#x27;、&#x27;condensed&#x27;、&#x27;semi-condensed&#x27;、</span></span><br><span class="line"><span class="string">        &#x27;normal&#x27;、&#x27;semi-expanded&#x27;、&#x27;expanded&#x27;、&#x27;extra-expanded&#x27;、&#x27;ultra-expanded&#x27;</span></span><br><span class="line"><span class="string">    .style/.fontstyle：字体样式，可以为&#x27;normal&#x27;、&#x27;italic&#x27;、&#x27;oblique&#x27;</span></span><br><span class="line"><span class="string">    .text:文本字符串，可以为任意字符串（他可以包含&#x27;\n&#x27;换行符或者LATEX语法）</span></span><br><span class="line"><span class="string">    .variant/.fontvariant：表示字体形变，可以为下列值：&#x27;normal&#x27;、&#x27;small-caps&#x27;</span></span><br><span class="line"><span class="string">    .verticalalignment/.ma/.va：表示文本的垂直对齐，可以为&#x27;center&#x27;、&#x27;top&#x27;、&#x27;bottom&#x27;、&#x27;baseline&#x27;</span></span><br><span class="line"><span class="string">    .weight/.fontweight：设置字体的weight，可以为下列值：</span></span><br><span class="line"><span class="string">        一个整数值，在[0---1000]之间</span></span><br><span class="line"><span class="string">        &#x27;ultralight&#x27;、&#x27;light&#x27;、&#x27;normal&#x27;、&#x27;regular&#x27;、&#x27;book&#x27;、&#x27;medium&#x27;、</span></span><br><span class="line"><span class="string">        &#x27;roman&#x27;、&#x27;semibold&#x27;、&#x27;demibold&#x27;、&#x27;demi&#x27;、&#x27;bold&#x27;、&#x27;heavy&#x27;、</span></span><br><span class="line"><span class="string">        &#x27;extrabold&#x27;、&#x27;black&#x27;</span></span><br><span class="line"><span class="string">    .x：一个浮点值，表示文本框位置的x值</span></span><br><span class="line"><span class="string">    .y：一个浮点值，表示文本框位置的y值</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br>可以通过<code>ax.text(*args,**kwargs)</code>设置文字，参数就是Text的属性。</p>
<h3 id="Annotation"><a href="#Annotation" class="headerlink" title="Annotation"></a>Annotation</h3><p>matplotlib.text.Annotation类是图表中的图式，它是一个带箭头的文本框，用于解说图表中的图形。它的基类是matplotlib.text.Text和matplotlib.text._AnnotationBase。其构造函数为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Annotation(s, xy, xytext=<span class="literal">None</span>, xycoords=’data’, textcoords=<span class="literal">None</span>, arrowprops</span><br><span class="line">  =<span class="literal">None</span>, annotation_clip=<span class="literal">None</span>, **kwargs)</span><br><span class="line"><span class="comment"># 在位置xytext处放置一个文本框，该文本框用于解释点xy，文本框的文本为s。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">s：文本框的文本字符串</span></span><br><span class="line"><span class="string">xy：被解释的点的坐标</span></span><br><span class="line"><span class="string">xytext：文本框放置的位置。如果为None，则默认取xy</span></span><br><span class="line"><span class="string">xycoords：xy坐标系，默认取&#x27;data&#x27;坐标系（即xy是数据坐标系中的点）。可以为以下值：</span></span><br><span class="line"><span class="string">    &#x27;figure points&#x27;：从figure左下角开始的点</span></span><br><span class="line"><span class="string">    &#x27;figure pixesl&#x27;：从figure左下角开始的像素值</span></span><br><span class="line"><span class="string">    &#x27;figure fraction&#x27;：(0,0)代表figure的左下角，(1,1)代表figure的右上角</span></span><br><span class="line"><span class="string">    &#x27;axes points&#x27;：从axes左下角开始的点</span></span><br><span class="line"><span class="string">    &#x27;axes pixels&#x27;：从axes左下角开始的像素</span></span><br><span class="line"><span class="string">    &#x27;axes fraction&#x27;：(0,0)代表axes的左下角，(1,1)代表axes的右上角</span></span><br><span class="line"><span class="string">    &#x27;data&#x27;：使用被标注对象的坐标系</span></span><br><span class="line"><span class="string">    &#x27;offset points&#x27;：指定从xy的偏移点</span></span><br><span class="line"><span class="string">    &#x27;polar&#x27;：极坐标系</span></span><br><span class="line"><span class="string">textcoords：文本框坐标系（即xytext是文本坐标系中的点），默认等于xycoords</span></span><br><span class="line"><span class="string">arrowprops：指定文本框和被解释的点之间的箭头。如果不是None，则是一个字典，该字典设定了matplotlib.lines.Line2D的属性。</span></span><br><span class="line"><span class="string">            如果该字典有一个arrowstyle属性，则该键的值也是一个字典，创建一个FancyArrowsPatch实例，实例属性由该字典指定。</span></span><br><span class="line"><span class="string">            如果该字典没有arrowstyle属性，则创建一个YAArrow实例，</span></span><br><span class="line"><span class="string">annotation_clip：控制超出axes区域的annotation的显示。如果为True则annotation 只显示位于axes区域内的内容。</span></span><br><span class="line"><span class="string">额外的关键字参数全部是设置Text的属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Legend"><a href="#Legend" class="headerlink" title="Legend"></a>Legend</h3><p>matplotlib.legend.Legend是图例类，它的基类是matplotlib.artist.Artist。其构造函数为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Legend(parent, handles, labels, loc=<span class="literal">None</span>, numpoints=<span class="literal">None</span>, markerscale</span><br><span class="line">  =<span class="literal">None</span>, markerfirst=<span class="literal">True</span>, scatterpoints=<span class="literal">None</span>,</span><br><span class="line">  scatteryoffsets=<span class="literal">None</span>, prop=<span class="literal">None</span>, fontsize=<span class="literal">None</span>, borderpad</span><br><span class="line">  =<span class="literal">None</span>, labelspacing=<span class="literal">None</span>, handlelength=<span class="literal">None</span>,</span><br><span class="line">  handleheight=<span class="literal">None</span>, handletextpad=<span class="literal">None</span>, borderaxespad</span><br><span class="line">  =<span class="literal">None</span>, columnspacing=<span class="literal">None</span>, ncol=<span class="number">1</span>, mode=<span class="literal">None</span>,</span><br><span class="line">  fancybox=<span class="literal">None</span>, shadow=<span class="literal">None</span>, title=<span class="literal">None</span>, framealpha</span><br><span class="line">  =<span class="literal">None</span>, bbox_to_anchor=<span class="literal">None</span>, bbox_transform=<span class="literal">None</span>,</span><br><span class="line">  frameon=<span class="literal">None</span>, handler_map=<span class="literal">None</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">parent：持有该legend的artist</span></span><br><span class="line"><span class="string">loc:图例的位置。其值可以为字符串或者数字：</span></span><br><span class="line"><span class="string">    best或0：自动计算</span></span><br><span class="line"><span class="string">    upper right或1： 右上角</span></span><br><span class="line"><span class="string">    upper left或2：上角</span></span><br><span class="line"><span class="string">    lower left或3：下角</span></span><br><span class="line"><span class="string">    lower right或4：右下角</span></span><br><span class="line"><span class="string">    right或5：右边</span></span><br><span class="line"><span class="string">    center left或6：中间偏左</span></span><br><span class="line"><span class="string">    center right或7：中间偏右</span></span><br><span class="line"><span class="string">    lower center或8：中间底部</span></span><br><span class="line"><span class="string">    upper center或9：中间顶部</span></span><br><span class="line"><span class="string">    center或10：正中央</span></span><br><span class="line"><span class="string">handle：一个artist列表，添加这些artist到legend中</span></span><br><span class="line"><span class="string">lebels：一个字符串列表添加到legend中</span></span><br><span class="line"><span class="string">prop:字体属性</span></span><br><span class="line"><span class="string">fontsize: 字体大小（只有prop未设置时有效）</span></span><br><span class="line"><span class="string">markerscale: marker的缩放比例（相对于原始大小）</span></span><br><span class="line"><span class="string">markerfirst: 如果为True，则marker放在label左侧；否则marker放在label右侧</span></span><br><span class="line"><span class="string">numpoints: the number of points in the legend for line</span></span><br><span class="line"><span class="string">scatterpoints: the number of points in the legend for scatter plot</span></span><br><span class="line"><span class="string">scatteryoffsets: a list of offsets for scatter symbols in legend</span></span><br><span class="line"><span class="string">frameon: if True, draw a frame around the legend. If None, use rc</span></span><br><span class="line"><span class="string">fancybox: if True, draw a frame with a round fancybox. If None, use rc</span></span><br><span class="line"><span class="string">shadow: if True, draw a shadow behind legend</span></span><br><span class="line"><span class="string">framealpha: If not None, alpha channel for the frame.</span></span><br><span class="line"><span class="string">ncol: number of columns</span></span><br><span class="line"><span class="string">borderpad: the fractional whitespace inside the legend border</span></span><br><span class="line"><span class="string">labelspacing: the vertical space between the legend entries</span></span><br><span class="line"><span class="string">handlelength: the length of the legend handles</span></span><br><span class="line"><span class="string">handleheight: the height of the legend handles</span></span><br><span class="line"><span class="string">handletextpad: the pad between the legend handle and text</span></span><br><span class="line"><span class="string">borderaxespad: the pad between the axes and legend border</span></span><br><span class="line"><span class="string">columnspacing:the spacing between columns</span></span><br><span class="line"><span class="string">title: 图例的标题</span></span><br><span class="line"><span class="string">bbox_to_anchor: the bbox that the legend will be anchored.</span></span><br><span class="line"><span class="string">bbox_transform: the transform for the bbox. transAxes if Noneloc a location code</span></span><br><span class="line"><span class="string">其他关键字参数用于设置属性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">继承自Artist基类的属性：</span></span><br><span class="line"><span class="string">.alpha、.animated、.axes、.clip_box、..clip_on、.clip_path、.contains、</span></span><br><span class="line"><span class="string">.figure、.gid、.label、.picker、.transform、.url、.visible、.zorder</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Patch"><a href="#Patch" class="headerlink" title="Patch"></a>Patch</h3><p>matplotlib.patches.Patch类是二维图形类。它的基类是matplotlib.artist.Artist。其构造函数为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> Patch(edgecolor=<span class="literal">None</span>, facecolor=<span class="literal">None</span>, color=<span class="literal">None</span>,</span><br><span class="line">  linewidth=<span class="literal">None</span>, linestyle=<span class="literal">None</span>, antialiased=<span class="literal">None</span>,</span><br><span class="line">  hatch=<span class="literal">None</span>, fill=<span class="literal">True</span>, capstyle=<span class="literal">None</span>, joinstyle=<span class="literal">None</span>,</span><br><span class="line">  **kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">edgecolor：可以为matplotlib color，表示边线条的颜色，若为none则表示无颜色</span></span><br><span class="line"><span class="string">facecolor：可以为matplotlib color，表示前景色，若为none则表示无颜色</span></span><br><span class="line"><span class="string">color可以为matplotlib color，表示边线条和前景色的颜色。</span></span><br><span class="line"><span class="string">linewidth：为浮点数，表示线条宽度</span></span><br><span class="line"><span class="string">linestyle：指定线型，可以为以下值：</span></span><br><span class="line"><span class="string">            &#x27;-&#x27;或者&#x27;solid&#x27;：表示实线</span></span><br><span class="line"><span class="string">            &#x27;--&#x27;或者dashed：表示虚线</span></span><br><span class="line"><span class="string">            &#x27;-.&#x27;或者dash_dot：表示点划线</span></span><br><span class="line"><span class="string">            &#x27;:&#x27;或者&#x27;dotted&#x27;：表示点线</span></span><br><span class="line"><span class="string">            &#x27;None&#x27;或者&#x27; &#x27;或者&#x27;&#x27;：表示没有线条（不画线）</span></span><br><span class="line"><span class="string">antialiased：一个布尔值。如果为True则表示线条是抗锯齿处理的</span></span><br><span class="line"><span class="string">hatch：设置hatching pattern，可以为下列的值：</span></span><br><span class="line"><span class="string">        &#x27;\&#x27;、&#x27;|&#x27;、&#x27;-&#x27;、&#x27;+&#x27;、&#x27;x&#x27;、&#x27;o&#x27;、&#x27;0&#x27;、&#x27;.&#x27;、&#x27;*&#x27;</span></span><br><span class="line"><span class="string">fill：为布尔值。如果为True则填充图形，否则不填充</span></span><br><span class="line"><span class="string">capstyle：为&#x27;butt&#x27; or &#x27;round&#x27; or &#x27;projecting&#x27;，表示线条头端类型</span></span><br><span class="line"><span class="string">joinstyle：可以为&#x27;miter&#x27;、&#x27;round&#x27;、&#x27;bevel&#x27;，表示矩形线条接头类型</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其他关键字参数用于设置属性。</span></span><br><span class="line"><span class="string">如果 edgecolor, facecolor, linewidth, or antialiased 为None则这些值从rc params中读取</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">属性如下：</span></span><br><span class="line"><span class="string">继承自Artist基类的属性： .alpha、.animated、.axes、.clip_box、</span></span><br><span class="line"><span class="string">                       .clip_on、.clip_path、.contains、.figure、.gid、</span></span><br><span class="line"><span class="string">                       .label、path_effects、.picker、.transform、.url、.visible、.zorder</span></span><br><span class="line"><span class="string">.antialiased/.aa：一个布尔值。如果为True则表示线条是抗锯齿处理的</span></span><br><span class="line"><span class="string">.capstyle：为&#x27;butt&#x27; or &#x27;round&#x27; or &#x27;projecting&#x27;，表示线条头端类型</span></span><br><span class="line"><span class="string">.color：可以为matplotlib color，表示边线条和前景色的颜色。</span></span><br><span class="line"><span class="string">.edgecolor/.ec：可以为matplotlib color，表示边线条的颜色，若为none则表示无颜色</span></span><br><span class="line"><span class="string">.facecolor/.fc：可以为matplotlib color，表示前景色，若为none则表示无颜色</span></span><br><span class="line"><span class="string">.fill：为布尔值。如果为True则填充图形，否则不填充</span></span><br><span class="line"><span class="string">.hatch：设置hatching pattern，可以为下列的值：</span></span><br><span class="line"><span class="string">            &#x27;\&#x27;、&#x27;|&#x27;、&#x27;-&#x27;、&#x27;+&#x27;、&#x27;x&#x27;、&#x27;o&#x27;、&#x27;0&#x27;、&#x27;.&#x27;、&#x27;*&#x27;</span></span><br><span class="line"><span class="string">.joinstyle：可以为&#x27;miter&#x27;、&#x27;round&#x27;、&#x27;bevel&#x27;，表示矩形线条接头类型</span></span><br><span class="line"><span class="string">.linestyle/.ls：指定线型，可以为以下值：</span></span><br><span class="line"><span class="string">                    &#x27;-&#x27;或者&#x27;solid&#x27;：表示实线</span></span><br><span class="line"><span class="string">                    &#x27;--&#x27;或者dashed：表示虚线</span></span><br><span class="line"><span class="string">                    &#x27;-.&#x27;或者dash_dot：表示点划线</span></span><br><span class="line"><span class="string">                    &#x27;:&#x27;或者&#x27;dotted&#x27;：表示点线</span></span><br><span class="line"><span class="string">                    &#x27;None&#x27;或者&#x27; &#x27;或者&#x27;&#x27;：表示没有线条（不画线）</span></span><br><span class="line"><span class="string">.linewidth/.lw：为浮点数，表示线条宽度</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Rectangle"><a href="#Rectangle" class="headerlink" title="Rectangle"></a>Rectangle</h3><p>matplotlib.patches.Rectangle类是矩形类（基类是matplotlib.patches.Patch），其构造函数为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Rectangle(xy,width,height,angle=<span class="number">0.0</span>,**kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xy：矩形左下角坐标</span></span><br><span class="line"><span class="string">width：矩形宽度</span></span><br><span class="line"><span class="string">height：矩形高度</span></span><br><span class="line"><span class="string">其他关键字参数用于设置属性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其属性有：</span></span><br><span class="line"><span class="string">继承自Artist基类的属性：.alpha、.animated、.axes、.clip_box、.clip_on、.clip_path、</span></span><br><span class="line"><span class="string">                      .contains、.figure、.gid、.label、.picker、.transform、</span></span><br><span class="line"><span class="string">                      .url、.visible、.zorder</span></span><br><span class="line"><span class="string">继承自Patch基类的属性：.antialiased/.aa、.capstyle、.color、.edgecolor/.ec、</span></span><br><span class="line"><span class="string">                     .facecolor/.fc、.fill、.hatch、.joinstyle、.linestyle/.ls、.linewidth/.lw</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Polygon"><a href="#Polygon" class="headerlink" title="Polygon"></a>Polygon</h3><p>matplotlib.patches.Polygon类是多边形类。其基类是matplotlib.patches.Patch。其构造函数为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Polygon(xy, closed=<span class="literal">True</span>, **kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xy：是一个N×2的numpy array，为多边形的顶点。</span></span><br><span class="line"><span class="string">closed：为True则指定多边形将起点和终点重合从而显式关闭多边形。</span></span><br><span class="line"><span class="string">其他关键字参数用于设置属性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Polygon的属性有：</span></span><br><span class="line"><span class="string">继承自Artist基类的属性：.alpha、.animated、.axes、.clip_box、</span></span><br><span class="line"><span class="string">                      .clip_on、.clip_path、.contains、.figure、</span></span><br><span class="line"><span class="string">                      .gid、.label、.picker、.transform、.url、.visible、.zorder</span></span><br><span class="line"><span class="string">继承自Patch基类的属性：.antialiased/.aa、.capstyle、.color、.edgecolor/.ec、</span></span><br><span class="line"><span class="string">                     .facecolor/.fc、.fill、.hatch、.joinstyle、.linestyle/.ls、.linewidth/.lw</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="PolyCollection"><a href="#PolyCollection" class="headerlink" title="PolyCollection"></a>PolyCollection</h3><p>matplotlib.collections.PolyCollection是多边形集合类，其基类是matplotlib.collections._CollectionWithSizes。它的构造函数为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">PolyCollection(verts, sizes=<span class="literal">None</span>, closed=<span class="literal">True</span>, **kwargs)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">verts：一个顶点序列。每个顶点都由xy元组或者xy数组组成</span></span><br><span class="line"><span class="string">sizes：一个浮点数序列，依次指定每个顶点正方形的边长。如果序列长度小于顶点长度，则循环从序列头部再开始  挑选</span></span><br><span class="line"><span class="string">closed：如果为True，则显式封闭多边形</span></span><br><span class="line"><span class="string">edgecolors: collection的边的颜色</span></span><br><span class="line"><span class="string">其他关键字参数用于设置属性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">属性：</span></span><br><span class="line"><span class="string">继承自Artist基类的属性：.alpha、.animated、.axes、.clip_box、.clip_on、</span></span><br><span class="line"><span class="string">                      .clip_path、.contains、.figure、.gid、.label、</span></span><br><span class="line"><span class="string">                      .picker、.transform、.url、.visible、.zorder</span></span><br><span class="line"><span class="string">.facecolors: collection的前景色</span></span><br><span class="line"><span class="string">.linewidths: collection的边线宽</span></span><br><span class="line"><span class="string">.antialiaseds: 抗锯齿属性，可以为True或者False</span></span><br><span class="line"><span class="string">.offsets: 设置collection的偏移</span></span><br><span class="line"><span class="string">.norm: 归一化对象</span></span><br><span class="line"><span class="string">.cmap: color map</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h1 id="Matplotlib实例"><a href="#Matplotlib实例" class="headerlink" title="Matplotlib实例"></a>Matplotlib实例</h1><p><img src="https://i.loli.net/2021/05/22/V9JoBlqxdeHjtbD.jpg" alt=""></p>
<h2 id="基础画图、参数"><a href="#基础画图、参数" class="headerlink" title="基础画图、参数"></a>基础画图、参数</h2><p>绘图中常用的方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置坐标轴上下限</span></span><br><span class="line"><span class="comment"># 第一种方法</span></span><br><span class="line">plt.axis([xmin,xmax,ymin,ymax])</span><br><span class="line"><span class="comment"># 第二种方法</span></span><br><span class="line">plt.xlim(left, right) <span class="comment"># x轴上线下限 </span></span><br><span class="line">plt.ylim(left, right<span class="comment"># y轴上线下限</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置图形标题</span></span><br><span class="line">plt.title(<span class="string">&quot;title&quot;</span>)</span><br><span class="line"><span class="comment"># 设置x轴y轴标题</span></span><br><span class="line">plt.xlabel(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;y&quot;</span>)</span><br><span class="line"><span class="comment"># 显示图例</span></span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure><br>一般情况下plt方法也可以用ax调用，但有些方法名字不一样：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">plt.xlabel()   ax.set_xlabel()</span><br><span class="line">plt.ylabel()   ax.set_ylabel()</span><br><span class="line">plt.xlim()     ax.set_xlim()</span><br><span class="line">plt.ylim()     ax.set_ylim()</span><br><span class="line">plt.title()    ax.set_title()</span><br><span class="line"><span class="comment"># 一般常用ax.set()全部设置了，比如：</span></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">10</span>), ylim=(<span class="number">-2</span>, <span class="number">2</span>), xlabel=<span class="string">&#x27;x&#x27;</span>, ylabel=<span class="string">&#x27;sin(x)&#x27;</span>, title=<span class="string">&#x27;title&#x27;</span>)</span><br></pre></td></tr></table></figure><br>显示marker样式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.RandomState(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> marker <span class="keyword">in</span> [<span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]:</span><br><span class="line">    plt.plot(rng.rand(<span class="number">5</span>), rng.rand(<span class="number">5</span>), marker, label=<span class="string">&quot;marker=&#x27;&#123;0&#125;&#x27;&quot;</span>.<span class="built_in">format</span>(marker))</span><br><span class="line">    plt.legend(numpoints=<span class="number">1</span>)</span><br><span class="line">    plt.xlim(<span class="number">0</span>, <span class="number">1.8</span>)</span><br></pre></td></tr></table></figure></p>
<iframe src="https://nbviewer.jupyter.org/github/soundmemories/StudyNotes/blob/cc4141f7491403a41ac738dba7695d7aaeda9c07/Cheatsheets/Matplotlib_visualization.ipynb" width="1000" height="800"></iframe>

<h2 id="3D画图、参数"><a href="#3D画图、参数" class="headerlink" title="3D画图、参数"></a>3D画图、参数</h2><iframe src="https://nbviewer.jupyter.org/github/soundmemories/StudyNotes/blob/cc4141f7491403a41ac738dba7695d7aaeda9c07/Cheatsheets/Matplotlib%203D.ipynb" width="1000" height="800"></iframe>

<h1 id="Basemap可视化地理数据"><a href="#Basemap可视化地理数据" class="headerlink" title="Basemap可视化地理数据"></a>Basemap可视化地理数据</h1><p>地理数据可视化是数据科学中一种十分常见的可视化类型。 Matplotlib 做此类可视化的主要工具是 Basemap 工具箱，它是 Matplotlib 的 mpl_toolkits 命名空间里的众多工具箱之一。坦白说， Basemap 用起来有点笨重，就算做点儿简单的可视化图也需要花费比预期更长的时间。在处理比较复杂的地图可视化任务时，更现代的解决方案可能会更适用一些，比如 leaflet 开发库或 Google Maps API。</p>
<p>Basemap是Matplotlib的第三方扩展，Matplotlib还支持很多这种第三方库，详情<span class="exturl" data-url="aHR0cHM6Ly9tYXRwbG90bGliLm9yZy9zdGFibGUvdGhpcmRwYXJ0eXBhY2thZ2VzL2luZGV4Lmh0bWwjbWFwcGluZy10b29sa2l0cw==">thirdpartypackages<i class="fa fa-external-link-alt"></i></span>。</p>
<p>Basemap安装环境（本环境是python 3.6）：<br>（1）pyproj可以直接pip安装，手动安装要和python版本一致。<br>（2）basemap需要手动下载安装，从<span class="exturl" data-url="aHR0cHM6Ly93d3cubGZkLnVjaS5lZHUvfmdvaGxrZS9weXRob25saWJzLw==">pythonlibs<i class="fa fa-external-link-alt"></i></span>下载basemap安装（必须和python版本一致）。<br>（3）python2需要pil包，python3还需要安装pillwo包。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装pyproj</span></span><br><span class="line">!pip install pyproj</span><br><span class="line"><span class="comment"># 下载3.6版本的安装包，放在notebook目录下</span></span><br><span class="line">!pip install basemap<span class="number">-1.2</span><span class="number">.2</span>-cp36-cp36m-win_amd64.whl</span><br></pre></td></tr></table></figure><br>显示地球投影：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># 导入</span></span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.basemap <span class="keyword">import</span> Basemap</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">8</span>))</span><br><span class="line">m = Basemap(projection=<span class="string">&#x27;ortho&#x27;</span>, resolution=<span class="literal">None</span>, lat_0=<span class="number">50</span>, lon_0=<span class="number">-100</span>)</span><br><span class="line">m.bluemarble(scale=<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/shcfE8TC2kHNiYB.jpg" alt="basemap地球.jpg"></p>
<p>ETOPO 地图，显示陆地与海底的地形特征作为背景：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure(figsize=(<span class="number">8</span>, <span class="number">8</span>))</span><br><span class="line">m = Basemap(projection=<span class="string">&#x27;lcc&#x27;</span>, resolution=<span class="literal">None</span>, width=<span class="number">8E6</span>, height=<span class="number">8E6</span>, lat_0=<span class="number">30</span>, lon_0=<span class="number">100</span>)</span><br><span class="line"><span class="comment"># etopo图</span></span><br><span class="line">m.etopo(scale=<span class="number">0.5</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 地图上的(经度, 纬度)对应图上的(x, y)坐标</span></span><br><span class="line">x, y = m(<span class="number">116.20</span>, <span class="number">39.56</span>) <span class="comment"># 北京</span></span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;ok&#x27;</span>, markersize=<span class="number">5</span>)</span><br><span class="line">plt.text(x, y, <span class="string">&#x27; 北京&#x27;</span>, fontsize=<span class="number">12</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/UiL2A5P46DaMShs.jpg" alt="北京.jpg"></p>
<p>对于背景，用 <code>bluemarble()</code> 和 <code>shadedrelief()</code> 方法可以画出地球投影，用 <code>drawparallels()</code> 和 <code>drawmeridians()</code> 方法可以画出纬线与经线。<br>Basemap 程序包中有许多实用的函数，可以画出各种地形的轮廓，如陆地、海洋、湖泊、河流、分界线等等。<br>常用方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 物理边界与水体</span></span><br><span class="line">drawcoastlines()      绘制大陆海岸线</span><br><span class="line">drawlsmask()          为陆地与海洋设置填充色，从而可以在陆地或海洋投影其他图像</span><br><span class="line">drawmapboundary()     绘制地图边界，包括为海洋填充颜色</span><br><span class="line">drawrivers()          绘制河流</span><br><span class="line">fillcontinents()      用一种颜色填充大陆，用另一种颜色填充湖泊（可选）</span><br><span class="line"><span class="comment"># 政治边界</span></span><br><span class="line">drawcountries()       绘制国界线</span><br><span class="line">drawstates()          绘制美国州界线</span><br><span class="line">drawcounties()        绘制美国县界线</span><br><span class="line"><span class="comment"># 地图功能</span></span><br><span class="line">drawgreatcircle()    在两点之间绘制一个大圆</span><br><span class="line">drawparallels()      绘制纬线</span><br><span class="line">drawmeridians()      绘制经线</span><br><span class="line">drawmapscale()       在地图上绘制一个线性比例尺</span><br><span class="line"><span class="comment"># 地球影像</span></span><br><span class="line">bluemarble()         绘制 NASA 蓝色弹珠地球投影</span><br><span class="line">shadedrelief()       在地图上绘制地貌晕渲图</span><br><span class="line">etopo()              在地图上绘制地形晕渲图</span><br><span class="line">warpimage()          将用户提供的图像投影到地图上</span><br></pre></td></tr></table></figure><br>对于数据，可以在背景上画出，常用方法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">contour()/contourf()     绘制等高线 / 填充等高线</span><br><span class="line">imshow()                 绘制一个图像</span><br><span class="line">pcolor()/pcolormesh()    绘制带规则 / 不规则网格的伪彩图</span><br><span class="line">plot()                   绘制线条和 / 或标签</span><br><span class="line">scatter()                绘制带标签的点</span><br><span class="line">quiver()                 绘制箭头</span><br><span class="line">barbs()                  绘制风羽（wind barb）</span><br><span class="line">drawgreatcircle()        绘制大圆圈</span><br></pre></td></tr></table></figure></p>
<h1 id="Seaborn可视化"><a href="#Seaborn可视化" class="headerlink" title="Seaborn可视化"></a>Seaborn可视化</h1><p>Matplotlib缺点：<br>（1）Matplotlib 的 API 比较底层。虽然可以实现复杂的统计数据可视化，但是通常都需要写大量的样板代码。<br>（2）由于 Matplotlib 比 Pandas 早十几年，因此它并不是为 Pandas 的 DataFrame 设计的。为了实现 Pandas 的 DataFrame 数据的可视化，你必须先提取每个 Series，然后通常还需要将它们合并成适当的格式。如果有一个画图程序库可以智能地使用DataFrame的标签画图，那一定会很方便。</p>
<p>Seaborn 在 Matplotlib 的基础上开发了一套 API，为默认的图形样式和颜色设置提供了理智的选择，为常用的统计图形定义了许多简单的高级函数，并与 Pandas DataFrame 的功能有机结合。</p>
<p>Matplotlib 团队也一直在努力解决这些问题，Matplotlib 中不仅增加了<code>plt.style</code> 工具，而且与 Pandas 数据也可以无缝衔接。</p>
<p>Seanborn内置的数据集<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL213YXNrb20vc2VhYm9ybi1kYXRh">seaborn-data<i class="fa fa-external-link-alt"></i></span>。<br>Seaborn<span class="exturl" data-url="aHR0cDovL3NlYWJvcm4ucHlkYXRhLm9yZw==">文档<i class="fa fa-external-link-alt"></i></span>、<span class="exturl" data-url="aHR0cDovL3N0YW5mb3JkLmVkdS9+bXdhc2tvbS9zb2Z0d2FyZS9zZWFib3JuL3R1dG9yaWFsLmh0bWw=">教程<i class="fa fa-external-link-alt"></i></span>和 Seaborn <span class="exturl" data-url="aHR0cDovL3N0YW5mb3JkLmVkdS9+bXdhc2tvbS9zb2Z0d2FyZS9zZWFib3JuL2V4YW1wbGVzL2luZGV4Lmh0bWw=">画廊<i class="fa fa-external-link-alt"></i></span>。</p>
<p><strong>1、频次直方图、 KDE和密度图</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"></span><br><span class="line">data = np.random.multivariate_normal([<span class="number">0</span>, <span class="number">0</span>], [[<span class="number">5</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">2</span>]], size=<span class="number">2000</span>)</span><br><span class="line">data = pd.DataFrame(data, columns=[<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>])</span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> <span class="string">&#x27;xy&#x27;</span>:</span><br><span class="line">    plt.hist(data[col], density=<span class="literal">True</span>, alpha=<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/MRIcGhDvJywsx9e.jpg" alt="直方图.jpg"></p>
<p>还可以用 KDE 获取变量分布的平滑估计：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> <span class="string">&#x27;xy&#x27;</span>:</span><br><span class="line">    sns.kdeplot(data[col], shade=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/1VQ7XoztnxcjylU.jpg" alt="sns_kde.jpg"></p>
<p>用 distplot 可以让频次直方图与 KDE 结合起来：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.distplot(data[<span class="string">&#x27;x&#x27;</span>])</span><br><span class="line">sns.distplot(data[<span class="string">&#x27;y&#x27;</span>])</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/5jaP7gXxVCnT9Uc.jpg" alt="sns_displot.jpg"></p>
<p>如果向 kdeplot 输入的是二维数据集，那么就可以获得一个二维数据可视化图：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.kdeplot(data)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/nLC3rfKHoQPq5v7.jpg" alt="sns_kde2.jpg"></p>
<p>用 sns.jointplot 可以同时看到两个变量的联合分布与单变量的独立分布：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 白色背景</span></span><br><span class="line"><span class="keyword">with</span> sns.axes_style(<span class="string">&#x27;white&#x27;</span>):</span><br><span class="line">    sns.jointplot(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, data, kind=<span class="string">&#x27;kde&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/zOb5WjnBpATCRrQ.jpg" alt="sns_joinplot.jpg"></p>
<p>可以向 jointplot 函数传递一些参数。例如，可以用六边形块代替频次直方图：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> sns.axes_style(<span class="string">&#x27;white&#x27;</span>):</span><br><span class="line">    sns.jointplot(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, data, kind=<span class="string">&#x27;hex&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/1rJpz4dkQ7nHlRF.jpg" alt="sns_joinplot2.jpg"></p>
<p><strong>2、矩阵图</strong><br>需要对多维数据集进行可视化时，最终都要使用矩阵图。<br>如果想画出所有变量中任意两个变量之间的图形，用矩阵图探索多维数据不同维度间的相关性非常有效。</p>
<p>可视化样本中多个维度的关系非常简单，直接用 sns.pairplot 即可：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iris = sns.load_dataset(<span class="string">&quot;iris&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 四个变量的矩阵图</span></span><br><span class="line">sns.pairplot(iris, hue=<span class="string">&#x27;species&#x27;</span>, height=<span class="number">2.5</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/LHb73OQBySJ9r5t.jpg" alt="矩阵图.jpg"></p>
<p><strong>3、分面频次直方图</strong><br>有时观察数据最好的方法就是借助数据子集的频次直方图。 Seaborn 的 <code>FacetGrid()</code> 函数让这件事变得非常简单。</p>
<p>某个餐厅统计的服务员收取小费的数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tips = sns.load_dataset(<span class="string">&#x27;tips&#x27;</span>)</span><br><span class="line"></span><br><span class="line">tips[<span class="string">&#x27;tip_pct&#x27;</span>] = <span class="number">100</span> * tips[<span class="string">&#x27;tip&#x27;</span>] / tips[<span class="string">&#x27;total_bill&#x27;</span>]</span><br><span class="line"></span><br><span class="line">grid = sns.FacetGrid(tips, row=<span class="string">&quot;sex&quot;</span>, col=<span class="string">&quot;time&quot;</span>, margin_titles=<span class="literal">True</span>)</span><br><span class="line">grid.<span class="built_in">map</span>(plt.hist, <span class="string">&quot;tip_pct&quot;</span>, bins=np.linspace(<span class="number">0</span>, <span class="number">40</span>, <span class="number">15</span>))</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/QDKa9k8qvuAF42T.jpg" alt="分面频次直方图.jpg"></p>
<p><strong>4、因子图</strong><br>因子图（factor plot）也是对数据子集进行可视化的方法。你可以通过它观察一个参数在另一个参数间隔中的分布情况。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> sns.axes_style(style=<span class="string">&#x27;ticks&#x27;</span>):</span><br><span class="line">    <span class="comment"># 新版本重命名为catplot</span></span><br><span class="line">    g = sns.factorplot(<span class="string">&quot;day&quot;</span>, <span class="string">&quot;total_bill&quot;</span>, <span class="string">&quot;sex&quot;</span>, data=tips, kind=<span class="string">&quot;box&quot;</span>)</span><br><span class="line">    g.set_axis_labels(<span class="string">&quot;Day&quot;</span>, <span class="string">&quot;Total Bill&quot;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/7STzpiKFqYl3sRa.jpg" alt="factorplot/catplot.jpg"></p>
<p><strong>5、联合分布</strong><br>与前面介绍的矩阵图类似，可以用 <code>sns.jointplot()</code> 画出不同数据集的联合分布和各数据本身的分布。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> sns.axes_style(<span class="string">&#x27;white&#x27;</span>):</span><br><span class="line">    sns.jointplot(<span class="string">&quot;total_bill&quot;</span>, <span class="string">&quot;tip&quot;</span>, data=tips, kind=<span class="string">&#x27;hex&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/YQHD938NtKWJLXv.jpg" alt="联合分布图.jpg"></p>
<p>联合分布图也可以自动进行 KDE 和回归：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(<span class="string">&quot;total_bill&quot;</span>, <span class="string">&quot;tip&quot;</span>, data=tips, kind=<span class="string">&#x27;reg&#x27;</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/PViOUKG93k6WbeI.jpg" alt="联合分布图回归.jpg"></p>
<p><strong>6、条形图</strong><br>时间序列数据可以用 <code>sns.factorplot()</code> 画出条形图。</p>
<p>行星数据来演示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">planets = sns.load_dataset(<span class="string">&#x27;planets&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> sns.axes_style(<span class="string">&#x27;white&#x27;</span>):</span><br><span class="line">    g = sns.factorplot(<span class="string">&quot;year&quot;</span>, data=planets, aspect=<span class="number">2</span>, kind=<span class="string">&quot;count&quot;</span>, color=<span class="string">&#x27;steelblue&#x27;</span>)</span><br><span class="line">    g.set_xticklabels(step=<span class="number">5</span>)</span><br></pre></td></tr></table></figure><br><img src="https://i.loli.net/2021/05/25/KeauUM3LJxg8ytB.jpg" alt="条形图.jpg"></p>
<p>其他案例：<br><strong>0、Seaborn详细教程</strong></p>
<iframe src="https://nbviewer.jupyter.org/github/soundmemories/StudyNotes/blob/0a57cce6189669f35997e1ec3a371336e9f7a757/Cheatsheets/Seaborn_visualization.ipynb" width="1000" height="700"></iframe>

<p><strong>1、单维度与关联维度分析</strong></p>
<iframe src="https://nbviewer.jupyter.org/github/soundmemories/StudyNotes/blob/0a57cce6189669f35997e1ec3a371336e9f7a757/Cheatsheets/Seaborn_distribution.ipynb" width="1000" height="700"></iframe>

<p><strong>2、连续变量关联分析</strong></p>
<iframe src="https://nbviewer.jupyter.org/github/soundmemories/StudyNotes/blob/0a57cce6189669f35997e1ec3a371336e9f7a757/Cheatsheets/Seaborn_regression.ipynb" width="1000" height="700"></iframe>

<p><strong>3、离散变量分析</strong></p>
<iframe src="https://nbviewer.jupyter.org/github/soundmemories/StudyNotes/blob/0a57cce6189669f35997e1ec3a371336e9f7a757/Cheatsheets/Seaborn_statEstimation.ipynb" width="1000" height="700"></iframe>
      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/04/25/Machine%20Learning/03.ML-Pandas/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/25/Machine%20Learning/03.ML-Pandas/" class="post-title-link" itemprop="url">ML-Pandas</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-25 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-25T00:00:00+08:00">2020-04-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>135k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2:03</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Pandas概述"><a href="#Pandas概述" class="headerlink" title="Pandas概述"></a>Pandas概述</h2><p>Pandas 是在 NumPy 基础上建立的新程序库，提供了一种高效的 DataFrame数据结构。 DataFrame 本质上是一种带行标签和列标签、支持相同类型数据和缺失值的多维数组。 </p>
<p>NumPy 的 ndarray 数据结构为数值计算任务中常见的干净整齐、组织良好的数据提供了许多不可或缺的功能。虽然它在这方面做得很好，但是当我们需要处理更灵活的数据任务（如为数据添加标签、处理缺失值等），或者需要做一些不是对每个元素都进行广播映射的计算（如分组、透视表等）时， NumPy 的限制就非常明显了，而这些都是分析各种非结构化数据时很重要的一部分。建立在 NumPy 数组结构上的Pandas，尤其是它的 Series 和 DataFrame 对象，为我们处理那些消耗大量时间的“数据清理”任务提供了捷径。</p>
<p>在安装 Pandas 之前，确保你的操作系统中有 NumPy。可使用<code>pip install pandas</code>安装pandas。如果你使用了 Anaconda，那么 Pandas 就已经安装好了。更详细的安装请参考<a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/getting_started/install.html">官方文档</a>。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看包的版本</span></span><br><span class="line">pd.__version__</span><br><span class="line"><span class="comment"># 自动补全</span></span><br><span class="line">pd.&lt;TAB&gt;</span><br><span class="line"><span class="comment"># 内置的文档</span></span><br><span class="line">pd?</span><br></pre></td></tr></table></figure><br>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/04/25/Machine%20Learning/03.ML-Pandas/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/04/22/Machine%20Learning/02.ML-NumPy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/22/Machine%20Learning/02.ML-NumPy/" class="post-title-link" itemprop="url">ML-NumPy</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-22 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-22T00:00:00+08:00">2020-04-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>46k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>42 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Python数据的存储和操作"><a href="#Python数据的存储和操作" class="headerlink" title="Python数据的存储和操作"></a>Python数据的存储和操作</h2><p>要实现高效的数据驱动的科学和计算，需要理解数据是如何被存储和操作的。Python 语言中数据数组是如何被处理的，并对比 NumPy 所做的改进。这也是理解其他数据科学工具的数据处理的基础。<br>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/04/22/Machine%20Learning/02.ML-NumPy/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/04/21/Machine%20Learning/01.ML-IPython%E5%92%8CJupyter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/21/Machine%20Learning/01.ML-IPython%E5%92%8CJupyter/" class="post-title-link" itemprop="url">ML-IPython和Jupyter</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-21 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-21T00:00:00+08:00">2020-04-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>11k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>10 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="IPython"><a href="#IPython" class="headerlink" title="IPython"></a>IPython</h2><p>IPython（interactive Python 的简称，即交互式Python），由 Fernando Perez 作为一个增强的 Python 解释器于 2001 年启动，并由此发展为一个项目。用 Perez 的原话来说，该项目致力于提供“科学计算的全生命周期开发工具”。如果将 Python 看作数据科学任务的引擎，那么 IPython 就是一个交互式控制面板。</p>
<p>IPython 除了作为 Python 的一个交互式接口，还提供了一些有用的 Python 语法附加功能（魔法命令），我会介绍其中最有用的一些。</p>
<p>另外，IPython 被紧密地连接在 <a target="_blank" rel="noopener" href="http://jupyter.org">Jupyter项目</a> 中。该项目提供一个基于浏览器的 Notebook，它可以开发、协作、分享甚至发布数据科学结果。IPython Notebook 其实只是通用 Jupyter Notebook 结构的特例，而Jupyter Notebook 不仅支持 Python，还包括用于 Julia、 R 和其他编程语言的 Notebook。<br>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/04/21/Machine%20Learning/01.ML-IPython%E5%92%8CJupyter/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/04/20/Machine%20Learning/00.ML-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/20/Machine%20Learning/00.ML-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%9F/" class="post-title-link" itemprop="url">ML-机器学习？</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-20 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-20T00:00:00+08:00">2020-04-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>数据科学领域常用的是Python，因为它的第三方程序包拥有庞大而活跃的生态系统，需要你有一定的 <a target="_blank" rel="noopener" href="https://docs.python.org/3/">Python</a> 编程经验，而且熟悉Python中的主流科学计算库：<br>（1）<a target="_blank" rel="noopener" href="https://numpy.org/">Numpy</a>：可以处理同类型数组型数据。<br>（2）<a target="_blank" rel="noopener" href="https://www.scipy.org/">SciPy</a>：可以处理多种类型带标签的数据。<br>（3）<a target="_blank" rel="noopener" href="https://pandas.pydata.org/">Pandas</a>：可以解决常见的科学计算问题。<br>（4）<a target="_blank" rel="noopener" href="https://matplotlib.org/">Matplotlib</a>：可以绘制可用于印刷的可视化图形。<br>以及Python机器/深度学习框架：<br>（1）<a target="_blank" rel="noopener" href="https://scikit-learn.org/">Scikit-Learn</a>：实现了众多机器学习算法。<br>（2）<a target="_blank" rel="noopener" href="https://tensorflow.google.cn/">TensorFlow</a>：使用数据流图进行分布式运算，可在多个GPU服务器上分配运算，针对大型项目和深度学习项目。Google开源框架。<br>（3）<a target="_blank" rel="noopener" href="https://www.paddlepaddle.org.cn/">PaddlePaddle</a>：同TensorFlow，Baidu开源框架。</p>
<p>编程环境建议使用Python的<a target="_blank" rel="noopener" href="https://jupyter.org/">Jupyter Notebook</a>，这是一个非常好用的工具，支持多种语言编程，还可以写笔记。它依托的Python底层环境是IPython，所以IPython的魔法命令也可以用在Jupyter上。</p>
<p>另外，如果你想深入理解底层的原理，则需要大学水平的数学知识（微积分、线性代数、概率论和统计学）。</p>
<h2 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h2><p>安装 Python 和科学计算程序库的方法有很多，推荐使用Anaconda发行版，Windows、Linux 和 Mac OS操作系统的安装和使用方式类似。 </p>
<p>Anaconda 发行版有两种：<br>（1）<a target="_blank" rel="noopener" href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a>：只包含 Python 解释器和一个名为conda 的命令行工具。 conda 是一个跨平台的程序包管理器，可以管理各种 Python 程序包，类似于 Linux 用户熟悉的 apt 和 yum 程序包管理器。<br>（2）<a target="_blank" rel="noopener" href="https://www.anaconda.com/products/individual#Downloads">Anaconda</a>：除了包含 Python 和 conda 之外，还同时绑定了四五百个科学计算程序包。由于预安装了许多包，因此安装它需要占用几个G字节的存储空间。</p>
<p>如果安装了 Miniconda，所有程序包（包括 Anaconda）都可以手动安装。因此，我推荐先安装 Miniconda，其他包视情况安装。<br>首先，下载并安装 Miniconda 程序包（确认你选择的是适合 Python 3 的版本），然后安装几个重要程序包。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[~]$ conda install numpy pandas scikit-learn matplotlib seaborn ipython-notebook</span><br></pre></td></tr></table></figure><br>若使用其他更专业的 Python 科学计算工具，安装方法同样很简单，就是 conda install 程序包名称。关于 conda 的更多信息，包括 conda 虚拟环境（强烈推荐）的创建和使用，请参考 <a target="_blank" rel="noopener" href="http://conda.pydata.org/docs/">conda 在线文档</a>。<br>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/04/20/Machine%20Learning/00.ML-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%9F/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/03/17/Java/50.Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/17/Java/50.Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">Java设计模式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-17 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-17T00:00:00+08:00">2020-03-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>12k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>11 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h2><p>说白了，就是解决问题的套路，代码结构。<br>Java中常用的设计模式有23种。</p>
<p>JavaSE阶段给大家普及几个：<br>（1）模板设计模式（做到能模仿（3星））<br>（2）单例设计模式（做到脱稿能写（5星））<br>（3）工厂设计模式（做到会调用工厂类的方法（2星））<br>（4）代理设计模式（做到能模仿（3星））<br>（5）迭代器设计模式（了解）<br>（6）装饰者设计模式（了解）<br>其他复杂设计模式，做到能看懂代码，能认识。<br>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/03/17/Java/50.Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/03/14/Java/30.Java%20Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/14/Java/30.Java%20Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/" class="post-title-link" itemprop="url">Java Lambda表达式与函数式接口</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-14 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-14T00:00:00+08:00">2020-03-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>31k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>28 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Lambda表达式"><a href="#Lambda表达式" class="headerlink" title="Lambda表达式"></a>Lambda表达式</h2>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/03/14/Java/30.Java%20Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/03/10/Java/29.Java%E5%8F%8D%E5%B0%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/10/Java/29.Java%E5%8F%8D%E5%B0%84/" class="post-title-link" itemprop="url">Java反射</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-10 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-10T00:00:00+08:00">2020-03-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>32k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>29 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="类的加载、连接和初始化"><a href="#类的加载、连接和初始化" class="headerlink" title="类的加载、连接和初始化"></a>类的加载、连接和初始化</h2><p>当程序主动使用某个类时，如果该类还未被加载到JVM内存中，系统会通过加载、连接、初始化三个步骤来对该类进行初始化，如果没有意外，JVM将会连续完成这三个步骤，所以也把这三个步骤统称为类加载或类初始化。大多数情况下是这三步一起完成的，但是有的时候初始化不一起完成。<br><img src="https://i.loli.net/2021/04/08/vT6NlPw83mCZgpn.png"><br>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/03/10/Java/29.Java%E5%8F%8D%E5%B0%84/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://soundmemories.github.io/2020/03/07/Java/28.Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2020/11/04/6JhNuwtBe4adylS.png">
      <meta itemprop="name" content="SoundMemories">
      <meta itemprop="description" content="今日事，今日毕">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SoundMemories">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/07/Java/28.Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" class="post-title-link" itemprop="url">Java网络编程</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-07 00:00:00" itemprop="dateCreated datePublished" datetime="2020-03-07T00:00:00+08:00">2020-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>35k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>31 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="网络编程的基础知识"><a href="#网络编程的基础知识" class="headerlink" title="网络编程的基础知识"></a>网络编程的基础知识</h2><p>Java程序可以非常方便的访问互联网上的HTTP服务、FTP服务等，并可以直接取得互联网上的远程资源，还可以向远程资源发送GET、POST请求。</p>
<h3 id="网络的概念和分类"><a href="#网络的概念和分类" class="headerlink" title="网络的概念和分类"></a>网络的概念和分类</h3><p>所谓计算机网络就是把分布在不同地理区域的计算机与专门的外部设备用通信线路互连成一个规模大、功能强的网络系统，从而使众多的计算机可以方便地互相传递信息、共享硬件、软件、数据信息等资源。</p>
<p>计算机网络有很多种：<br>按照网络的传输介质划分：双绞线网、同轴电缆网、光纤网、卫星网等。还有无线传输的，例如Wife的传输介质是红外线，蓝牙的传输介质是无线电波，都是电磁波的一种。<br>按照网络的拓扑结构来划分，可以分为星型网络、总线网络、环线网络、树型网络、网状网络、混合型网络等。<br><img src="https://i.loli.net/2021/04/05/4A5wce6bN3iuHQP.png" alt=""><br>按照规模来分类：<br>（1）局域网（Local Area Network，LAN）是指在某一区域内由多台计算机互联成的计算机组。一般是方圆几千米以内。局域网可以实现文件管理、应用软件共享、打印机共享、工作组内的日程安排、电子邮件和传真通信服务等功能。局域网是封闭型的，可以由办公室内的两台计算机组成，也可以由一个公司内的上千台计算机组成。<br>（2）城域网(Metropolitan Area Network，MAN)是在一个城市范围内所建立的计算机通信网，属宽带局域网。由于采用具有有源交换元件的局域网技术，网中传输时延较小，它的传输媒介主要采用光缆，传输速率在100兆比特/秒以上。MAN的一个重要用途是用作骨干网，通过它将位于同一城市内不同地点的主机、数据库，以及LAN等互相联接起来，这与WAN的作用有相似之处，但两者在实现方法与性能上有很大差别。<br>（3）广域网（Wide Area Network， WAN），又称外网、公网，是连接不同地区局域网或城域网计算机通信的远程网。通常跨接很大的物理范围，所覆盖的范围从几十公里到几千公里，它能连接多个地区、城市和国家，或横跨几个洲并能提供远距离通信，形成国际性的远程网络。</p>
<p>那么什么是互联网、因特网、万维网呢？<br>（1）凡是由能彼此通信的设备组成的网络就叫互联网，即使仅有两台机器（计算机、手机等），不论用何种技术使其彼此通信，都叫互联网，所以，互联网有广域网、城域网及局域网之分。国际标准的互联网写法是internet，字母i小写！<br>（2）因特网是互联网中的一种，它可不是仅有两台机器组成的网络，而是由上千万台设备组成的网络（该网络具备一定规模）。国际标准的因特网写法是Internet，字母I大写！<br>（3）因特网是基于TCP/IP协议实现的，TCP/IP协议由很多协议组成，不同类型的协议又被放在不同的层，其中，位于应用层的协议就有很多，比如FTP、SMTP、HTTP。所以，因特网提供的服务一般包括有：www（万维网）服务、电子邮件服务（outlook）、远程登录（QQ）服务、文件传输（FTP）服务、网络电话等等。只要应用层使用的是HTTP协议，就称为万维网(World Wide Web)。</p>
<h3 id="网络协议"><a href="#网络协议" class="headerlink" title="网络协议"></a>网络协议</h3><p>不管处于那种网络，那么通信是网络最基本的要求，而计算机网络中实现通信必须有一些约定，即通信协议。对速率、传输代码、代码结构、传输控制步骤、出错控制等制定标准。<br>网络通信必须有硬件和软件方面的支持，由于世界上大型计算机厂商推出各自不同的网络体系结构，影响了网络通信的统一性，因此国际标准化组织ISO于1978年提出了著名的OSI（Open System Interconnection）开放系统互连参考模型。它把计算机网络分成物理层、数据链路层、网络层、传输层、会话层、表示层、应用层等七层。<br>（1）应用层：网络服务与最终用户的一个接口。协议有：HTTP、FTP、SMTP、DNS、TELNET、HTTPS、POP3等等。<br>（2）表示层：数据的表示、安全、压缩。格式有：JPEG、ASCll、DECOIC、加密格式等。<br>（3）会话层：建立、管理、终止会话。对应主机进程，指本地主机与远程主机正在进行的会话<br>（4）传输层：定义传输数据的协议端口号，以及流控和差错校验。协议有：TCP、UDP。<br>（5）网络层：进行逻辑地址寻址，实现不同网络之间的路径选择。协议有：ICMP、IGMP、IP（IPV4 IPV6）、ARP、RARP。<br>（6）数据链路层：建立逻辑连接、进行硬件地址寻址、差错校验等功能。将比特组合成字节再组合成帧，用MAC地址访问介质，错误可以被发现但不能纠正。<br>（7）物理层：建立、维护、断开物理连接。</p>
<p>而IP协议是一种非常重要的协议。IP（internet protocal）又称为互联网协议。IP的责任就是把数据从源传送到目的地。它在源地址和目的地址之间传送一种称之为数据包的东西，它还提供对数据大小的重新组装功能，以适应不同网络对包大小的要求。经常与IP协议放在一起的还有TCP（Transmission Control Protocol）协议，即传输控制协议，是一种面向连接的、可靠的、基于字节流的传输层通信协议。而通常我们说的TCP/IP协议，其实是指TCP/IP协议族，因为该协议家族的两个最核心协议：TCP（传输控制协议）和IP（网际协议），为该家族中最早通过的标准，所以简称为TCP/IP协议。</p>
<p>按照TCP/IP协议模型，网络通常被分为四层：网络访问层、互联网层、传输层和应用层。<br><img src="https://i.loli.net/2021/04/05/jM2EYHVxnWBt1bG.png" width="40%" height="40%"></p>
<p>TCP：(Transmission Control Protocol，传输控制协议)面向连接的，可靠的，基于字节流的，适用于大数据量的传输的协议。<br>UDP：(User Datagram Protocol，用户数据报协议)非面向连接，不可靠的，基于用户数据报（报文），只支持64k以内的数据的发送。</p>
<h3 id="IP地址"><a href="#IP地址" class="headerlink" title="IP地址"></a>IP地址</h3><p>IP地址用于标识网络中的一个通信实体，这个通信实体可以是一台计算机，也可以是一台打印机，或者是路由器的一个端口。而在基于IP协议网络中传输的数据包，都必须使用IP地址来进行标识。</p>
<p>IP地址是一个32位的整数，但为了便于记忆，通常把它分为4个8位的二进制数组成，每8位之间用圆点隔开，格式：X.X.X.X，其中每个X表示地址中的8位，用十进制[0,255]之间值表示，因此我们看到的IP常常是：222.222.88.104。<br>Internet委员会定义了5种IP地址类型以适合不同容量的网络，即A类~E类。其中A、B、C这3类由Internet NIC在全球范围内统一分配，D、E类为特殊地址。<br><img src="https://i.loli.net/2021/04/05/42CEPYt9ergV7Zz.png" alt=""><br>IP地址还分为IPV4和IPV6。由于IPv4最大的问题在于网络地址资源有限，严重制约了互联网的应用和发展。IPv6是IETF（Internet Engineering Task Force）设计的用于替代现行版本IP协议（IPv4）的下一代IP协议，号称可以为全世界的每一粒沙子编上一个网址。IPv4和IPv6地址格式不相同，因此在很长一段时间里，互联网中出现IPv4和IPv6长期共存的局面。IPv6的地址长度为128位，是IPv4地址长度的4倍，格式为X:X:X:X:X:X:X:X，其中每个X表示地址中的16位，以十六进制表示。</p>
<h3 id="端口号"><a href="#端口号" class="headerlink" title="端口号"></a>端口号</h3><p>IP地址可以唯一的确定网络上的一个通信实体，但是一个通信实体可以有多个通信程序同时提供网络服务，此时还需要使用端口。IP地址就好比通信的计算机地址，我们通过IP地址可以找到计算机，但是要具体找到某程序/进程，还需要端口号。</p>
<p>端口号是一个16位的整数，即在[0,65535]之间，通常它可以分为三类：<br>（1）公认端口（Well-Known Ports）范围从0到1023，这些端口号一般固定分配给一些服务。比如，21端口分配给FTP（文件传输协议）服务，25端口分配给SMTP（简单邮件传输协议）服务，80端口分配给HTTP服务。<br>（2）注册端口（Registered Ports）：端口号从1024到49151。它们松散地绑定于一些服务。例如：Tomcat（8080），JBOSS（8080），Oracle（1521）,MySQL（3306），SQL Server（1433），QQ（1080）。<br>（3）动态/私有端口（Dynamic and/Private Ports）：端口的范围从49152到65535，这些端口号一般不固定分配给某个服务。只要运行的程序向系统提出访问网络的申请，那么系统就可以从这些端口号中分配一个供该程序使用。理论上，不应为服务分配这些端口。</p>
<p>然而实际生活中，要常人识记IP地址还是有些困难的，所以就有了域名。比如百度的域名：www.baidu.com。域名和IP地址是相对应的，网域名称系统（DNS，Domain Name System）是因特网的一项核心服务，它作为可以将域名和IP地址相互映射的一个分布式数据库，能够使人更方便的访问互联网，而不用去记住能够被机器直接读取的IP地址数串。</p>
<h2 id="基本的网络API"><a href="#基本的网络API" class="headerlink" title="基本的网络API"></a>基本的网络API</h2><h3 id="InetAddress"><a href="#InetAddress" class="headerlink" title="InetAddress"></a>InetAddress</h3><p>此类表示互联网协议 (IP) 地址，它有两个子类Inet4Address和Inet6Address，分别对应IPV4和IPV6。<br>InetAddress类没有提供公共的构造器，而是提供了如下几个静态方法来获取InetAddress实例：<br>（1）<code>public static InetAddress getLocalHost()</code><br>（2）<code>public static InetAddress getByAddress(byte[] addr)</code><br>（3）<code>public static InetAddress getByName(String host)</code><br>InetAddress提供了如下几个常用的方法：<br>（1）<code>public String getHostAddress()</code>：返回 IP 地址字符串（以文本表现形式）。<br>（2）<code>public String getHostName()</code>：获取此 IP 地址的主机名<br>（3）<code>public String getCanonicalHostName()</code>：获取此 IP 地址的完全限定域名<br>（4）<code>public boolean isReachable(int timeout)</code>：测试是否可以达到该地址。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestInetAddress</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        InetAddress ip1 = InetAddress.getLocalHost();</span><br><span class="line">        System.out.println(ip1);<span class="comment">//DESKTOP-LUGF5AH/192.168.18.1</span></span><br><span class="line">        </span><br><span class="line">        InetAddress ip2 = InetAddress.getByName(<span class="string">&quot;www.baidu.com&quot;</span>);</span><br><span class="line">        System.out.println(ip2);<span class="comment">//www.baidu.com/110.242.68.4</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">byte</span>[] ip = &#123;(<span class="keyword">byte</span>)<span class="number">222</span>,(<span class="keyword">byte</span>)<span class="number">222</span>,<span class="number">88</span>,<span class="number">102</span>&#125;;<span class="comment">//强转在getByAddress中有处理，不会出错</span></span><br><span class="line">        InetAddress ip3 = InetAddress.getByAddress(ip);</span><br><span class="line">        <span class="comment">//输出ip而不是域名。如果这个IP地址不存在或DNS服务器不允许进行 ip-&gt;域名 的映射，</span></span><br><span class="line">        <span class="comment">//那么getHostName()方法就直接返回这个IP地址</span></span><br><span class="line">        System.out.println(ip3);<span class="comment">///222.222.88.102</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h3><p>URI(Uniform resource identifier)：表示一个统一资源标识符 (URI) 引用，用来唯一的标识一个资源。<br>URL(Uniform Resource Locator)：类 URL 代表一个统一资源定位符，它是指向互联网“资源”的指针。资源可以是简单的文件或目录，也可以是对更为复杂的对象的引用，例如对数据库或搜索引擎的查询。它是一种具体的URI，即URL可以用来标识一个资源，而且还指明了如何locate这个资源。URI不能用于定位任何资源，它的唯一作用是解析，而URL则包含一个可打开到达该资源的输入流。 URL的基本结构由5部分组成：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;传输协议&gt;:&#x2F;&#x2F;&lt;主机名&gt;:&lt;端口号&gt;&#x2F;&lt;文件名&gt;#片段名</span><br><span class="line">&lt;传输协议&gt;:&#x2F;&#x2F;&lt;主机名&gt;:&lt;端口号&gt;&#x2F;&lt;文件名&gt;?参数列表</span><br></pre></td></tr></table></figure><br>“#片段名”：即锚点，例如看小说，直接定位到章节。<br>“参数列表”格式：参数名=参数值&amp;参数名=参数值….。</p>
<p>URL构造方法：<br>（1）<code>public URL (String spec)</code>：根据 String 表示形式创建 URL 对象。<br>（2）<code>public URL(URL context, String spec)</code>：通过基 URL 和相对 URL 构造一个 URL 对象。<br>（3）<code>public URL(String protocol, String host, String file)</code>：根据指定的 protocol 名称、host 名称和 file 名称创建 URL。<br>（4）<code>public URL(String protocol, String host, int port, String file)</code>：根据指定 protocol、host、port 号和 file 创建 URL 对象。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> URL (<span class="string">&quot;http://www.baidu.com/&quot;</span>);</span><br><span class="line"><span class="keyword">new</span> URL(url, <span class="string">&quot;download.html&quot;</span>);</span><br><span class="line"><span class="keyword">new</span> URL(<span class="string">&quot;http&quot;</span>, <span class="string">&quot;www.baidu.com&quot;</span>, <span class="string">&quot;download. html&quot;</span>);</span><br><span class="line"><span class="keyword">new</span> URL(<span class="string">&quot;http&quot;</span>, <span class="string">&quot;www.baidu.com&quot;</span>, <span class="number">80</span>, <span class="string">&quot;download.html&quot;</span>);</span><br></pre></td></tr></table></figure><br>URL的常用方法：<br>（1）<code>public String getProtocol()</code>：获取该URL的协议名。<br>（2）<code>public String getHost()</code>：获取该URL的主机名。<br>（3）<code>public String getPort()</code>：获取该URL的端口号。<br>（4）<code>public String getPath()</code>：获取该URL的文件路径，即tomcat的webapps目录下级目录名也就是资源路径名。<br>（5）<code>public String getFile()</code>：获取该URL的文件名。<br>（6）<code>public String getRef()</code>：获取该URL在文件中的相对位置。<br>（7）<code>public String getQuery()</code>：获取该URL的查询名。<br>（8）<code>public final InputStream openStream()</code>：返回一个用于从该连接读入的 InputStream。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestURL</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> MalformedURLException </span>&#123;</span><br><span class="line">        URL url = <span class="keyword">new</span> URL(<span class="string">&quot;http://www.baidu.com:80/index.html?keyword=java&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;协议：&quot;</span> + url.getProtocol());</span><br><span class="line">        System.out.println(<span class="string">&quot;主机名：&quot;</span> + url.getHost());</span><br><span class="line">        System.out.println(<span class="string">&quot;端口号：&quot;</span> + url.getPort());</span><br><span class="line">        System.out.println(<span class="string">&quot;路径名：&quot;</span> + url.getPath());</span><br><span class="line">        System.out.println(<span class="string">&quot;文件名：&quot;</span> + url.getFile());</span><br><span class="line">        System.out.println(<span class="string">&quot;锚点：&quot;</span> + url.getRef());</span><br><span class="line">        <span class="comment">//注意如果存在锚点，那么查询名返回null，因为#后面全部当做锚点了</span></span><br><span class="line">        System.out.println(<span class="string">&quot;查询名：&quot;</span> + url.getQuery());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>案例：获取百度首页的资源<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestURLRead</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        URL url = <span class="keyword">new</span> URL(<span class="string">&quot;http://www.baidu.com/index.html&quot;</span>);</span><br><span class="line">        <span class="comment">/*html标签（格式化数据）、css：皮肤（美化数据）、js：互动（交互数据）、数据：*/</span></span><br><span class="line">        InputStream input = url.openStream();</span><br><span class="line">        <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span>((len=input.read(data))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> String(data,<span class="number">0</span>,len,<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        input.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="URLConnection"><a href="#URLConnection" class="headerlink" title="URLConnection"></a>URLConnection</h3><p>URL的方法openStream()，能从网络上读取数据，但是无法给服务器端发送数据，若希望给服务器端发送数据，则需要URLConnection。<br>它代表应用程序和 URL 之间的通信链接。此类的实例可用于读取和写入此 URL 引用的资源。通常，创建一个到 URL 的连接需要几个步骤：<br>（1）通过 URL对象调用 openConnection 方法创建URLConnection连接对象。<br>（2）处理设置参数和一般请求属性。<br>（3）使用 connect 方法建立到远程对象的实际连接。<br>（4）远程对象变为可用。远程对象的头字段和内容变为可访问。 </p>
<p>URLConnection的常用方法：<br>（1）<code>public void setDoOutput(boolean dooutput)</code>：如果打算使用 URL 连接进行输出，例如给服务器传递请求参数，则将 DoOutput 标志设置为 true；如果不打算使用，则设置为 false。默认值为 false。 必须在所有getXXX()和connect()方法之前。<br>（2）<code>public String getContentEncoding()</code>：返回 content-encoding 头字段的值。<br>（3）<code>public int getContentLength()</code>：返回 content-length 头字段的值。<br>（4）<code>public String getContentType()</code>：返回 content-type 头字段的值。<br>（5）<code>public long getDate()</code>：返回 date 头字段的值。<br>（6）<code>public long getLastModified()</code>：返回 last-modified 头字段的值。结果为距离格林威治标准时间 1970 年 1 月 1 日的毫秒数。<br>（7）<code>public String getHeaderField(String name)</code>：返回指定的头字段的值。<br>（8）<code>public InputStream getInputStream()</code>：返回从此打开的连接读取的输入流。<br>（9）<code>public OutputStream getOutputStream()</code>：返回写入到此连接的输出流。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLConnection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestURLConnection</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        URL url = <span class="keyword">new</span> URL(<span class="string">&quot;http://localhost/web1/denglu&quot;</span>);</span><br><span class="line">        <span class="comment">//通过 URL对象调用 openConnection 方法创建URLConnection连接对象</span></span><br><span class="line">        URLConnection uc = url.openConnection();</span><br><span class="line">        <span class="comment">//处理设置参数</span></span><br><span class="line">        uc.setDoOutput(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//给服务器发送请求参数</span></span><br><span class="line">        uc.getOutputStream().write(<span class="string">&quot;username=admin&amp;password=123&quot;</span>.getBytes());</span><br><span class="line">        <span class="comment">//使用 connect 方法建立到远程对象的实际连接。</span></span><br><span class="line">        uc.connect();</span><br><span class="line">        <span class="comment">//获取资源</span></span><br><span class="line">        InputStream is = uc.getInputStream();</span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(is,<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        String str;</span><br><span class="line">        <span class="keyword">while</span>((str=br.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            System.out.println(str);</span><br><span class="line">        &#125;</span><br><span class="line">        br.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h3><p>通信的两端都要有Socket套接字，是两台机器间通信的端点，能和网卡驱动进行交流。负责把数据交给网卡驱动，或从网卡驱动中提取数据。<br>网络通信其实就是Socket间的通信。Socket可以分为：<br>（1）流套接字（stream socket）：使用TCP提供可依赖的字节流服务。ServerSocket类和Socket类。<br>（2）数据报套接字（datagram socket）：使用UDP提供“尽力而为”的数据报服务。DatagramSocket类。<br><img src="https://i.loli.net/2021/04/06/cX8FjNHSRK9nh1M.png" width="90%" height="90%"></p>
<p>Socket类的常用构造方法：<br>（1）<code>public Socket(InetAddress address,int port)</code>：创建一个流套接字并将其连接到指定 IP 地址的指定端口号。<br>（2）<code>public Socket(String host,int port)</code>：创建一个流套接字并将其连接到指定主机上的指定端口号。<br>Socket类的常用方法：<br>（1）<code>public InputStream getInputStream()</code>：返回此套接字的输入流，可以用于接收消息。<br>（2）<code>public OutputStream getOutputStream()</code>：返回此套接字的输出流，可以用于发送消息。<br>（3）<code>public InetAddress getInetAddress()</code>：此套接字连接到的远程 IP 地址；如果套接字是未连接的，则返回 null。<br>（4）<code>public InetAddress getLocalAddress()</code>：获取套接字绑定的本地地址。<br>（5）<code>public int getPort()</code>：此套接字连接到的远程端口号；如果尚未连接套接字，则返回 0。<br>（6）<code>public int getLocalPort()</code>：返回此套接字绑定到的本地端口。如果尚未绑定套接字，则返回 -1。<br>（7）<code>public void close()</code>：关闭此套接字。套接字被关闭后，便不可在以后的网络连接中使用（即无法重新连接或重新绑定）。需要创建新的套接字对象。 关闭此套接字也将会关闭该套接字的 InputStream 和 OutputStream。<br>（8）<code>public void shutdownInput()</code>：如果在套接字上调用 shutdownInput() 后从套接字输入流读取内容，则流将返回 EOF（文件结束符）。 即不能在从此套接字的输入流中接收任何数据。<br>（9）<code>public void shutdownOutput()</code>：禁用此套接字的输出流。对于 TCP 套接字，任何以前写入的数据都将被发送，并且后跟 TCP 的正常连接终止序列。 如果在套接字上调用 shutdownOutput() 后写入套接字输出流，则该流将抛出 IOException。 即不能通过此套接字的输出流发送任何数据。</p>
<p id="div-border-left-blue">
先后调用Socket的shutdownInput()和shutdownOutput()方法，仅仅关闭了输入流和输出流，并不等于调用Socket的close()方法。<br>
在通信结束后，仍然要调用Scoket的close()方法，因为只有该方法才会释放Socket占用的资源，比如占用的本地端口号等。
</p>

<h2 id="基于TCP协议的网络编程"><a href="#基于TCP协议的网络编程" class="headerlink" title="基于TCP协议的网络编程"></a>基于TCP协议的网络编程</h2><p>TCP(Transmission Control Protocol，传输控制协议)被称作一种端对端协议。是一种面向连接的、可靠的、基于字节流的传输层的通信协议，可以连续传输大量的数据。类似于打电话的效果。<br>当一台计算机需要与另一台远程计算机连接时，TCP协议会采用“三次握手”方式让它们建立一个连接，用于发送和接收数据的虚拟链路。数据传输完毕TCP协议会采用“四次挥手”方式断开连接。<br>TCP协议负责收集这些信息包，并将其按适当的次序放好传送，在接收端收到后再将其正确的还原。TCP协议保证了数据包在传送中准确无误。TCP协议使用重发机制，当一个通信实体发送一个消息给另一个通信实体后，需要收到另一个通信实体确认信息，如果没有收到另一个通信实体确认信息，则会再次重复刚才发送的消息。</p>
<h3 id="基于TCP协议的网络通信程序结构"><a href="#基于TCP协议的网络通信程序结构" class="headerlink" title="基于TCP协议的网络通信程序结构"></a>基于TCP协议的网络通信程序结构</h3><p>Java语言的基于套接字TCP编程分为服务端编程和客户端编程，其通信模型如图所示：<br><img src="https://i.loli.net/2021/04/06/3qldpZhBrmXVw6y.png" width="70%" height="70%"></p>
<p>服务器程序的工作过程包含以下五个基本的步骤：<br>（1）使用<code>ServerSocket(int port)</code>：创建一个服务器端套接字，并绑定到指定端口上。用于监听客户端的请求。<br>（2）调用<code>accept()</code>方法：监听连接请求，若客户端请求连接，则接受连接，创建与该客户端的Socket对象。否则它将一直处于等待状态。<br>（3）调用 该Socket对象的<code>getOutputStream()</code>和<code>getInputStream()</code>：获取输出流和输入流，开始网络数据的发送和接收。<br>（4）关闭Socket对象：某客户端访问结束，关闭与之通信的套接字。<br>（5）关闭ServerSocket：如果不再接收任何客户端的连接的话，调用<code>close()</code>进行关闭。</p>
<p>客户端Socket的工作过程包含以下四个基本的步骤：<br>（1）创建 Socket：根据指定服务端的 IP 地址或端口号构造 Socket 类对象，创建的同时会自动向服务器方发起连接。若服务器端响应，则建立客户端到服务器的通信线路。若连接失败，会出现异常。<br>（2）打开连接到Socket的输入/输出流：使用<code>getInputStream()</code>或<code>getOutputStream()</code>方法获得输入流或输出流，进行数据传输。<br>（3）进行读/写操作：通过输入流读取服务器发送的信息，通过输出流将信息发送给服务器。<br>（4）关闭 Socket：断开客户端到服务器的连接。</p>
<p id="div-border-left-blue">
客户端和服务器端在获取输入流和输出流时要对应，否则容易死锁。<br>
例如，客户端先获取字节输出流（先写），那么服务器端就先获取字节输入流（先读）；反过来客户端先获取字节输入流（先读），那么服务器端就先获取字节输出流（先写）。
</p>

<h3 id="案例：一个客户端与服务器单次通信"><a href="#案例：一个客户端与服务器单次通信" class="headerlink" title="案例：一个客户端与服务器单次通信"></a>案例：一个客户端与服务器单次通信</h3><p>需求：客户端连接服务器，连接成功后给服务发送“lalala”，服务器收到消息后，给客户端返回“欢迎登录”<br>运行程序时，必须先启动服务器端程序，主动接收客户端程序的连接请求。<br><div class="tabs" id="one"><ul class="nav-tabs"><li class="tab active"><a href="#one-1">Server</a></li><li class="tab"><a href="#one-2">Client</a></li></ul><div class="tab-content"><div class="tab-pane active" id="one-1"><figure class="highlight java"><figcaption><span>Server.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.one;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//1、准备一个ServerSocket对象，并绑定8888端口</span></span><br><span class="line">        ServerSocket server =  <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;等待连接....&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//2、在8888端口监听客户端的连接，该方法是个阻塞方法，若没有客户端连接，将一直等待</span></span><br><span class="line">        Socket socket = server.accept();</span><br><span class="line">        System.out.println(<span class="string">&quot;一个客户端连接成功！！&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//3、获取输入流，用来接收该客户端发送给服务器的数据</span></span><br><span class="line">        InputStream input = socket.getInputStream();</span><br><span class="line">        <span class="comment">//接收数据</span></span><br><span class="line">        <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        StringBuilder s = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span> ((len = input.read(data)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            s.append(<span class="keyword">new</span> String(data, <span class="number">0</span>, len));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;客户端发送的消息是：&quot;</span> + s);</span><br><span class="line">                </span><br><span class="line">        <span class="comment">//4、获取输出流，用来发送数据给该客户端</span></span><br><span class="line">        OutputStream out = socket.getOutputStream();</span><br><span class="line">        <span class="comment">//发送数据</span></span><br><span class="line">        out.write(<span class="string">&quot;欢迎登录&quot;</span>.getBytes());</span><br><span class="line">        out.flush();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//5、关闭socket，不再与该客户端通信</span></span><br><span class="line">        <span class="comment">//socket关闭，意味着InputStream和OutputStream也关闭了</span></span><br><span class="line">        socket.close();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//6、如果不再接收任何客户端通信，可以关闭ServerSocket</span></span><br><span class="line">        server.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="one-2"><figure class="highlight java"><figcaption><span>Client.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.one;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 1、准备Socket，连接服务器，需要指定服务器的IP地址和端口号</span></span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8888</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2、获取输出流，用来发送数据给服务器</span></span><br><span class="line">        OutputStream out = socket.getOutputStream();</span><br><span class="line">        <span class="comment">// 发送数据</span></span><br><span class="line">        out.write(<span class="string">&quot;lalala&quot;</span>.getBytes());</span><br><span class="line">        <span class="comment">//会在流末尾写入一个“流的末尾”标记，对方才能读到-1，否则对方的读取方法会一致阻塞</span></span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//3、获取输入流，用来接收服务器发送给该客户端的数据</span></span><br><span class="line">        InputStream input = socket.getInputStream();</span><br><span class="line">        <span class="comment">// 接收数据</span></span><br><span class="line">        <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        StringBuilder s = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span> ((len = input.read(data)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            s.append(<span class="keyword">new</span> String(data, <span class="number">0</span>, len));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;服务器返回的消息是：&quot;</span> + s);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//4、关闭socket，不再与服务器通信，即断开与服务器的连接</span></span><br><span class="line">        <span class="comment">//socket关闭，意味着InputStream和OutputStream也关闭了</span></span><br><span class="line">        socket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div></p>
<h3 id="案例：多个客户端与服务器之间的多次通信"><a href="#案例：多个客户端与服务器之间的多次通信" class="headerlink" title="案例：多个客户端与服务器之间的多次通信"></a>案例：多个客户端与服务器之间的多次通信</h3><p>通常情况下，服务器不应该只接受一个客户端请求，而应该不断地接受来自客户端的所有请求，所以Java程序通常会通过循环，不断地调用ServerSocket的accept()方法。<br>如果服务器端要“同时”处理多个客户端的请求，因此服务器端需要为每一个客户端单独分配一个线程来处理，否则无法实现“同时”。<br>在<a href="https://soundmemories.github.io/2020/03/04/Java/27.JavaIO%E6%B5%81/">JavaIO流</a>文章中，提到过装饰者设计模式，该设计使得不管底层IO流是怎样的节点流：文件流也好，网络Socket产生的流也好，程序都可以将其包装成处理流，甚至可以多层包装，从而提供更多方便的处理。</p>
<p>案例需求：多个客户端连接服务器，并进行多次通信<br>（1）每一个客户端连接成功后，从键盘输入英文单词或中国成语，并发送给服务器。<br>（2）服务器收到客户端的消息后，把词语“反转”后返回给客户端。<br>（3）客户端接收服务器返回的“词语”，打印显示。<br>（4）当客户端输入“stop”时断开与服务器的连接。<br>（5）多个客户端可以同时给服务器发送“词语”，服务器可以“同时”处理多个客户端的请求。<br>服务器端要“同时”处理多个客户端的请求，那么必须使用多线程，每一个客户端的通信需要单独的线程来处理。</p>
<div class="tabs" id="echo"><ul class="nav-tabs"><li class="tab active"><a href="#echo-1">Server</a></li><li class="tab"><a href="#echo-2">ServerThread</a></li><li class="tab"><a href="#echo-3">Client</a></li></ul><div class="tab-content"><div class="tab-pane active" id="echo-1"><figure class="highlight java"><figcaption><span>Server.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.echo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 1、准备一个ServerSocket</span></span><br><span class="line">        ServerSocket server = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;等待连接...&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="comment">// 2、监听一个客户端的连接</span></span><br><span class="line">            Socket socket = server.accept();</span><br><span class="line">            System.out.println(<span class="string">&quot;第&quot;</span> + ++count + <span class="string">&quot;个客户端连接成功！！&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            ClientHandlerThread ct = <span class="keyword">new</span> ClientHandlerThread(socket);</span><br><span class="line">            ct.start();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//这里没有关闭server，永远监听</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="echo-2"><figure class="highlight java"><figcaption><span>ClientHandlerThread.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.echo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientHandlerThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClientHandlerThread</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.socket = socket;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//（1）获取输入流，用来接收该客户端发送给服务器的数据</span></span><br><span class="line">            BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(socket.getInputStream()));</span><br><span class="line">            <span class="comment">//（2）获取输出流，用来发送数据给该客户端</span></span><br><span class="line">            PrintStream ps = <span class="keyword">new</span> PrintStream(socket.getOutputStream());</span><br><span class="line">            String str;</span><br><span class="line">            <span class="comment">// （3）接收数据</span></span><br><span class="line">            <span class="keyword">while</span> ((str = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//（4）反转</span></span><br><span class="line">                StringBuilder word = <span class="keyword">new</span> StringBuilder(str);</span><br><span class="line">                word.reverse();</span><br><span class="line">                </span><br><span class="line">                <span class="comment">//（5）返回给客户端</span></span><br><span class="line">                ps.println(word);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception  e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//（6）断开连接</span></span><br><span class="line">                socket.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="echo-3"><figure class="highlight java"><figcaption><span>Client.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.echo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 1、准备Socket，连接服务器，需要指定服务器的IP地址和端口号</span></span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8888</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2、获取输出流，用来发送数据给服务器</span></span><br><span class="line">        OutputStream out = socket.getOutputStream();</span><br><span class="line">        PrintStream ps = <span class="keyword">new</span> PrintStream(out);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3、获取输入流，用来接收服务器发送给该客户端的数据</span></span><br><span class="line">        InputStream input = socket.getInputStream();</span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(input));</span><br><span class="line">        </span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入发送给服务器的单词或成语：&quot;</span>);</span><br><span class="line">            String message = scanner.nextLine();</span><br><span class="line">            <span class="keyword">if</span>(message.equals(<span class="string">&quot;stop&quot;</span>))&#123;</span><br><span class="line">                socket.shutdownOutput();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 4、发送数据</span></span><br><span class="line">            ps.println(message);</span><br><span class="line">            <span class="comment">// 接收数据</span></span><br><span class="line">            String feedback  = br.readLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;从服务器收到的反馈是：&quot;</span> + feedback);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//5、关闭socket，断开与服务器的连接</span></span><br><span class="line">        scanner.close();</span><br><span class="line">        socket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>
<h3 id="案例：多个客户端上传文件"><a href="#案例：多个客户端上传文件" class="headerlink" title="案例：多个客户端上传文件"></a>案例：多个客户端上传文件</h3><p>需求：每一个客户端启动后都可以给服务器上传一个文件，服务器接收到文件后保存到一个upload目录中。可以同时接收多个客户端的文件上传。<br>（1）服务器端要“同时”处理多个客户端的请求，那么必须使用多线程，每一个客户端的通信需要单独的线程来处理。<br>（2）服务器保存上传文件的目录只有一个upload，而每个客户端给服务器发送的文件可能重名，所以需要保证文件名的唯一。我们可以使用“时间戳”作为文件名，而后缀名不变。<br>（3）客户端需要给服务器上传文件名（含后缀名）以及文件内容。而文件名是字符串，文件内容不一定是纯文本的，因此选择DataOutputStream和DataInputStream。</p>
<div class="tabs" id="fileupload"><ul class="nav-tabs"><li class="tab active"><a href="#fileupload-1">Server</a></li><li class="tab"><a href="#fileupload-2">ServerThread</a></li><li class="tab"><a href="#fileupload-3">Client</a></li></ul><div class="tab-content"><div class="tab-pane active" id="fileupload-1"><figure class="highlight java"><figcaption><span>Server.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.fileupload;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//服务器在8888端口号监听数据</span></span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line">        ServerSocket server = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="comment">//(2)等待连接 </span></span><br><span class="line">            <span class="comment">//这句代码执行一次，意味着一个客户端连接</span></span><br><span class="line">            Socket accept = server.accept();</span><br><span class="line">        </span><br><span class="line">            FileUploadThread ft = <span class="keyword">new</span> FileUploadThread(accept);</span><br><span class="line">            ft.start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="fileupload-2"><figure class="highlight java"><figcaption><span>FileUploadThread.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.tcp.fileupload;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileUploadThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line">    <span class="keyword">private</span> String dir = <span class="string">&quot;upload/&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FileUploadThread</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.socket = socket;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        FileOutputStream fos = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream is = socket.getInputStream();</span><br><span class="line">            DataInputStream dis = <span class="keyword">new</span> DataInputStream(is);    </span><br><span class="line">            </span><br><span class="line">            <span class="comment">//读取文件名（含后缀名）</span></span><br><span class="line">            String filename = dis.readUTF();</span><br><span class="line">            <span class="comment">//截取后缀名</span></span><br><span class="line">            String ext = filename.substring(filename.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">            <span class="comment">//生成时间戳</span></span><br><span class="line">            SimpleDateFormat sf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyyMMddHHmmssSSS&quot;</span>);</span><br><span class="line">            filename = sf.format(<span class="keyword">new</span> Date());</span><br><span class="line">            <span class="comment">//用新文件路径构建文件输出流</span></span><br><span class="line">            fos = <span class="keyword">new</span> FileOutputStream(dir + filename + ext);</span><br><span class="line">            <span class="comment">//接收文件内容</span></span><br><span class="line">            <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> len = is.read(data);</span><br><span class="line">                <span class="keyword">if</span>(len==-<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                fos.write(data, <span class="number">0</span>, len);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//返回结果</span></span><br><span class="line">            OutputStream out = socket.getOutputStream();</span><br><span class="line">            PrintStream ps = <span class="keyword">new</span> PrintStream(out);</span><br><span class="line">            ps.println(filename + ext + <span class="string">&quot;：已上传完毕&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fos.close();</span><br><span class="line">                socket.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="fileupload-3"><figure class="highlight java"><figcaption><span>Client.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.fileupload;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// (1)连接服务器</span></span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(<span class="string">&quot;192.168.34.53&quot;</span>, <span class="number">8888</span>);</span><br><span class="line"></span><br><span class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//(2)从键盘输入文件的路径和名称</span></span><br><span class="line">        System.out.print(<span class="string">&quot;请选择要上传的文件：&quot;</span>);</span><br><span class="line">        String path = input.nextLine();</span><br><span class="line">        File file = <span class="keyword">new</span> File(path);</span><br><span class="line">        </span><br><span class="line">        OutputStream out = socket.getOutputStream();</span><br><span class="line">        <span class="comment">//用DataOutputStream的目的是为了既可以单独传一个字符串，又可以写字节内容</span></span><br><span class="line">        DataOutputStream dos = <span class="keyword">new</span> DataOutputStream(out);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//先发送文件名（含后缀名）</span></span><br><span class="line">        dos.writeUTF(file.getName());<span class="comment">//单独发一个字符串</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//还需要一个IO流，从文件读取内容，给服务器发过去</span></span><br><span class="line">        FileInputStream fis = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">                </span><br><span class="line">        <span class="comment">//（3）把文件内容给服务器传过去，类似与复制文件</span></span><br><span class="line">        <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> len = fis.read(data);</span><br><span class="line">            <span class="keyword">if</span>(len==-<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            dos.write(data, <span class="number">0</span>, len);</span><br><span class="line">        &#125;</span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//(4)接收服务器返回的结果</span></span><br><span class="line">        InputStream is = socket.getInputStream();</span><br><span class="line">        InputStreamReader isr = <span class="keyword">new</span> InputStreamReader(is);<span class="comment">//把字节流转成字符流</span></span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(isr);</span><br><span class="line">        String result = br.readLine();</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//(5)关闭</span></span><br><span class="line">        fis.close();</span><br><span class="line">        input.close();</span><br><span class="line">        socket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div>
<h3 id="案例：多个客户端群聊"><a href="#案例：多个客户端群聊" class="headerlink" title="案例：多个客户端群聊"></a>案例：多个客户端群聊</h3><p>需求：模拟聊天室群聊。客户端要先登录，登录成功之后才能发送和接收消息。<br>（1）服务器端，需要为每个客户端开启一个线程通信，这样才能实现多个客户端“同时”与服务器通信。<br>（2）客户端，需要把收消息功能与发消息功能分开两个线程，这样才能“同时收发”，即可以发消息，也可以接收其他客户端的聊天消息。<br>（3）服务器端要分别处理客户端的“登录”、“退出”、“聊天”的消息，所以这里设计了Code常量类，用状态值区分“登录”、“退出”、“聊天”。<br>（4）这里设计Message类，包含code属性，区别是“登录”、“退出”、“聊天”，username属性表示用户名，表明消息是谁发的，content属性，存储消息内容，如果是登录，就用来存储密码。<br>（5）这里消息是Message对象，因此在客户端与服务器之间传输的是对象，所以选择ObjectOutputStream和ObjectInputStream。<br>（6）这里的Message类与Code类是服务器端和客户端“共享”的，要保持一致。特别注意包名和序列化版本ID。<br><div class="tabs" id="chat"><ul class="nav-tabs"><li class="tab active"><a href="#chat-1">Code</a></li><li class="tab"><a href="#chat-2">Message</a></li><li class="tab"><a href="#chat-3">ServiceUserManager</a></li><li class="tab"><a href="#chat-4">Server</a></li><li class="tab"><a href="#chat-5">ServerThread</a></li><li class="tab"><a href="#chat-6">Client</a></li><li class="tab"><a href="#chat-7">ClientSendThread</a></li><li class="tab"><a href="#chat-8">ClientReceiveThread</a></li></ul><div class="tab-content"><div class="tab-pane active" id="chat-1"><figure class="highlight java"><figcaption><span>Code.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.chat.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Code</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LOGIN = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CHAT = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> LOGOUT = <span class="number">3</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SUCCESS = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> FAIL = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="chat-2"><figure class="highlight java"><figcaption><span>Message.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.chat.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Message</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Message</span><span class="params">(<span class="keyword">int</span> code, String username, String content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Message</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(<span class="keyword">int</span> code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContent</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="chat-3"><figure class="highlight java"><figcaption><span>UserManager.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.chat.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserManager</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> HashMap&lt;String,String&gt; allUsers = <span class="keyword">new</span> HashMap&lt;String,String&gt;();</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        allUsers.put(<span class="string">&quot;gangge&quot;</span>, <span class="string">&quot;123&quot;</span>);</span><br><span class="line">        allUsers.put(<span class="string">&quot;xiaobai&quot;</span>, <span class="string">&quot;456&quot;</span>);</span><br><span class="line">        allUsers.put(<span class="string">&quot;gujie&quot;</span>, <span class="string">&quot;789&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">login</span><span class="params">(String username, String password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(allUsers.get(username)!=<span class="keyword">null</span> &amp;&amp; allUsers.get(username).equals(password))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="chat-4"><figure class="highlight java"><figcaption><span>Server.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.chat.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;resource&quot;)</span></span><br><span class="line">        ServerSocket server = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            Socket socket = server.accept();</span><br><span class="line">            </span><br><span class="line">            ClientHandlerThread ct = <span class="keyword">new</span> ClientHandlerThread(socket);</span><br><span class="line">            ct.start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="chat-5"><figure class="highlight java"><figcaption><span>ClientHandlerThread.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.chat.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.memories.tcp.chat.bean.Code;</span><br><span class="line"><span class="keyword">import</span> com.memories.tcp.chat.bean.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientHandlerThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Set&lt;ObjectOutputStream&gt; online = Collections.synchronizedSet(<span class="keyword">new</span> HashSet&lt;ObjectOutputStream&gt;());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> ObjectInputStream ois;</span><br><span class="line">    <span class="keyword">private</span> ObjectOutputStream oos;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClientHandlerThread</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.socket = socket;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Message message = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            ois = <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line">            oos = <span class="keyword">new</span> ObjectOutputStream(socket.getOutputStream());</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//接收数据</span></span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                message = (Message) ois.readObject();</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(message.getCode() == Code.LOGIN)&#123;</span><br><span class="line">                    <span class="comment">//如果是登录，则验证用户名密码</span></span><br><span class="line">                    username = message.getUsername();</span><br><span class="line">                    String password = message.getContent();</span><br><span class="line">                    <span class="keyword">if</span>(UserManager.login(username, password))&#123;</span><br><span class="line">                        message.setCode(Code.SUCCESS);</span><br><span class="line">                        oos.writeObject(message);</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment">//并将该用户添加到在线人员名单中</span></span><br><span class="line">                        online.add(oos);</span><br><span class="line">                        </span><br><span class="line">                        message.setCode(Code.CHAT);</span><br><span class="line">                        message.setContent(<span class="string">&quot;上线了&quot;</span>);</span><br><span class="line">                        <span class="comment">//通知其他人，xx上线了</span></span><br><span class="line">                        sendToOther(message);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        message.setCode(Code.FAIL);</span><br><span class="line">                        oos.writeObject(message);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(message.getCode() == Code.CHAT)&#123;</span><br><span class="line">                    <span class="comment">//如果是聊天信息，把消息转发给其他在线客户端</span></span><br><span class="line">                    sendToOther(message);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(message.getCode() == Code.LOGOUT)&#123;</span><br><span class="line">                    <span class="comment">//通知其他人，xx下线了</span></span><br><span class="line">                    message.setContent(<span class="string">&quot;下线了&quot;</span>);</span><br><span class="line">                    sendToOther(message);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception  e)&#123;</span><br><span class="line">            <span class="comment">//通知其他人，xx掉线了</span></span><br><span class="line">            <span class="keyword">if</span>(message!=<span class="keyword">null</span> &amp;&amp; username!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                message.setCode(Code.LOGOUT);</span><br><span class="line">                message.setContent(<span class="string">&quot;掉线了&quot;</span>);</span><br><span class="line">                sendToOther(message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">//从在线人员中移除并断开当前客户端</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                online.remove(oos);</span><br><span class="line">                socket.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sendToOther</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;ObjectOutputStream&gt; offline = <span class="keyword">new</span> ArrayList&lt;ObjectOutputStream&gt;();</span><br><span class="line">        <span class="keyword">for</span> (ObjectOutputStream on : online) &#123;</span><br><span class="line">            <span class="comment">//只给其他客户端转发</span></span><br><span class="line">            <span class="keyword">if</span>(!on.equals(oos))&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    on.writeObject(message);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="comment">//说明on这个客户端要么下线了，要么掉线了</span></span><br><span class="line">                    offline.add(on);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//把下线人员从在线人员中删除</span></span><br><span class="line">        <span class="keyword">for</span> (ObjectOutputStream off : offline) &#123;</span><br><span class="line">            online.remove(off);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">        //遍历所有online的客户端</span></span><br><span class="line"><span class="comment">        Iterator&lt;ObjectOutputStream&gt; iterator = online.iterator();</span></span><br><span class="line"><span class="comment">        while(iterator.hasNext())&#123;</span></span><br><span class="line"><span class="comment">            ObjectOutputStream on = iterator.next();</span></span><br><span class="line"><span class="comment">            if(!on.equals(oos))&#123;//只给其他客户端转发</span></span><br><span class="line"><span class="comment">                try &#123;</span></span><br><span class="line"><span class="comment">                    on.writeObject(message);</span></span><br><span class="line"><span class="comment">                &#125; catch (IOException e) &#123;</span></span><br><span class="line"><span class="comment">                    //说明on这个客户端要么下线了，要么掉线了</span></span><br><span class="line"><span class="comment">                    //把下线人员从在线人员中删除</span></span><br><span class="line"><span class="comment">                    iterator.remove();</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="chat-6"><figure class="highlight java"><figcaption><span>Client.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.chat.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.memories.tcp.chat.bean.Code;</span><br><span class="line"><span class="keyword">import</span> com.memories.tcp.chat.bean.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket(<span class="string">&quot;192.168.1.107&quot;</span>, <span class="number">9999</span>);</span><br><span class="line">        </span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(socket.getOutputStream());</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(socket.getInputStream());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//先登录</span></span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        String username;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="comment">//输入登录信息</span></span><br><span class="line">            System.out.println(<span class="string">&quot;用户名：&quot;</span>);</span><br><span class="line">            username = scanner.nextLine();</span><br><span class="line">            System.out.println(<span class="string">&quot;密码：&quot;</span>);</span><br><span class="line">            String password = scanner.nextLine();</span><br><span class="line">            </span><br><span class="line">            Message msg = <span class="keyword">new</span> Message(Code.LOGIN, username, password);</span><br><span class="line">            <span class="comment">//发送登录数据</span></span><br><span class="line">            oos.writeObject(msg);</span><br><span class="line">            <span class="comment">//接收登录结果</span></span><br><span class="line">            msg = (Message) ois.readObject();</span><br><span class="line">            <span class="keyword">if</span>(msg.getCode() == Code.SUCCESS)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;登录成功！&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(msg.getCode() == Code.FAIL)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;用户名或密码错误，登录失败，重新输入&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//启动收消息和发消息线程</span></span><br><span class="line">        SendThread s = <span class="keyword">new</span> SendThread(oos,username);</span><br><span class="line">        ReceiveThread r = <span class="keyword">new</span> ReceiveThread(ois);</span><br><span class="line">        s.start();</span><br><span class="line">        r.start();</span><br><span class="line">        </span><br><span class="line">        s.join();<span class="comment">//等待s线程终止</span></span><br><span class="line">        r.setFlag(<span class="keyword">false</span>);<span class="comment">//s终止，r也终止</span></span><br><span class="line">        r.join();<span class="comment">//等待r线程终止</span></span><br><span class="line">        </span><br><span class="line">        scanner.close();</span><br><span class="line">        socket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="chat-7"><figure class="highlight java"><figcaption><span>SendThread.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.chat.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.memories.tcp.chat.bean.Code;</span><br><span class="line"><span class="keyword">import</span> com.memories.tcp.chat.bean.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SendThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ObjectOutputStream oos;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SendThread</span><span class="params">(ObjectOutputStream oos,String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.oos = oos;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">            <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;请输入消息内容：&quot;</span>);</span><br><span class="line">                String content = scanner.nextLine();</span><br><span class="line">                Message msg;</span><br><span class="line">                <span class="keyword">if</span>(<span class="string">&quot;bye&quot;</span>.equals(content))&#123;</span><br><span class="line">                    msg = <span class="keyword">new</span> Message(Code.LOGOUT, username, content);</span><br><span class="line">                    oos.writeObject(msg);</span><br><span class="line">                    scanner.close();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    msg = <span class="keyword">new</span> Message(Code.CHAT, username, content);</span><br><span class="line">                    oos.writeObject(msg);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="chat-8"><figure class="highlight java"><figcaption><span>ReceiveThread.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.tcp.chat.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> com.memories.tcp.chat.bean.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReceiveThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ObjectInputStream ois;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ReceiveThread</span><span class="params">(ObjectInputStream ois)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.ois = ois;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span>(flag)&#123;</span><br><span class="line">                Message msg = (Message) ois.readObject();</span><br><span class="line">                System.out.println(msg.getUsername() + <span class="string">&quot;:&quot;</span> + msg.getContent());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请重新登录&quot;</span>);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFlag</span><span class="params">(<span class="keyword">boolean</span> flag)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.flag = flag;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></div></p>
<h2 id="基于UDP协议的网络编程"><a href="#基于UDP协议的网络编程" class="headerlink" title="基于UDP协议的网络编程"></a>基于UDP协议的网络编程</h2><p>UDP(User Datagram Protocol，用户数据报协议)：是一个<strong>无连接</strong>的传输层协议、提供面向事务的简单<strong>不可靠</strong>的信息传送服务，类似于短信。</p>
<p>UDP协议是一种<strong>面向非连接</strong>的协议，面向非连接指的是在正式通信前不必与对方先建立连接，不管对方状态就直接发送，至于对方是否可以接收到这些数据内容，UDP协议无法控制，因此说，UDP协议是一种<strong>不可靠</strong>的协议。无连接的好处就是快，省内存空间和流量，因为维护连接需要创建大量的数据结构。UDP会尽最大努力交付数据，但不保证可靠交付，没有TCP的确认机制、重传机制，如果因为网络原因没有传送到对端，UDP也不会给应用层返回错误信息。</p>
<p>UDP协议是面向数据报文的信息传送服务。UDP在发送端没有缓冲区，对于应用层交付下来的报文在添加了首部之后就直接交付于ip层，不会进行合并，也不会进行拆分，而是一次交付一个完整的报文。比如我们要发送100个字节的报文，我们调用一次send()方法就会发送100字节，接收方也需要用receive()方法一次性接收100字节，不能使用循环每次获取10个字节，获取十次这样的做法。</p>
<p>UDP协议没有拥塞控制，所以当网络出现的拥塞不会导致主机发送数据的速率降低。虽然UDP的接收端有缓冲区，但是这个缓冲区只负责接收，并不会保证UDP报文的到达顺序是否和发送的顺序一致。因为网络传输的时候，由于网络拥塞的存在是很大的可能导致先发的报文比后发的报文晚到达。如果此时缓冲区满了，后面到达的报文将直接被丢弃。这个对实时应用来说很重要，比如：视频通话、直播等应用。<br>因此UDP适用于一次只传送少量数据、对可靠性要求不高的应用环境，数据报大小限制在64K以下。</p>
<h3 id="基于UDP协议的网络编程-1"><a href="#基于UDP协议的网络编程-1" class="headerlink" title="基于UDP协议的网络编程"></a>基于UDP协议的网络编程</h3><p>基于UDP协议的网络编程仍然需要在通信实例的两端各建立一个Socket，但这两个Socket之间并没有虚拟链路，这两个Socket只是发送、接收数据报的对象，Java提供了DatagramSocket对象作为基于UDP协议的Socket，使用DatagramPacket代表DatagramSocket发送、接收的数据报。</p>
<p><strong>DatagramSocket 类的常用方法：</strong><br>（1）<code>public DatagramSocket(int port)</code>：创建数据报套接字并将其绑定到本地主机上的指定端口。套接字将被绑定到通配符地址，IP 地址由内核来选择。<br>（2）<code>public DatagramSocket(int port,InetAddress laddr)</code>：创建数据报套接字，将其绑定到指定的本地地址。本地端口必须在 0 到 65535 之间（包括两者）。如果 IP 地址为 0.0.0.0，套接字将被绑定到通配符地址，IP 地址由内核选择。<br>（3）<code>public void close()</code>：关闭此数据报套接字。<br>（4）<code>public void send(DatagramPacket p)</code>：从此套接字发送数据报包。DatagramPacket 包含的信息指示：将要发送的数据、其长度、远程主机的 IP 地址和远程主机的端口号。<br>（5）<code>public void receive(DatagramPacket p)</code>：从此套接字接收数据报包。当此方法返回时，DatagramPacket 的缓冲区填充了接收的数据。数据报包也包含发送方的 IP 地址和发送方机器上的端口号。 此方法在接收到数据报前一直阻塞。数据报包对象的 length 字段包含所接收信息的长度。如果信息比包的长度长，该信息将被截短。 </p>
<p><strong>DatagramPacket类的常用方法：</strong><br>（6）<code>public DatagramPacket(byte[] buf,int length)</code>：构造DatagramPacket，用来接收长度为 length 的数据包。 length 参数必须小于等于 buf.length。<br>（7）<code>public DatagramPacket(byte[] buf,int length,InetAddress address,int port)</code>：构造数据报包，用来将长度为 length 的包发送到指定主机上的指定端口号。length 参数必须小于等于 buf.length。<br>（8）<code>public int getLength()</code>：返回将要发送或接收到的数据的长度。 </p>
<p><strong>1、“发送端”</strong><br>步骤流程：<br>1、建立发送端DatagramSocket，需要指定本端的端口号。<br>2、建立数据包DatagramPacket，数据、接收端的IP地址、接收端的端口号。<br>3、调用DatagramSocket的发送方法。<br>4、关闭DatagramSocket。<br><figure class="highlight java"><figcaption><span>Send.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.udp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Send</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//1、建立发送端的DatagramSocket</span></span><br><span class="line">        DatagramSocket ds = <span class="keyword">new</span> DatagramSocket();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//要发送的数据</span></span><br><span class="line">        ArrayList&lt;String&gt; all = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        all.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        all.add(<span class="string">&quot;world&quot;</span>);</span><br><span class="line">        all.add(<span class="string">&quot;java&quot;</span>);</span><br><span class="line">        all.add(<span class="string">&quot;great&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//接收方的IP地址</span></span><br><span class="line">        InetAddress ip = InetAddress.getByName(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">        <span class="comment">//接收方的监听端口号</span></span><br><span class="line">        <span class="keyword">int</span> port = <span class="number">9999</span>;</span><br><span class="line">         <span class="comment">//发送多个数据报</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; all.size(); i++) &#123;</span><br><span class="line">            <span class="comment">//2、建立数据包DatagramPacket</span></span><br><span class="line">            <span class="keyword">byte</span>[] data = all.get(i).getBytes();</span><br><span class="line">            DatagramPacket dp = <span class="keyword">new</span> DatagramPacket(data, data.length, ip, port);</span><br><span class="line">            <span class="comment">//3、调用Socket的发送方法</span></span><br><span class="line">            ds.send(dp);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//4、关闭Socket</span></span><br><span class="line">        ds.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><strong>2、“接收端”</strong><br>步骤流程：<br>1、建立接收端DatagramSocket，需要指定本端的IP地址和端口号。<br>2、建立数据包DatagramPacket，需要指定装数据的数组。<br>3、调用Socket的接收方法。<br>4、拆封数据。<br>5、关闭Socke。<br><figure class="highlight java"><figcaption><span>Receive.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.udp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Receive</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//1、建立接收端的DatagramSocket，需要指定本端的监听端口号</span></span><br><span class="line">        DatagramSocket ds = <span class="keyword">new</span> DatagramSocket(<span class="number">9999</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//一直监听数据</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="comment">//2、建立数据包DatagramPacket</span></span><br><span class="line">            <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>*<span class="number">64</span>];</span><br><span class="line">            DatagramPacket dp = <span class="keyword">new</span> DatagramPacket(buffer , buffer.length);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//3、调用Socket的接收方法</span></span><br><span class="line">            ds.receive(dp);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//4、拆封数据</span></span><br><span class="line">            String str = <span class="keyword">new</span> String(buffer,<span class="number">0</span>,dp.getLength());</span><br><span class="line">            System.out.println(str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="使用MulticastSocket实现多点广播"><a href="#使用MulticastSocket实现多点广播" class="headerlink" title="使用MulticastSocket实现多点广播"></a>使用MulticastSocket实现多点广播</h3><p>Datagram只允许数据报发送给指定的目标地址，而MulticastSocket可以将数据报以广播方式发送到数量不等的多个客户端。<br>IP协议为多点广播提供了这批特殊的IP地址，这些IP地址的范围是224.0.0.0至239.255.255.255。<br>MulticastSocket常用的方法：<br>（1）<code>MulticastSocket(int port)</code>：创建多播套接字并将其绑定到特定端口。创建一个MulticastSocket对象后，还需要将该MulticastSocket加入到指定的多点广播地址，如果结束也需要脱离多点广播地址。<br>（2）<code>void joinGroup(InetAddress mcastaddr)</code>：加入多播组。<br>（3）<code>void leaveGroup(InetAddress mcastaddr)</code>：离开多播组。<br>（4）<code>void setLoopbackMode(boolean disable)</code>：启用/禁用多播数据报的本地回送。true 表示禁用 LoopbackMode。<br><figure class="highlight java"><figcaption><span>Chat.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.memories.udp.multi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.MulticastSocket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Chat</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> <span class="keyword">boolean</span> exit = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String username;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        MulticastSocket socket = <span class="keyword">new</span> MulticastSocket(<span class="number">9999</span>);</span><br><span class="line">        InetAddress ip = InetAddress.getByName(<span class="string">&quot;230.0.0.1&quot;</span>);</span><br><span class="line">        socket.joinGroup(ip);</span><br><span class="line">        socket.setLoopbackMode(<span class="keyword">false</span>);</span><br><span class="line">        </span><br><span class="line">        System.out.print(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">        username = input.nextLine();</span><br><span class="line">        </span><br><span class="line">        SendThread s = <span class="keyword">new</span> SendThread(socket,ip);</span><br><span class="line">        ReceiveThread r = <span class="keyword">new</span> ReceiveThread(socket);</span><br><span class="line">        </span><br><span class="line">        s.start();</span><br><span class="line">        r.start();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            s.join();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        socket.close();</span><br><span class="line">        input.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SendThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> MulticastSocket socket;</span><br><span class="line">        <span class="keyword">private</span> InetAddress ip;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">SendThread</span><span class="params">(MulticastSocket socket,InetAddress ip)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>();</span><br><span class="line">            <span class="keyword">this</span>.socket = socket;</span><br><span class="line">            <span class="keyword">this</span>.ip = ip;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (!exit) &#123;</span><br><span class="line">                    System.out.print(<span class="string">&quot;输入广播消息：&quot;</span>);</span><br><span class="line">                    String message = input.nextLine();</span><br><span class="line">                    <span class="keyword">if</span> (<span class="string">&quot;bye&quot;</span>.equals(message)) &#123;</span><br><span class="line">                        exit = <span class="keyword">true</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">    </span><br><span class="line">                    <span class="keyword">byte</span>[] data = (username+<span class="string">&quot;:&quot;</span>+message).getBytes();</span><br><span class="line">                    DatagramPacket dp = <span class="keyword">new</span> DatagramPacket(data, data.length, ip, <span class="number">9999</span>);</span><br><span class="line">    </span><br><span class="line">                    socket.send(dp);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ReceiveThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> MulticastSocket socket;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ReceiveThread</span><span class="params">(MulticastSocket socket)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>();</span><br><span class="line">            <span class="keyword">this</span>.socket = socket;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (!exit) &#123;</span><br><span class="line">                    <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                    DatagramPacket dp = <span class="keyword">new</span> DatagramPacket(data, data.length);</span><br><span class="line">                    socket.receive(dp);</span><br><span class="line">                    String str = <span class="keyword">new</span> String(data, <span class="number">0</span>, dp.getLength());</span><br><span class="line">                    System.out.println(str);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                exit = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>本文重点介绍了Java网络编程的相关知识。通过本文的学习，了解了计算机网络的相关知识，并介绍了IP地址和端口、网络协议的概念，这是进行网络编程的基础。</p>
<p>本文介绍了Java提供的InetAddress、URLConnection等，并通过它获取了远程资源。</p>
<p>本文还介绍了ServerSocket、Socket类，程序可以通过这两个类实现了TCP服务器、TCP客户端，通过编写案例，我们发现编写基于TCP协议的网络编程对于IO流、多线程知识的应用也有了更好的体会。</p>
<p>本文也介绍了DatagramSocket，DatagramPacket和MulticastSocket，并通过一个局域网通信案例示范了如何使用它们。</p>

      
    </div>

    
    
    
      


    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SoundMemories</span>
</div>
  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9tdXNlLw==">NexT.Muse</span> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@next-theme/pjax@0.4.0/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>
  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollRestoration: false,
  scrollTo: !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  




  <script src="/js/local-search.js"></script>








<script data-pjax>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  const url = element.dataset.target;
  const pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  const pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  const fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script data-pjax>
if (document.querySelectorAll('.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8.8.2/dist/mermaid.min.js', () => {
    mermaid.init({
      theme    : 'neutral',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    }, '.mermaid');
  }, window.mermaid);
}
</script>





  








    <div class="pjax">
  

  
      <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = '//cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink.listen({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://soundmemories.github.io/page/6/',]
      });
      });
  </script>

    </div>
</body>
</html>
